(()=>{"use strict";var e={375:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Union=t.Undefined=t.Tuple=t.StringLiteral=t.String=t.Reference=t.Record=t.Object=t.NumberLiteral=t.Number=t.Null=t.Intersection=t.BooleanLiteral=t.Boolean=t.Array=t.Any=void 0,t.Any={as:(e,t="")=>e,is(e){try{this.as(e)}catch(e){return!1}return!0}},t.Array={of:e=>({as(t,n=""){if(null!=t&&t.constructor===globalThis.Array){for(let a=0;a<t.length;a++)e.as(t[a],n+"["+a+"]");return t}throw"Expected an array at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Boolean={as(e,t=""){if(null!=e&&e.constructor===globalThis.Boolean)return e;throw"Expected a boolean at "+t+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}},t.BooleanLiteral={of:e=>({as(t,n=""){if(t===e)return t;throw"Expected "+e+" at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Intersection={of:(...e)=>({as(t,n=""){for(let a of e)a.as(t,n);return t},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Null={as(e,t=""){if(null===e)return e;throw"Expected null at "+t+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}},t.Number={as(e,t=""){if(null!=e&&e.constructor===globalThis.Number)return e;throw"Expected a number at "+t+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}},t.NumberLiteral={of:e=>({as(t,n=""){if(t===e)return t;throw"Expected "+e+" at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Object={of:e=>({as(t,n=""){if(null!=t&&t.constructor===globalThis.Object){for(let a in e)e[a].as(t[a],n+/^([a-z][a-z0-9_]*)$/is.test(a)?"."+a:'["'+a+'"]');return t}throw"Expected an object at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Record={of:e=>({as(t,n=""){if(null!=t&&t.constructor===globalThis.Object){for(let a of globalThis.Object.keys(t))e.as(t[a],n+'["'+a+'"]');return t}throw"Expected a record at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Reference={of:e=>({as:(t,n="")=>e().as(t,n),is:t=>e().is(t)})},t.String={as(e,t=""){if(null!=e&&e.constructor===globalThis.String)return e;throw"Expected a string at "+t+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}},t.StringLiteral={of:e=>({as(t,n=""){if(t===e)return t;throw'Expected "'+e+'" at '+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Tuple={of:(...e)=>({as(t,n=""){if(null!=t&&t.constructor===globalThis.Array){for(let a=0;a<e.length;a++)e[a].as(t[a],n+"["+a+"]");return t}throw"Expected a tuple at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})},t.Undefined={as(e,t=""){if(void 0===e)return e;throw"Expected undefined at "+t+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}},t.Union={of:(...e)=>({as(t,n=""){for(let a of e)try{return a.as(t,n)}catch(e){}throw"Expected a union at "+n+"!"},is(e){try{this.as(e)}catch(e){return!1}return!0}})}},175:(e,t,n)=>{t.m7=t.l8=void 0;const a=n(375);t.l8=a;n(226);const i=n(129);t.m7=i;n(329)},226:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Schema=t.UnionType=t.UndefinedType=t.TupleType=t.StringLiteralType=t.StringType=t.ReferenceType=t.RecordType=t.ObjectType=t.NumberLiteralType=t.NumberType=t.NullType=t.IntersectionType=t.GroupType=t.BooleanLiteralType=t.BooleanType=t.ArrayType=t.AnyType=t.Type=void 0;const a=n(329);t.Type={parse(e,...t){try{return x.parse(e,...t)}catch(e){}try{return o.parse(e,...t)}catch(e){}try{return d.parse(e,...t)}catch(e){}try{return i.parse(e)}catch(e){}try{return r.parse(e)}catch(e){}try{return s.parse(e)}catch(e){}try{return c.parse(e)}catch(e){}try{return p.parse(e)}catch(e){}try{return u.parse(e)}catch(e){}try{return f.parse(e)}catch(e){}try{return v.parse(e)}catch(e){}try{return y.parse(e)}catch(e){}try{return g.parse(e)}catch(e){}try{return b.parse(e)}catch(e){}try{return h.parse(e)}catch(e){}try{return l.parse(e)}catch(e){}try{return m.parse(e)}catch(e){}return e.newContext(((e,t)=>{let n=e();throw`Unexpected ${n.family} at row ${n.row}, col ${n.col}!`}))}};class i{constructor(){}generateType(e){return"any"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\treturn subject;"),t.push("}")):t.push("autoguard.Any"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>(a.expect(e(),"any"),i.INSTANCE)))}}t.AnyType=i,i.INSTANCE=new i;class d{constructor(e){this.type=e}generateType(e){return this.type.generateType(e)+"[]"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.Array)) {"),t.push("\t\tfor (let i = 0; i < subject.length; i++) {"),t.push("\t\t\t("+this.type.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t\t"}))+')(subject[i], path + "[" + i + "]");'),t.push("\t\t}"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected an array at " + path + "!";'),t.push("}")):t.push("autoguard.Array.of("+this.type.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol}))+")"),t.join(e.eol)}static parse(e,...n){if(n.includes("Array"))throw"Recursion prevention!";return e.newContext(((i,r)=>{let s=t.Type.parse(e,...n,"Array");a.expect(i(),"["),a.expect(i(),"]");let l=new d(s);for(;;)try{e.newContext(((e,t)=>{a.expect(e(),"["),a.expect(e(),"]"),l=new d(l)}))}catch(e){break}return l}))}}t.ArrayType=d;class r{constructor(){}generateType(e){return"boolean"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.Boolean)) {"),t.push("\t\treturn subject as boolean;"),t.push("\t}"),t.push('\tthrow "Expected a boolean at " + path + "!";'),t.push("}")):t.push("autoguard.Boolean"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>(a.expect(e(),"boolean"),r.INSTANCE)))}}t.BooleanType=r,r.INSTANCE=new r;class s{constructor(e){this.value=e}generateType(e){return""+this.value}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif (subject === "+this.generateType(Object.assign(Object.assign({},e),{eol:e.eol+"\t"}))+") {"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected '+this.value+' at " + path + "!";'),t.push("}")):t.push("autoguard.BooleanLiteral.of("+this.generateType(Object.assign(Object.assign({},e),{eol:e.eol}))+")"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>"true"===a.expect(e(),["true","false"]).family?s.INSTANCE_TRUE:s.INSTANCE_FALSE))}}t.BooleanLiteralType=s,s.INSTANCE_TRUE=new s(!0),s.INSTANCE_FALSE=new s(!1);class l{constructor(e){this.type=e}generateType(e){return"("+this.type.generateType(e)+")"}generateTypeGuard(e){return this.type.generateTypeGuard(e)}static parse(e){return e.newContext(((n,i)=>{a.expect(n(),"(");let d=t.Type.parse(e);return a.expect(n(),")"),new l(d)}))}}t.GroupType=l;class o{constructor(){this.types=new Set}add(e){return this.types.add(e),this}generateType(e){let t=new Array;for(let n of this.types)t.push(n.generateType(e));return t.join(" & ")}generateTypeGuard(e){let t=new Array;if(e.standalone){t.push("(subject, path) => {");for(let n of this.types)t.push("\t("+n.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t"}))+")(subject, path);");return t.push("\treturn subject;"),t.push("}"),t.join(e.eol)}for(let n of this.types)t.push("\t"+n.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t"})));return"autoguard.Intersection.of("+e.eol+t.join(","+e.eol)+e.eol+")"}static parse(e,...n){if(n.includes("Intersection"))throw"Recursion prevention!";return e.newContext(((i,d)=>{var r;let s=t.Type.parse(e,...n,"Intersection"),l=new o;for(l.add(s);"&"===(null===(r=d())||void 0===r?void 0:r.value);){a.expect(i(),"&");let d=t.Type.parse(e,...n,"Intersection");l.add(d)}return 1===l.types.size?s:l}))}}t.IntersectionType=o;class c{constructor(){}generateType(e){return"null"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif (subject === null) {"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected null at " + path + "!";'),t.push("}")):t.push("autoguard.Null"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>(a.expect(e(),"null"),c.INSTANCE)))}}t.NullType=c,c.INSTANCE=new c;class p{constructor(){}generateType(e){return"number"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.Number)) {"),t.push("\t\treturn subject as number;"),t.push("\t}"),t.push('\tthrow "Expected a number at " + path + "!";'),t.push("}")):t.push("autoguard.Number"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>(a.expect(e(),"number"),p.INSTANCE)))}}t.NumberType=p,p.INSTANCE=new p;class u{constructor(e){this.value=e}generateType(e){return""+this.value}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif (subject === "+this.generateType(Object.assign(Object.assign({},e),{eol:e.eol+"\t"}))+") {"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected '+this.value+' at " + path + "!";'),t.push("}")):t.push("autoguard.NumberLiteral.of("+this.generateType(Object.assign(Object.assign({},e),{eol:e.eol}))+")"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>{let n=a.expect(e(),"NUMBER_LITERAL").value;return new u(Number.parseInt(n))}))}}t.NumberLiteralType=u;class h{constructor(){this.members=new Map}add(e,t){return this.members.set(e,t),this}generateType(e){if(0===this.members.size)return"{}";let t=new Array;for(let[n,a]of this.members)t.push('\t"'+n+'"'+(a.optional?"?":"")+": "+a.type.generateType(Object.assign(Object.assign({},e),{eol:e.eol+"\t"})));return"{"+(t.length>0?e.eol+t.join(","+e.eol)+e.eol:"")+"}"}generateTypeGuard(e){let t=new Array;if(e.standalone){t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.Object)) {");for(let[n,a]of this.members){let i=a.type;if(a.optional){let e=new x;e.add(y.INSTANCE),e.add(i),i=e}let d=/^([a-z][a-z0-9_]*)$/is.test(n)?'".'+n+'"':'"[\\"'+n+'\\"]"';t.push("\t\t("+i.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t"}))+')(subject["'+n+'"], path + '+d+");")}return t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected an object at " + path + "!";'),t.push("}"),t.join(e.eol)}for(let[n,a]of this.members){let i=a.type;if(a.optional){let e=new x;e.add(y.INSTANCE),e.add(i),i=e}t.push('\t"'+n+'": '+i.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t"})))}return"autoguard.Object.of<"+(null!=this.typename?this.typename:this.generateType(e))+">({"+(t.length>0?e.eol+t.join(","+e.eol)+e.eol:"")+"})"}setTypename(e){this.typename=e}static parse(e){return e.newContext(((n,i)=>{var d,r,s;a.expect(n(),"{");let l=new h;if("}"!==(null===(d=i())||void 0===d?void 0:d.value))for(;;){let d=!1,o=a.expect(n(),["any","boolean","false","null","number","string","true","undefined","IDENTIFIER","STRING_LITERAL"]),c="STRING_LITERAL"===o.family?o.value.slice(1,-1):o.value;"?"===(null===(r=i())||void 0===r?void 0:r.value)&&(n(),d=!0),a.expect(n(),":");let p=t.Type.parse(e);if(l.add(c,{type:p,optional:d}),","!==(null===(s=i())||void 0===s?void 0:s.value))break;a.expect(n(),",")}return a.expect(n(),"}"),l}))}}t.ObjectType=h;class m{constructor(e){this.type=e}generateType(e){return"Record<string, undefined | "+this.type.generateType(e)+">"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.Object)) {"),t.push("\t\tfor (let key of globalThis.Object.keys(subject)) {"),t.push("\t\t\t("+this.type.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t\t"}))+')(subject[key], path + "[\\"" + key + "\\"]");'),t.push("\t\t}"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected a record at " + path + "!";'),t.push("}")):t.push("autoguard.Record.of("+this.type.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol}))+")"),t.join(e.eol)}static parse(e){return e.newContext(((n,i)=>{a.expect(n(),"{");let d=t.Type.parse(e);return a.expect(n(),"}"),new m(d)}))}}t.RecordType=m;class g{constructor(e){this.typename=e}generateType(e){return this.typename}generateTypeGuard(e){return e.standalone?this.typename+".as":"autoguard.Reference.of<"+this.typename+">(() => "+this.typename+")"}static parse(e){return e.newContext(((e,t)=>{var n;"@"===(null===(n=t())||void 0===n?void 0:n.family)&&a.expect(e(),"@");let i=a.expect(e(),"IDENTIFIER").value;return new g(i)}))}}t.ReferenceType=g;class f{constructor(){}generateType(e){return"string"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.String)) {"),t.push("\t\treturn subject as string;"),t.push("\t}"),t.push('\tthrow "Expected a string at " + path + "!";'),t.push("}")):t.push("autoguard.String"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>(a.expect(e(),"string"),f.INSTANCE)))}}t.StringType=f,f.INSTANCE=new f;class v{constructor(e){this.value=e}generateType(e){return'"'+this.value+'"'}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif (subject === "+this.generateType(Object.assign(Object.assign({},e),{eol:e.eol+"\t"}))+") {"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected \\"'+this.value+'\\" at " + path + "!";'),t.push("}")):t.push('autoguard.StringLiteral.of("'+this.value+'")'),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>{let n=a.expect(e(),"STRING_LITERAL").value;return new v(n.slice(1,-1))}))}}t.StringLiteralType=v;class b{constructor(){this.types=new Array}add(e){return this.types.push(e),this}generateType(e){let t=new Array;for(let n of this.types)t.push("\t"+n.generateType(Object.assign(Object.assign({},e),{eol:e.eol+"\t"})));return"["+(t.length>0?e.eol+t.join(","+e.eol)+e.eol:"")+"]"}generateTypeGuard(e){let t=new Array;if(e.standalone){t.push("(subject, path) => {"),t.push("\tif ((subject != null) && (subject.constructor === globalThis.Array)) {");for(let n=0;n<this.types.length;n++){let a=this.types[n];t.push("\t\t("+a.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t"}))+")(subject["+n+'], path + "['+n+']");')}return t.push("\t\treturn subject as "+this.generateType(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t"}))+";"),t.push("\t}"),t.push('\tthrow "Expected a tuple at " + path + "!";'),t.push("}"),t.join(e.eol)}for(let n of this.types)t.push("\t"+n.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t"})));return"autoguard.Tuple.of("+(t.length>0?e.eol+t.join(","+e.eol)+e.eol:"")+")"}static parse(e){return e.newContext(((n,i)=>{var d,r;a.expect(n(),"[");let s=new b;if("]"!==(null===(d=i())||void 0===d?void 0:d.value))for(;;){let d=t.Type.parse(e);if(s.add(d),","!==(null===(r=i())||void 0===r?void 0:r.value))break;a.expect(n(),",")}return a.expect(n(),"]"),s}))}}t.TupleType=b;class y{constructor(){}generateType(e){return"undefined"}generateTypeGuard(e){let t=new Array;return e.standalone?(t.push("(subject, path) => {"),t.push("\tif (subject === undefined) {"),t.push("\t\treturn subject;"),t.push("\t}"),t.push('\tthrow "Expected undefined at " + path + "!";'),t.push("}")):t.push("autoguard.Undefined"),t.join(e.eol)}static parse(e){return e.newContext(((e,t)=>(a.expect(e(),"undefined"),y.INSTANCE)))}}t.UndefinedType=y,y.INSTANCE=new y;class x{constructor(){this.types=new Set}add(e){return this.types.add(e),this}generateType(e){let t=new Array;for(let n of this.types)t.push(n.generateType(e));return t.join(" | ")}generateTypeGuard(e){let t=new Array;if(e.standalone){t.push("(subject, path) => {");for(let n of this.types)t.push("\ttry {"),t.push("\t\treturn ("+n.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t"}))+")(subject, path);"),t.push("\t} catch (error) {}");return t.push('\tthrow "Expected a union at " + path + "!";'),t.push("}"),t.join(e.eol)}for(let n of this.types)t.push("\t"+n.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t"})));return"autoguard.Union.of("+e.eol+t.join(","+e.eol)+e.eol+")"}static parse(e,...n){if(n.includes("Union"))throw"Recursion prevention!";return e.newContext(((i,d)=>{var r;let s=t.Type.parse(e,...n,"Union"),l=new x;for(l.add(s);"|"===(null===(r=d())||void 0===r?void 0:r.value);){a.expect(i(),"|");let d=t.Type.parse(e,...n,"Union");l.add(d)}return 1===l.types.size?s:l}))}}t.UnionType=x;class w{constructor(){this.types=new Map}add(e,t){return this.types.set(e,t),this}generateModule(e){let t=new Array;t.push("// This file was auto-generated by @joelek/ts-autoguard. Edit at own risk."),t.push(""),e.standalone||(t.push('import { guards as autoguard } from "@joelek/ts-autoguard";'),t.push(""));for(let[n,a]of this.types)t.push("export type "+n+" = "+a.generateType(e)+";"),t.push(""),e.standalone?(t.push("export const "+n+" = {"),t.push('\tas(subject: any, path: string = ""): '+n+" {"),t.push("\t\treturn ("+a.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol+"\t\t"}))+")(subject, path);"),t.push("\t},"),t.push("\tis(subject: any): subject is "+n+" {"),t.push("\t\ttry {"),t.push("\t\t\tthis.as(subject);"),t.push("\t\t} catch (error) {"),t.push("\t\t\treturn false;"),t.push("\t\t}"),t.push("\t\treturn true;"),t.push("\t}"),t.push("};"),t.push("")):(t.push("export const "+n+" = "+a.generateTypeGuard(Object.assign(Object.assign({},e),{eol:e.eol}))+";"),t.push(""));let n=new h;for(let[e,t]of this.types)n.add(e,{type:new g(e),optional:!1});return t.push("export type Autoguard = "+n.generateType(e)+";"),t.push(""),t.push("export const Autoguard = "+n.generateType(e)+";"),t.push(""),t.join(e.eol)}static parse(e){return e.newContext(((n,i)=>{var d,r,s;a.expect(n(),"{");let l=new w;if("}"!==(null===(d=i())||void 0===d?void 0:d.value))for(;;){let d=a.expect(n(),"IDENTIFIER").value;a.expect(n(),":");let o=t.Type.parse(e);if(null===(r=o.setTypename)||void 0===r||r.call(o,d),l.add(d,o),","!==(null===(s=i())||void 0===s?void 0:s.value))break;a.expect(n(),",")}if(a.expect(n(),"}"),null!=i())throw"Expected end of stream!";return l}))}}t.Schema=w},129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageSerializer=void 0,t.MessageSerializer=class{constructor(e){this.guards=e}deserialize(e,t){let n=JSON.parse(e);if(null==n||n.constructor!==Object||null==n.type||n.type.constructor!==String)throw"Invalid message envelope!";{let e=n.type,a=n.data,i=this.guards[e];if(void 0===i)throw'Unknown message type "'+e+'"!';t(e,i.as(a))}}serialize(e,t){return JSON.stringify({type:e,data:t})}}},329:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.expect=t.Tokenizer=t.Families=void 0,t.Families=["WS","(",")","[","]","{","}","?","|","&","@",",",":","any","boolean","false","null","number","string","true","undefined","IDENTIFIER","NUMBER_LITERAL","STRING_LITERAL"],t.Tokenizer=class{constructor(e){let t={WS:/^([\t\r\n ]+)/ius,"(":/^([\(])/ius,")":/^([\)])/ius,"[":/^([\[])/ius,"]":/^([\]])/ius,"{":/^([\{])/ius,"}":/^([\}])/ius,"?":/^([\?])/ius,"|":/^([\|])/ius,"&":/^([&])/ius,"@":/^([@])/ius,",":/^([,])/ius,":":/^([:])/ius,any:/^(any)/ius,boolean:/^(boolean)/ius,false:/^(false)/ius,null:/^(null)/ius,number:/^(number)/ius,string:/^(string)/ius,true:/^(true)/ius,undefined:/^(undefined)/ius,IDENTIFIER:/^([a-z][a-z0-9_]*)/ius,NUMBER_LITERAL:/^(([1-9][0-9]+)|([0-9]))/ius,STRING_LITERAL:/^(["][^"]*["])/ius},n=new Array,a=1,i=1;for(;e.length>0;){let d;for(let n in t){let a=n,i=t[a].exec(e);null!=i&&(null==d||i[1].length>d[1].length)&&(d=[a,i[1]])}if(null==d)throw`Unrecognized token at row ${a}, col ${i}!`;n.push({family:d[0],value:d[1],row:a,col:i}),e=e.slice(d[1].length);let r=d[1].split(/\r?\n/);r.length>1&&(a+=r.length-1,i=1),i+=r[r.length-1].length}this.tokens=n.filter((e=>"WS"!==e.family)),this.offset=0}peek(){return this.tokens[this.offset]}read(){if(this.offset>=this.tokens.length)throw"Unexpectedly reached end of stream!";return this.tokens[this.offset++]}newContext(e){let t=this.offset;try{return e((()=>this.read()),(()=>this.peek()))}catch(e){throw this.offset=t,e}}},t.expect=function(e,t){if(!(Array.isArray(t)?t:[t]).includes(e.family))throw`Unexpected ${e.family} at row ${e.row}, col ${e.col}!`;return e}},611:(e,t)=>{var n,a;t.GL=t.kQ=void 0,(a=t.kQ||(t.kQ={}))[a.CONNECTING=0]="CONNECTING",a[a.OPEN=1]="OPEN",a[a.CLOSING=2]="CLOSING",a[a.CLOSED=3]="CLOSED",(n=t.GL||(t.GL={}))[n.NORMAL=1e3]="NORMAL",n[n.GOING_AWAY=1001]="GOING_AWAY",n[n.PROTOCOL_ERROR=1002]="PROTOCOL_ERROR",n[n.DATA_TYPE_NOT_ACCEPTED=1003]="DATA_TYPE_NOT_ACCEPTED",n[n.RESERVED_1004=1004]="RESERVED_1004",n[n.RESERVED_1005=1005]="RESERVED_1005",n[n.RESERVED_1006=1006]="RESERVED_1006",n[n.BAD_DATA_TYPE=1007]="BAD_DATA_TYPE",n[n.POLICY_VIOLATION=1008]="POLICY_VIOLATION",n[n.MESSAGE_TOO_BIG=1009]="MESSAGE_TOO_BIG",n[n.CLIENT_EXPECTED_EXTENSION=1010]="CLIENT_EXPECTED_EXTENSION",n[n.SERVER_UNEXPECTED_CONDITION=1011]="SERVER_UNEXPECTED_CONDITION",n[n.RESERVED_1015=1015]="RESERVED_1015"},978:(e,t,n)=>{t.routing=n(220)},220:(e,t)=>{t.NamespacedMessageRouter=void 0;class n{constructor(){this.observers=new Map}addObserver(e,t){let n=this.observers.get(e);void 0===n&&(n=new Set,this.observers.set(e,n)),n.add(t)}removeObserver(e,t){let n=this.observers.get(e);void 0!==n&&n.delete(t)}route(e,t){let n=this.observers.get(e);if(void 0!==n)for(let e of n)e(t)}}t.NamespacedMessageRouter=class{constructor(){this.routers=new Map}addObserver(e,t,a){let i=this.routers.get(e);void 0===i&&(i=new n,this.routers.set(e,i)),i.addObserver(t,a)}removeObserver(e,t,n){let a=this.routers.get(e);void 0!==a&&a.removeObserver(t,n)}route(e,t,n){let a=this.routers.get(e);void 0!==a&&a.route(t,n)}}}},t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}(()=>{function e(e,t){return"s"+("00"+e).slice(-2)+"e"+("00"+t).slice(-2)}const t={eng:{title:"English",iso639_1:"en",iso3166_1:"US"},swe:{title:"Swedish",iso639_1:"sv",iso3166_1:"SE"},jpn:{title:"Japanese",iso639_1:"ja",iso3166_1:"JP"}};function a(e){navigator.mediaSession&&(navigator.mediaSession.metadata=new globalThis.MediaMetadata(e))}class i{constructor(e){this.state=e,this.observers=new Array}addObserver(e){let t=new i(e(this.state));return this.observers.push((n=>{t.updateState(e(n))})),t.addObserver.bind(t)}getState(){return this.state}updateState(e){if(e!==this.state){this.state=e;for(let e of this.observers)e(this.state)}}}function d(e,...t){let n=new i(e(...t.map((e=>e.getState())))),a=()=>{n.updateState(e(...t.map((e=>e.getState()))))};for(let e of t)e.addObserver(a);return n}class r{constructor(e){this.state=e,this.observers=new Array}addObserver(e){var t;this.observers.push(e),null===(t=e.onupdate)||void 0===t||t.call(e,this.state)}compute(e){let t=new i(e(this.state));return this.observers.push({onupdate(n){t.updateState(e(n))}}),t.addObserver.bind(t)}getState(){return this.state}append(e){var t,n;this.state.push(e);for(let a of this.observers)null===(t=a.onappend)||void 0===t||t.call(a,e),null===(n=a.onupdate)||void 0===n||n.call(a,this.state)}splice(e){var t,n;if(e<0||e>=this.state.length)throw`Expected an index of at most ${this.state.length}, got ${e}!`;let a=this.state[e];this.state.splice(e,1);for(let i of this.observers)null===(t=i.onsplice)||void 0===t||t.call(i,a,e),null===(n=i.onupdate)||void 0===n||n.call(i,this.state)}update(e){for(let e=this.state.length-1;e>=0;e--)this.splice(e);for(let t of e)this.append(t)}}function s(e){return null==e}function l(e){return null!=e}var o=n(175);const c=o.l8.Object.of({artist_id:o.l8.String,title:o.l8.String}),p=o.l8.Intersection.of(o.l8.Reference.of((()=>c)),o.l8.Object.of({albums:o.l8.Array.of(o.l8.Reference.of((()=>h)))})),u=o.l8.Object.of({album_id:o.l8.String,title:o.l8.String,year:o.l8.Number,artists:o.l8.Array.of(o.l8.Reference.of((()=>c))),artwork:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>N)))}),h=o.l8.Intersection.of(o.l8.Reference.of((()=>u)),o.l8.Object.of({discs:o.l8.Array.of(o.l8.Reference.of((()=>g)))})),m=o.l8.Object.of({disc_id:o.l8.String,album:o.l8.Reference.of((()=>u)),number:o.l8.Number}),g=o.l8.Intersection.of(o.l8.Reference.of((()=>m)),o.l8.Object.of({tracks:o.l8.Array.of(o.l8.Reference.of((()=>v)))})),f=o.l8.Object.of({track_id:o.l8.String,title:o.l8.String,disc:o.l8.Reference.of((()=>m)),artists:o.l8.Array.of(o.l8.Reference.of((()=>c))),file:o.l8.Reference.of((()=>L)),number:o.l8.Number,last_stream_date:o.l8.Union.of(o.l8.Undefined,o.l8.Number)}),v=o.l8.Intersection.of(o.l8.Reference.of((()=>f)),o.l8.Object.of({})),b=o.l8.Object.of({user_id:o.l8.String,username:o.l8.String}),y=(o.l8.Intersection.of(o.l8.Reference.of((()=>b)),o.l8.Object.of({})),o.l8.Object.of({playlist_id:o.l8.String,title:o.l8.String,description:o.l8.String,user:o.l8.Reference.of((()=>b))})),x=o.l8.Intersection.of(o.l8.Reference.of((()=>y)),o.l8.Object.of({items:o.l8.Array.of(o.l8.Reference.of((()=>_)))})),w=o.l8.Object.of({number:o.l8.Number,playlist:o.l8.Reference.of((()=>y)),track:o.l8.Reference.of((()=>v))}),_=o.l8.Intersection.of(o.l8.Reference.of((()=>w)),o.l8.Object.of({})),S=o.l8.Object.of({genre_id:o.l8.String,title:o.l8.String}),k=o.l8.Intersection.of(o.l8.Reference.of((()=>S)),o.l8.Object.of({})),E=o.l8.Object.of({movie_id:o.l8.String,title:o.l8.String,year:o.l8.Number,summary:o.l8.String,artwork:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>N))),file:o.l8.Reference.of((()=>z)),subtitles:o.l8.Array.of(o.l8.Reference.of((()=>$))),last_stream_date:o.l8.Union.of(o.l8.Undefined,o.l8.Number)}),C=o.l8.Intersection.of(o.l8.Reference.of((()=>E)),o.l8.Object.of({genres:o.l8.Array.of(o.l8.Reference.of((()=>k)))})),O=o.l8.Object.of({show_id:o.l8.String,title:o.l8.String,artwork:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>N)))}),T=o.l8.Intersection.of(o.l8.Reference.of((()=>O)),o.l8.Object.of({seasons:o.l8.Array.of(o.l8.Reference.of((()=>A))),genres:o.l8.Array.of(o.l8.Reference.of((()=>k)))})),j=o.l8.Object.of({season_id:o.l8.String,number:o.l8.Number,show:o.l8.Reference.of((()=>O))}),A=o.l8.Intersection.of(o.l8.Reference.of((()=>j)),o.l8.Object.of({episodes:o.l8.Array.of(o.l8.Reference.of((()=>R)))})),I=o.l8.Object.of({episode_id:o.l8.String,title:o.l8.String,summary:o.l8.String,number:o.l8.Number,file:o.l8.Reference.of((()=>z)),subtitles:o.l8.Array.of(o.l8.Reference.of((()=>$))),season:o.l8.Reference.of((()=>j)),year:o.l8.Union.of(o.l8.Undefined,o.l8.Number),last_stream_date:o.l8.Union.of(o.l8.Undefined,o.l8.Number)}),R=o.l8.Intersection.of(o.l8.Reference.of((()=>I)),o.l8.Object.of({})),P=o.l8.Object.of({file_id:o.l8.String,mime:o.l8.String}),L=o.l8.Intersection.of(o.l8.Reference.of((()=>P)),o.l8.Object.of({duration_ms:o.l8.Number})),N=o.l8.Intersection.of(o.l8.Reference.of((()=>P)),o.l8.Object.of({height:o.l8.Number,width:o.l8.Number})),$=o.l8.Intersection.of(o.l8.Reference.of((()=>P)),o.l8.Object.of({language:o.l8.Union.of(o.l8.Undefined,o.l8.String)})),z=o.l8.Intersection.of(o.l8.Reference.of((()=>P)),o.l8.Object.of({duration_ms:o.l8.Number})),D=o.l8.Reference.of((()=>h)),U=o.l8.Reference.of((()=>p)),M=o.l8.Reference.of((()=>v)),G=o.l8.Reference.of((()=>x)),V=o.l8.Reference.of((()=>C)),B=o.l8.Reference.of((()=>T)),H=o.l8.Reference.of((()=>A)),F=o.l8.Reference.of((()=>R)),W=o.l8.Union.of(o.l8.Reference.of((()=>D)),o.l8.Reference.of((()=>U)),o.l8.Reference.of((()=>M)),o.l8.Reference.of((()=>G)),o.l8.Reference.of((()=>V)),o.l8.Reference.of((()=>B)),o.l8.Reference.of((()=>H)),o.l8.Reference.of((()=>F))),X=(o.l8.Union.of(o.l8.Reference.of((()=>M)),o.l8.Reference.of((()=>V)),o.l8.Reference.of((()=>F))),o.l8.Object.of({id:o.l8.String,type:o.l8.String,name:o.l8.String})),Y=(o.l8.Object.of({context:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>W))),device:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>X))),index:o.l8.Union.of(o.l8.Undefined,o.l8.Number),playback:o.l8.Boolean,progress:o.l8.Union.of(o.l8.Undefined,o.l8.Number)}),{SetContext:o.l8.Object.of({context:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>W)))}),SetDevice:o.l8.Object.of({device:o.l8.Union.of(o.l8.Undefined,o.l8.Reference.of((()=>X)))}),SetDevices:o.l8.Object.of({devices:o.l8.Array.of(o.l8.Reference.of((()=>X)))}),SetIndex:o.l8.Object.of({index:o.l8.Union.of(o.l8.Undefined,o.l8.Number)}),SetLocalDevice:o.l8.Object.of({device:o.l8.Reference.of((()=>X))}),SetPlayback:o.l8.Object.of({playback:o.l8.Boolean}),SetProgress:o.l8.Object.of({progress:o.l8.Union.of(o.l8.Undefined,o.l8.Number)}),SetToken:o.l8.Object.of({token:o.l8.Union.of(o.l8.Undefined,o.l8.String)})});var J=n(978),q=n(611);class Q{constructor(e,t,n){this.nextConnectionAttemptDelayFactor=2+Math.random(),this.nextConnectionAttemptDelay=2e3,this.router=new J.routing.NamespacedMessageRouter,this.serializer=new o.m7.MessageSerializer(n),this.url=e,this.factory=t,this.socket=t(e),this.socket.addEventListener("close",this.onClose.bind(this)),this.socket.addEventListener("error",this.onError.bind(this)),this.socket.addEventListener("message",this.onMessage.bind(this)),this.socket.addEventListener("open",this.onOpen.bind(this))}onClose(e){this.router.route("sys","disconnect",{})}onError(e){setTimeout((()=>{this.socket=this.factory(this.url),this.socket.addEventListener("close",this.onClose.bind(this)),this.socket.addEventListener("error",this.onError.bind(this)),this.socket.addEventListener("message",this.onMessage.bind(this)),this.socket.addEventListener("open",this.onOpen.bind(this))}),this.nextConnectionAttemptDelay),this.nextConnectionAttemptDelay=Math.round(this.nextConnectionAttemptDelay*this.nextConnectionAttemptDelayFactor)}onMessage(e){let t=e.data;this.serializer.deserialize(t,((e,t)=>{this.router.route("sys","message",{type:e,data:t}),this.router.route("app",e,t)}))}onOpen(e){this.nextConnectionAttemptDelay=2e3,this.router.route("sys","connect",{})}addEventListener(e,t,n){this.router.addObserver(e,t,n)}close(){this.socket.close()}removeEventListener(e,t,n){this.router.addObserver(e,t,n)}send(e,t){if(this.socket.readyState===q.kQ.OPEN)this.socket.send(this.serializer.serialize(e,t));else{let n=()=>{this.socket.removeEventListener("open",n),this.socket.send(this.serializer.serialize(e,t))};this.socket.addEventListener("open",n)}}}var K,Z=function(e,t,n,a){return new(n||(n=Promise))((function(i,d){function r(e){try{l(a.next(e))}catch(e){d(e)}}function s(e){try{l(a.throw(e))}catch(e){d(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,s)}l((a=a.apply(e,t||[])).next())}))};let ee=new class{constructor(e,t=(e=>new WebSocket(e))){this.estimatedProgress=new i(void 0),this.estimatedProgressTimestamp=new i(void 0),this.token=new i(void 0),this.localDevice=new i(void 0),this.devices=new r(new Array),this.device=new i(void 0),this.isDeviceLocal=new i(!1),this.isDeviceRemote=new i(!1),this.context=new i(void 0),this.contextPath=new i(void 0),this.flattenedContext=new i(void 0),this.lastIndex=new i(void 0),this.lastEntry=new i(void 0),this.lastLocalEntry=new i(void 0),this.currentIndex=new i(void 0),this.currentEntry=new i(void 0),this.currentLocalEntry=new i(void 0),this.nextIndex=new i(void 0),this.nextEntry=new i(void 0),this.nextLocalEntry=new i(void 0),this.playback=new i(!1),this.progress=new i(void 0),this.localPlayback=new i(!1),this.canPlayLast=new i(!1),this.canPlayCurrent=new i(!1),this.canPlayNext=new i(!1),this.isCurrentEntryVideo=new i(!1),this.tsc=new Q(e,t,Y),this.context.addObserver((e=>{if(l(e))if(D.is(e)){let t=[],n=e;for(let e of n.discs)t.push(...e.tracks);this.flattenedContext.updateState(t)}else if(U.is(e)){let t=[],n=e;for(let e of n.albums)for(let n of e.discs)t.push(...n.tracks);this.flattenedContext.updateState(t)}else if(F.is(e)){let t=[],n=e;t.push(n),this.flattenedContext.updateState(t)}else if(V.is(e)){let t=[],n=e;t.push(n),this.flattenedContext.updateState(t)}else if(G.is(e)){let t=[],n=e;for(let e of n.items)t.push(e.track);this.flattenedContext.updateState(t)}else if(H.is(e)){let t=[],n=e;t.push(...n.episodes),this.flattenedContext.updateState(t)}else if(B.is(e)){let t=[],n=e;for(let e of n.seasons)t.push(...e.episodes);this.flattenedContext.updateState(t)}else{if(!M.is(e))throw"Expected code to be unreachable!";{let t=[],n=e;t.push(n),this.flattenedContext.updateState(t)}}}));{let e=()=>{let e=this.context.getState(),t=this.currentIndex.getState();if(l(e)&&l(t)){if(D.is(e)){let n=0,a=t,i=e.discs;for(let e=0;e<i.length;e++){let t=i[e].tracks.length;if(!(a>=t))break;n+=1,a-=t}return this.contextPath.updateState([e.album_id,e.discs[n].disc_id,e.discs[n].tracks[a].track_id])}if(U.is(e)){let n=0,a=0,i=t,d=e.albums;e:for(let e=0;e<d.length;e++){let t=d[e].discs;for(let e=0;e<t.length;e++){let n=t[e].tracks.length;if(!(i>=n))break e;a+=1,i-=n}n+=1,a=0}return this.contextPath.updateState([e.artist_id,e.albums[n].album_id,e.albums[n].discs[a].disc_id,e.albums[n].discs[a].tracks[i].track_id])}if(F.is(e))return this.contextPath.updateState([e.episode_id]);if(V.is(e))return this.contextPath.updateState([e.movie_id]);if(G.is(e)){let n=t;return this.contextPath.updateState([e.playlist_id,e.items[n].track.track_id])}if(B.is(e)){let n=0,a=t,i=e.seasons;for(let e=0;e<i.length;e++){let t=i[e].episodes.length;if(!(a>=t))break;n+=1,a-=t}return this.contextPath.updateState([e.show_id,e.seasons[n].season_id,e.seasons[n].episodes[a].episode_id])}if(H.is(e)){let n=t;return this.contextPath.updateState([e.season_id,e.episodes[n].episode_id])}if(M.is(e))return this.contextPath.updateState([e.track_id]);throw"Expected code to be unreachable!"}this.contextPath.updateState(void 0)};this.context.addObserver(e),this.currentIndex.addObserver(e)}this.lastEntry.addObserver((e=>{this.canPlayLast.updateState(l(e))})),this.currentEntry.addObserver((e=>{this.canPlayCurrent.updateState(l(e))})),this.nextEntry.addObserver((e=>{this.canPlayNext.updateState(l(e))})),this.progress.addObserver((e=>{this.estimatedProgress.updateState(e),this.estimatedProgressTimestamp.updateState(Date.now())})),this.playback.addObserver((e=>{let t=this.estimatedProgress.getState(),n=this.estimatedProgressTimestamp.getState(),a=Date.now();e||l(t)&&l(n)&&this.estimatedProgress.updateState(t+(a-n)/1e3),this.estimatedProgressTimestamp.updateState(a)})),this.estimatedProgress.addObserver((e=>{console.log("Estimated progress to "+(null!=e?e:0))}));{let e=()=>{let e=this.playback.getState(),t=this.isDeviceLocal.getState();this.localPlayback.updateState(t&&e)};this.playback.addObserver(e),this.isDeviceLocal.addObserver(e)}{let e=()=>{let e=this.lastEntry.getState(),t=this.isDeviceLocal.getState();this.lastLocalEntry.updateState(t?e:void 0)};this.lastEntry.addObserver(e),this.isDeviceLocal.addObserver(e)}{let e=()=>{let e=this.currentEntry.getState(),t=this.isDeviceLocal.getState();this.currentLocalEntry.updateState(t?e:void 0)};this.currentEntry.addObserver(e),this.isDeviceLocal.addObserver(e)}{let e=()=>{let e=this.nextEntry.getState(),t=this.isDeviceLocal.getState();this.nextLocalEntry.updateState(t?e:void 0)};this.nextEntry.addObserver(e),this.isDeviceLocal.addObserver(e)}{let e=()=>{let e=this.localDevice.getState(),t=this.device.getState();return l(e)&&l(t)&&e.id===t.id?this.isDeviceLocal.updateState(!0):this.isDeviceLocal.updateState(!1)};this.localDevice.addObserver(e),this.device.addObserver(e)}{let e=()=>{let e=this.localDevice.getState(),t=this.device.getState();return l(e)&&l(t)&&e.id!==t.id?this.isDeviceRemote.updateState(!0):this.isDeviceRemote.updateState(!1)};this.localDevice.addObserver(e),this.device.addObserver(e)}{let e=()=>{let e=this.flattenedContext.getState(),t=this.currentIndex.getState();if(l(e)&&l(t)){let n=t-1;if(n>=0&&n<e.length)return this.lastIndex.updateState(n)}return this.lastIndex.updateState(void 0)};this.flattenedContext.addObserver(e),this.currentIndex.addObserver(e)}{let e=()=>{let e=this.flattenedContext.getState(),t=this.currentIndex.getState();if(l(e)&&l(t)){let n=t+1;if(n>=0&&n<e.length)return this.nextIndex.updateState(n)}return this.nextIndex.updateState(void 0)};this.flattenedContext.addObserver(e),this.currentIndex.addObserver(e)}{let e=()=>{let e=this.flattenedContext.getState(),t=this.lastIndex.getState();return l(e)&&l(t)?this.lastEntry.updateState(e[t]):this.lastEntry.updateState(void 0)};this.flattenedContext.addObserver(e),this.lastIndex.addObserver(e)}{let e=()=>{let e=this.flattenedContext.getState(),t=this.currentIndex.getState();return l(e)&&l(t)&&t>=0&&t+0<e.length?this.currentEntry.updateState(e[t+0]):this.currentEntry.updateState(void 0)};this.flattenedContext.addObserver(e),this.currentIndex.addObserver(e)}{let e=()=>{let e=this.flattenedContext.getState(),t=this.nextIndex.getState();return l(e)&&l(t)?this.nextEntry.updateState(e[t]):this.nextEntry.updateState(void 0)};this.flattenedContext.addObserver(e),this.nextIndex.addObserver(e)}this.token.addObserver((e=>{this.tsc.send("SetToken",{token:e})})),this.tsc.addEventListener("app","SetLocalDevice",(e=>{this.localDevice.updateState(e.device)})),this.tsc.addEventListener("app","SetDevices",(e=>{this.devices.update(e.devices)})),this.tsc.addEventListener("app","SetContext",(e=>{this.context.updateState(e.context)})),this.tsc.addEventListener("app","SetDevice",(e=>{this.device.updateState(e.device)})),this.tsc.addEventListener("app","SetIndex",(e=>{this.currentIndex.updateState(e.index)})),this.tsc.addEventListener("app","SetPlayback",(e=>{this.playback.updateState(e.playback)})),this.tsc.addEventListener("app","SetProgress",(e=>{this.progress.updateState(e.progress)})),this.tsc.addEventListener("app","SetToken",(e=>{this.token.updateState(e.token)}))}play(e,t){this.tsc.send("SetContext",{context:e}),this.tsc.send("SetIndex",{index:t}),this.resume()}authenticate(e){this.tsc.send("SetToken",{token:e})}close(){this.tsc.close()}last(){let e=this.lastIndex.getState();l(e)&&(this.currentIndex.updateState(e),this.tsc.send("SetIndex",{index:e}))}next(){let e=this.nextIndex.getState();l(e)&&(this.currentIndex.updateState(e),this.tsc.send("SetIndex",{index:e}))}pause(){this.playback.updateState(!1),this.tsc.send("SetPlayback",{playback:!1})}playAlbum(e,t,n){let a=0;if(l(t)){let i=e.discs;if(t<0||t>=i.length)throw`Expected ${t} to be a number between 0 and ${i.length}!`;if(a+=i.slice(0,t).reduce(((e,t)=>e+t.tracks.length),0),l(n)){let e=i[t].tracks;if(n<0||n>=e.length)throw`Expected ${n} to be a number between 0 and ${e.length}!`;a+=n}}return this.play(e,a)}playArtist(e,t,n,a){let i=0;if(l(t)){let d=e.albums;if(t<0||t>=d.length)throw`Expected ${t} to be a number between 0 and ${d.length}!`;if(i+=d.slice(0,t).reduce(((e,t)=>e+t.discs.reduce(((e,t)=>e+t.tracks.length),0)),0),l(n)){let e=d[t].discs;if(n<0||n>=e.length)throw`Expected ${n} to be a number between 0 and ${e.length}!`;if(i+=e.slice(0,n).reduce(((e,t)=>e+t.tracks.length),0),l(a)){let t=e[n].tracks;if(a<0||a>=t.length)throw`Expected ${a} to be a number between 0 and ${t.length}!`;i+=a}}}return this.play(e,i)}playEpisode(e){this.play(e,0)}playMovie(e){this.play(e,0)}playPlaylist(e,t){let n=0;if(l(t)){let a=e.items;if(t<0||t>=a.length)throw`Expected ${t} to be a number between 0 and ${a.length}!`;n+=t}return this.play(e,n)}playSeason(e,t){let n=0;if(l(t)){let a=e.episodes;if(t<0||t>=a.length)throw`Expected ${t} to be a number between 0 and ${a.length}!`;n+=t}return this.play(e,n)}playShow(e,t,n){let a=0;if(l(t)){let i=e.seasons;if(t<0||t>=i.length)throw`Expected ${t} to be a number between 0 and ${i.length}!`;if(a+=i.slice(0,t).reduce(((e,t)=>e+t.episodes.length),0),l(n)){let e=i[t].episodes;if(n<0||n>=e.length)throw`Expected ${n} to be a number between 0 and ${e.length}!`;a+=n}}return this.play(e,a)}playTrack(e){this.play(e,0)}resume(){this.playback.updateState(!0),this.tsc.send("SetPlayback",{playback:!0})}seek(e){this.tsc.send("SetProgress",{progress:e})}toggle(){this.playback.getState()?this.pause():this.resume()}transfer(e){this.tsc.send("SetDevice",{device:e})}}(`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}/sockets/context/?type=browser&name=Browser`),te=document.createElement("video"),ne=document.createElement("video"),ae=document.createElement("video");ne.addEventListener("ended",(()=>{ee.next()}));let ie=new i(!0);ne.addEventListener("loadeddata",(()=>{ie.updateState(!1)})),ee.playback.addObserver((e=>{ne.autoplay=e})),ne.addEventListener("playing",(()=>{ee.isCurrentEntryVideo.updateState(ne.videoWidth>0&&ne.videoHeight>0)}));{let e=()=>Z(void 0,void 0,void 0,(function*(){var e;ie.getState()||(ne.currentTime=null!==(e=ee.progress.getState())&&void 0!==e?e:0)}));ee.progress.addObserver(e),ie.addObserver(e)}{let e=()=>Z(void 0,void 0,void 0,(function*(){if(!ie.getState())if(ee.playback.getState())try{yield ne.play()}catch(e){}else ne.pause()}));ee.playback.addObserver(e),ie.addObserver(e)}{let e=()=>{let e=ee.canPlayLast.getState(),t=ee.canPlayCurrent.getState(),n=ee.canPlayNext.getState();!function(e){if(navigator.mediaSession)for(let t in e)navigator.mediaSession.setActionHandler(t,e[t])}({play:t?ee.resume.bind(ee):void 0,pause:t?ee.pause.bind(ee):void 0,previoustrack:e?ee.last.bind(ee):void 0,nexttrack:n?ee.next.bind(ee):void 0})};ee.canPlayLast.addObserver(e),ee.canPlayCurrent.addObserver(e),ee.canPlayNext.addObserver(e)}let de=new i(""),re=new i("");ee.currentEntry.addObserver((e=>{if(l(e))if(R.is(e)){let t=e,n=t.season.show;de.updateState(t.title),re.updateState(n.title),a({title:t.title})}else if(C.is(e)){let t=e;de.updateState(t.title),re.updateState(""),a({title:t.title,artwork:s(t.artwork)?void 0:[{src:`/files/${t.artwork.file_id}/?token=${fe}`,sizes:`${t.artwork.width}x${t.artwork.height}`,type:t.artwork.mime}]})}else{if(!v.is(e))throw"Expected code to be unreachable!";{let t=e,n=t.disc.album;de.updateState(t.title),re.updateState(t.artists.map((e=>e.title)).join(" · ")),a({title:t.title,artist:t.artists.map((e=>e.title)).join(" · "),album:n.title,artwork:s(n.artwork)?void 0:[{src:`/files/${n.artwork.file_id}/?token=${fe}`,sizes:`${n.artwork.width}x${n.artwork.height}`,type:n.artwork.mime}]})}}else de.updateState(""),re.updateState(""),a({})}));{let e=()=>{let e=ee.lastLocalEntry.getState(),t=ee.token.getState();s(e)||s(t)?te.src="":te.src=`/files/${e.file.file_id}/?token=${t}`};ee.lastLocalEntry.addObserver(e),ee.token.addObserver(e)}{let e=()=>{var e;ie.updateState(!0);let n=ee.currentLocalEntry.getState(),a=ee.token.getState();if(s(n)||s(a))ne.src="";else{for(ne.src=`/files/${n.file.file_id}/?token=${a}`;null!=ne.lastChild;)ne.removeChild(ne.lastChild);if(C.is(n)||R.is(n)){let i=n.subtitles,d=null!==(e=i.find((e=>"swe"===e.language)))&&void 0!==e?e:i.find((e=>"eng"===e.language));for(let e of i){let n=document.createElement("track");if(n.src=`/files/${e.file_id}/?token=${a}`,l(e.language)){let a=t[e.language];l(a)&&(n.label=a.title,n.srclang=a.iso639_1,n.kind="subtitles"),e===d&&n.setAttribute("default","")}ne.appendChild(n)}}}};ee.currentLocalEntry.addObserver(e),ee.token.addObserver(e)}{let e=()=>{let e=ee.nextLocalEntry.getState(),t=ee.token.getState();s(e)||s(t)?te.src="":te.src=`/files/${e.file.file_id}/?token=${t}`};ee.nextLocalEntry.addObserver(e),ee.token.addObserver(e)}var se;!function(e){class t{constructor(e){this.content=e}render(){let e=document.createTextNode("");return this.content instanceof i?this.content.addObserver((t=>{e.textContent=t})):e.textContent=this.content,e}}e.Text=t;class n{constructor(e){let t=e.split(".");this.tag=t[0],this.attributes=new Map,this.children=new Array,this.bound=new Map,this.bound2=new Map,this.listeners=new Map;let n=t.slice(1).join(" ");""!==n&&this.attributes.set("class",n)}add(...e){for(let t of e)null!=t&&this.children.push(t);return this}bind(e,t){return this.bound.set(e,t),this}bind2(e,t){return this.bound2.set(e,t),this}on(e,t){let n=this.listeners.get(e);return null==n&&(n=new Array,this.listeners.set(e,n)),n.push((e=>{e.preventDefault(),e.stopPropagation(),t(e)})),this}render(){let e=["svg","path"].indexOf(this.tag)>=0?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",t=document.createElementNS(e,this.tag);for(let[e,n]of this.listeners)for(let a of n)t.addEventListener(e,a);for(let[e,n]of this.attributes)t.setAttribute(e,n);for(let[e,n]of this.bound)n((n=>{t.setAttribute(e,""+n)}));for(let[e,n]of this.bound2)n.addObserver((n=>{t.setAttribute(e,""+n)})),"input"===this.tag&&"value"===e&&t.addEventListener("change",(()=>{n.updateState(t.value)}));for(let e of this.children)t.appendChild(e.render());return this.array&&this.array.addObserver({onupdate:e=>{if(this.renderer){for(;t.firstChild;)t.firstChild.remove();for(let n of e)t.appendChild(this.renderer(n).render())}}}),t}repeat(e,t){return this.array=e,this.renderer=t,this}set(e,t=""){return this.attributes.set(e,t),this}}e.XElement=n,e.element=function(e){return new n(e)},e.text=function(e){return new t(e)}}(se||(se={}));const le="rgb(223, 79, 127)";let oe=document.createElement("style");oe.innerText=`\n\t::-webkit-scrollbar {\n\t\tbackground-color: transparent;\n\t\theight: 8px;\n\t\twidth: 8px;\n\t}\n\n\t::-webkit-scrollbar-corner {\n\t\tbackground-color: transparent;\n\t}\n\n\t::-webkit-scrollbar-thumb {\n\t\tbackground-color: rgba(255, 255, 255, 0.125);\n\t\tborder-radius: 4px;\n\t}\n\n\t* {\n\t\tborder: none;\n\t\tfont-size: 0px;\n\t\tmargin: 0px;\n\t\tline-height: 1;\n\t\toutline: none;\n\t\tpadding: 0px;\n\t}\n\n\ta {\n\t\tcolor: inherit;\n\t\tdisplay: inline-block;\n\t\tfont-size: inherit;\n\t\ttext-decoration: none;\n\t\ttransition: color 0.1s;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\ta:hover {\n\t\t\tcolor: rgb(255, 255, 255);\n\t\t}\n\t}\n\n\thtml {\n\t\theight: 100%;\n\t}\n\n\tbody {\n\t\theight: 100%;\n\t}\n\n\t.page-header {\n\t\tbackground-color: ${le};\n\t}\n\n\t.page-header__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tcursor: pointer;\n\t\tfont-family: "Pacifico", cursive;\n\t\tfont-size: 32px;\n\t\ttransform-origin: left;\n\t\ttransition: transform 0.1s;\n\t\twhite-space: nowrap;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.page-header__title:hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\t}\n\n\t[data-hide="true"] {\n\t\tdisplay: none !important;\n\t}\n\n\t[data-grid] {\n\t\tmargin: 0px auto;\n\t\tmax-width: 960px;\n\t\tmin-width: 160px;\n\t\tpadding: 16px;\n\t}\n\n\t[data-cell] {\n\t\tdisplay: inline-block;\n\t\tvertical-align: top;\n\t}\n\n\t@media all and (max-width: 319px) {\n\t\t[data-cell^="1:"] {\n\t\t\twidth: 16.66%;\n\t\t}\n\n\t\t[data-cell^="2:"] {\n\t\t\twidth: 33.33%;\n\t\t}\n\n\t\t[data-cell^="3:"] {\n\t\t\twidth: 50.00%;\n\t\t}\n\n\t\t[data-cell^="4:"] {\n\t\t\twidth: 66.66%;\n\t\t}\n\n\t\t[data-cell^="5:"] {\n\t\t\twidth: 83.33%;\n\t\t}\n\n\t\t[data-cell^="6:"] {\n\t\t\twidth: 100.00%;\n\t\t}\n\t}\n\n\t@media all and (min-width: 320px) and (max-width: 479px) {\n\t\t[data-cell*=":1:"] {\n\t\t\twidth: 16.66%;\n\t\t}\n\n\t\t[data-cell*=":2:"] {\n\t\t\twidth: 33.33%;\n\t\t}\n\n\t\t[data-cell*=":3:"] {\n\t\t\twidth: 50.00%;\n\t\t}\n\n\t\t[data-cell*=":4:"] {\n\t\t\twidth: 66.66%;\n\t\t}\n\n\t\t[data-cell*=":5:"] {\n\t\t\twidth: 83.33%;\n\t\t}\n\n\t\t[data-cell*=":6:"] {\n\t\t\twidth: 100.00%;\n\t\t}\n\t}\n\n\t@media all and (min-width: 480px) {\n\t\t[data-cell$=":1"] {\n\t\t\twidth: 16.66%;\n\t\t}\n\n\t\t[data-cell$=":2"] {\n\t\t\twidth: 33.33%;\n\t\t}\n\n\t\t[data-cell$=":3"] {\n\t\t\twidth: 50.00%;\n\t\t}\n\n\t\t[data-cell$=":4"] {\n\t\t\twidth: 66.66%;\n\t\t}\n\n\t\t[data-cell$=":5"] {\n\t\t\twidth: 83.33%;\n\t\t}\n\n\t\t[data-cell$=":6"] {\n\t\t\twidth: 100.00%;\n\t\t}\n\t}\n\n\t[data-flex] {\n\t\t--gap: max(0px, calc(var(--gap, 0px) - 4px));\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tflex-wrap: wrap;\n\t}\n\n\t[data-flex="x"] {\n\t\tflex-direction: row;\n\t\twidth: 100%;\n\t}\n\n\t[data-flex="x"] > :not(:first-child) {\n\t\tmargin-left: var(--gap, 0px);\n\t}\n\n\t[data-flex="y"] {\n\t\tflex-direction: column;\n\t\theight: 100%;\n\t}\n\n\t[data-flex="y"] > :not(:first-child) {\n\t\tmargin-top: var(--gap, 0px);\n\t}\n\n\t[data-wrap="false"] {\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\tbody {\n\t\tbackground-color: rgb(31, 31, 31);\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-family: "Nunito", sans-serif;\n\t\toverflow: hidden;\n\t\tuser-select: none;\n\t}\n\n\tbody ::selection {\n\t\tbackground-color: ${le};\n\t\tcolor: rgb(255, 255, 255);\n\t}\n\n\tbutton {\n\t\tbackground-color: ${le};\n\t\tborder-radius: 4px;\n\t\tcolor: rgb(255, 255, 255);\n\t\tcursor: pointer;\n\t\tfont-size: 16px;\n\t\tpadding: 8px 16px;\n\t\ttransition: transform 0.1s;\n\t}\n\n\tbutton[data-enabled="false"] {\n\t\tbackground-color: rgb(79, 79, 79);\n\t\tcursor: default;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\tbutton:not([data-enabled="false"]):hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\n\t\tbutton:active {\n\t\t\ttransform: none;\n\t\t}\n\t}\n\n\tinput {\n\t\tbackground-color: rgb(63, 63, 63);\n\t\tborder-radius: 4px;\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\tpadding: 8px;\n\t}\n\n\t.group {\n\t\tbackground-color: rgb(63, 63, 63);\n\t\tborder-radius: 2px;\n\t\tmargin: 8px;\n\t\tpadding: 4px;\n\t}\n\n\t.group > * {\n\t\tmargin: 4px;\n\t}\n\n\t.slider-widget {\n\t\tpadding: 4px;\n\t}\n\n\t.slider-widget__indicator {\n\t\tpadding: 4px;\n\t\tborder-radius: 4px;\n\t\tbackground-color: rgb(31, 31, 31);\n\t}\n\n\t.slider-widget__knob-wrapper {\n\t\tposition: relative;\n\t}\n\n\t.slider-widget__knob {\n\t\tbox-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.5);\n\t\twidth: 16px;\n\t\theight: 16px;\n\t\tborder-radius: 50%;\n\t\tbackground-color: rgb(255, 255, 255);\n\t\tposition: absolute;\n\t\ttop: 0%;\n\t\tleft: 0%;\n\t\tmargin-top: -8px;\n\t\tmargin-left: -8px;\n\t}\n\n\t.watched::before {\n\t\tcontent: "·";\n\t\tcolor: ${le};\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.media-widget {\n\t\tbackground-color: rgb(47, 47, 47);\n\t\tborder-radius: 2px;\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 0px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t\toverflow: hidden;\n\t}\n\n\t.media-widget__artwork {\n\t\tbackground-color: rgb(0, 0, 0);\n\t\tbackground-size: cover;\n\t\tpadding-bottom: 100%;\n\t\tposition: relative;\n\t}\n\n\t.media-widget__images {\n\t\tdisplay: grid;\n\t\tgrid-auto-flow: column;\n\t\theight: 100%;\n\t\tjustify-content: start;\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t}\n\n\t.media-widget__image {\n\t\theight: 100%;\n\t}\n\n\t.media-widget__metadata {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t\tpadding: 16px;\n\t}\n\n\t.media-widget__titles {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t}\n\n\t.media-widget__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-widget__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-widget__tags {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, min-content);\n\t\tgrid-auto-flow: column;\n\t}\n\n\t.media-widget__description {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\tline-height: 1.25;\n\t\tword-break: break-word;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\t.media-tag {\n\t\tbackground-color: rgb(63, 63, 63);\n\t\tborder-radius: 2px;\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\tpadding: 4px 8px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-tag--accent {\n\t\tbackground-color: ${le};\n\t\tcolor: rgb(255, 255, 255);\n\t}\n\n\n\n\n\t.image-box {\n\t\tborder-radius: 2px;\n\t\toverflow: hidden;\n\t\tpadding-bottom: 100%;\n\t\tposition: relative;\n\t}\n\n\t.image-box__image {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t}\n\n\n\n\n\n\n\n\t.content {\n\t\tbox-sizing: border-box;\n\t\tmargin: 0px auto;\n\t\tmax-width: 960px;\n\t\tpadding: 32px;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.text-header {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 20px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.text-paragraph {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 16px;\n\t\tline-height: 1.25;\n\t\tword-break: break-word;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.entity-header {\n\t\talign-items: start;\n\t\tdisplay: grid;\n\t\tgap: 32px;\n\t\tgrid-template-columns: repeat(auto-fit, minmax(240px, max-content));\n\t}\n\n\t.entity-header__artwork {\n\t\tbackground-color: rgb(0, 0, 0);\n\t\tposition: relative;\n\t}\n\n\t.entity-header__metadata {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-auto-rows: max-content;\n\t}\n\n\t.entity-header__titles {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t}\n\n\t.entity-header__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 24px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.entity-header__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 20px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.entity-header__tags {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, min-content);\n\t\tgrid-auto-flow: column;\n\t}\n\n\t.entity-header__description {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 16px;\n\t\tline-height: 1.25;\n\t\tword-break: break-word;\n\t}\n\n\n\n\n\n\n\n\t.playback-button {\n\t\tbackground-color: rgb(255, 255, 255);\n\t\tborder-radius: 50%;\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tcursor: pointer;\n\t\tfill: rgb(31, 31, 31);\n\t\tmargin: 16px;\n\t\tpadding: 8px;\n\t\tposition: absolute;\n\t\t\tbottom: 0%;\n\t\t\tright: 0%;\n\t\ttransition: transform 0.1s;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.playback-button:not([data-enabled="false"]):hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\n\t\t.playback-button:active {\n\t\t\ttransform: none;\n\t\t}\n\t}\n\n\n\n\n\n\n\t.media-grid {\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t}\n\n\t.media-grid__header {\n\n\t}\n\n\t.media-grid__content {\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t\tgrid-template-columns: repeat(auto-fill, minmax(240px, 1fr));\n\t}\n\n\n\n\n\n\n\n\n\n\n\t.playlist {\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t}\n\n\t.playlist__header {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t}\n\n\t.playlist__tags {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, min-content);\n\t\tgrid-auto-flow: column;\n\t}\n\n\t.playlist__content {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\t.playlist-item {\n\t\tborder-left: 4px solid transparent;\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-flow: row;\n\t\tgrid-auto-rows: max-content;\n\t\tmargin-left: -16px;\n\t\tpadding-left: 12px;\n\t}\n\n\t.playlist-item[data-playing="true"] {\n\t\tborder-color: ${le};\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.playlist-item:hover {\n\t\t\tborder-color: rgb(255, 255, 255);\n\t\t}\n\t}\n\n\t.playlist-item__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.playlist-item__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.playlist-item__tags {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, min-content);\n\t}\n\n\n\n\n\n\n\n\t.login-modal {\n\t\tbox-sizing: border-box;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-auto-rows: min-content;\n\t\theight: 100%;\n\t\tmargin: 0px auto;\n\t\tmax-width: 320px;\n\t\tpadding: 32px;\n\t\twidth: 100%;\n\t}\n\n\t.login-modal__form {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\n\n\n\n\n\n\n\t.modal-container {\n\t\tbackground-color: rgb(31, 31, 31);\n\t\theight: 100%;\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\tz-index: 1;\n\t}\n\n\t.modal-container__content {\n\t\tmargin: 0px auto;\n\t\theight: 100%;\n\t\tmax-width: 480px;\n\t\toverflow: hidden;\n\t\twidth: 100%;\n\t}\n\n\n\n\n\n\n\n\n\n\t.device-selector {\n\t\tpadding: 32px;\n\t}\n\n\t.device-selector__devices {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t}\n\n\t.device-selector__device {\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-template-columns: min-content 1fr;\n\t}\n\n\t.device-selector__device-info {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.device-selector__device-name {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.device-selector__device-type {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.media-player {\n\t\talign-items: center;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-template-columns: 1fr min-content;\n\t}\n\n\t.media-player__metadata {\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.media-player__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-player__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-player__controls {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, min-content);\n\t\tgrid-auto-flow: column;\n\t}\n\n\n\n\n\n\n\n\n\t.icon-button {\n\t\tbackground-color: rgb(255, 255, 255);\n\t\tborder-radius: 50%;\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tcursor: pointer;\n\t\tfill: rgb(31, 31, 31);\n\t\tpadding: 8px;\n\t\ttransition: transform 0.1s;\n\t}\n\n\t.icon-button[data-enabled="false"] {\n\t\tbackground-color: rgb(79, 79, 79);\n\t\tcursor: default;\n\t}\n\n\t.icon-button[data-active="true"] {\n\t\tbackground-color: ${le};\n\t\tfill: rgb(255, 255, 255);\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.icon-button:not([data-enabled="false"]):hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\n\t\t.icon-button:active {\n\t\t\ttransform: none;\n\t\t}\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\t.app {\n\t\tdisplay: grid;\n\t\theight: 100%;\n\t\tgrid-template-rows: min-content 1fr min-content;\n\t}\n\n\t.app__header {\n\t\tbackground-color: ${le};\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tz-index: 1;\n\t}\n\n\t.app__content {\n\t\theight: auto;\n\t\toverflow: hidden;\n\t\tposition: relative;\n\t\tz-index: 0;\n\t}\n\n\t.app__devices {\n\t\tbackground-color: ${le};\n\t}\n\n\t.app__devices-container {\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-template-columns: min-content 1fr;\n\t}\n\n\t.app__devices-icon {\n\t\tfill: rgb(255, 255, 255);\n\t}\n\n\t.app__devices-text {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t}\n\n\t.app__navigation {\n\t\tbackground-color: rgb(47, 47, 47);\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tposition: relative;\n\t\tz-index: 1;\n\t}\n\n\n\n\n\n\n\t.scroll-container {\n\t\theight: 100%;\n\t\toverflow: auto;\n\t\twidth: 100%;\n\t}\n\n\n\n\n\n\n\n\n\t.access-token {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.access-token__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-family: "Space Mono", monospace;\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.access-token__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\t.login-modal {\n\t\tbox-sizing: border-box;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-auto-rows: min-content;\n\t\theight: 100%;\n\t\tmargin: 0px auto;\n\t\tmax-width: 320px;\n\t\tpadding: 32px;\n\t\twidth: 100%;\n\t}\n\n\t.login-modal__form {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n`,document.head.appendChild(oe);let ce=e=>{let t=function(e){let t=Math.floor(e/1e3);e-=1e3*t;let n=Math.floor(t/60);t-=60*n;let a=Math.floor(n/60);n-=60*a;let i=Math.floor(a/24);return a-=24*i,{ms:e,s:t,m:n,h:a,d:i}}(e);return t.d>=10?t.d+"d":t.d>=1?`${t.d}d ${t.h}h`:t.h>=10?t.h+"h":t.h>=1?`${t.h}h ${t.m}m`:t.m>=10?t.m+"m":t.m>=1?`${t.m}m ${t.s}s`:t.s+"s"},pe=(e,t,n)=>{let a=new XMLHttpRequest;a.addEventListener("readystatechange",(()=>{a.readyState===XMLHttpRequest.DONE&&n(a.status,JSON.parse(a.responseText))})),a.open("POST",e,!0),a.send(JSON.stringify(t))};const ue=new i(!1);ee.devices.addObserver({onupdate:e=>{e.length<2&&ue.updateState(!1)}});const he=new i(!1);{let e=()=>{let e=ee.isDeviceLocal.getState(),t=ee.isCurrentEntryVideo.getState();he.updateState(e&&t)};ee.isDeviceLocal.addObserver(e),ee.isCurrentEntryVideo.addObserver(e)}const me=new i(!1),ge=new i(!1);{let e=()=>{ge.updateState(me.getState()||ue.getState())};me.addObserver(e),ue.addObserver(e)}let fe,ve,be=new i(null!==(K=localStorage.getItem("token"))&&void 0!==K?K:void 0);function ye(e,t){return Z(this,void 0,void 0,(function*(){return new Promise(((n,a)=>{pe("/api/auth/",{username:e,password:t},((e,t)=>{ve=e>=200&&e<300,ve?(fe=t.token,localStorage.setItem("token",fe)):(localStorage.removeItem("token"),fe=void 0),be.updateState(fe),n(fe)}))}))}))}be.addObserver((e=>{fe=e,ee.authenticate(fe)}));let xe=document.createElement("div"),we=document.createElement("div");he.addObserver((e=>{e?xe.style.setProperty("display","none"):xe.style.removeProperty("display")}));let _e=se.element("div.app").render();document.body.appendChild(_e);let Se=se.element("div.app__header").add(se.element("div.content").set("style","padding: 24px").add(se.element("div.page-header__title").add(se.text("Orbit")).on("click",(()=>{tt("/")})))).render();_e.appendChild(Se),we.setAttribute("class","app__content"),_e.appendChild(we);let ke=new i(""),Ee=new i("");we.appendChild(se.element("div.login-modal").bind("data-hide",me.addObserver((e=>!e))).add(se.element("div.login-modal__form").add(se.element("input.login-modal__username").bind2("value",ke).set("type","text").set("placeholder","Username...")).add(se.element("input.login-modal__password").bind2("value",Ee).set("type","password").set("placeholder","Password...").on("keyup",(e=>Z(void 0,void 0,void 0,(function*(){"Enter"===e.key&&null!=(yield ye(ke.getState(),Ee.getState()))&&me.updateState(!1)})))))).add(se.element("button").add(se.text("Login")).on("click",(()=>Z(void 0,void 0,void 0,(function*(){null!=(yield ye(ke.getState(),Ee.getState()))&&me.updateState(!1)}))))).render());let Ce=new r([]);{let e=()=>{let e=ee.devices.getState(),t=ee.device.getState(),n=ee.localDevice.getState();Ce.update(e.map((e=>Object.assign(Object.assign({},e),{active:(null==t?void 0:t.id)===e.id,local:(null==n?void 0:n.id)===e.id}))))};ee.devices.addObserver({onupdate:e}),ee.device.addObserver(e),ee.localDevice.addObserver(e)}let Oe=se.element("div.modal-container").bind("data-hide",ge.addObserver((e=>!e))).add(se.element("div.modal-container__content").add(se.element("div.device-selector").bind("data-hide",ue.addObserver((e=>!e))).add(se.element("div.device-selector__devices").repeat(Ce,(e=>se.element("div.device-selector__device").add(ze().set("data-active",""+e.active).add(Le())).add(se.element("div.device-selector__device-info").add(se.element("div.device-selector__device-name").add(se.text(e.name))).add(se.element("div.device-selector__device-type").add(se.text(e.local?"local":"remote")))).on("click",(()=>{ee.transfer({id:e.id,type:e.type,name:e.name}),ue.updateState(!1)})))))));we.appendChild(Oe.render());let Te,je=se.element("div.scroll-container").render(),Ae=se.element("div.scroll-container__sentinel").set("style","height: 1px").render();function Ie(e){l(Te)&&Re.unobserve(Ae),Te=e,l(Te)&&Re.observe(Ae)}je.appendChild(xe),je.appendChild(Ae),we.appendChild(je);let Re=new IntersectionObserver((e=>Z(void 0,void 0,void 0,(function*(){if(console.log(e),!s(Te))for(let t of e)if(t.target===Ae&&t.isIntersecting){yield Te(),Ie(Te);break}}))),{root:je}),Pe=se.element("div.app__navigation").render();const Le=()=>se.element("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(se.element("path").set("d","M1,16c-0.552,0-1-0.447-1-1v-1.829c0-0.325,0.158-0.629,0.423-0.816C0.594,12.233,0.795,12.171,1,12.171c0.112,0,0.226,0.019,0.334,0.058c1.144,0.405,2.032,1.294,2.438,2.438c0.109,0.306,0.062,0.646-0.125,0.911C3.458,15.843,3.153,16,2.829,16H1z")).add(se.element("path").set("d","M6.929,16c-0.498,0-0.919-0.365-0.99-0.857c-0.376-2.616-2.465-4.706-5.081-5.081C0.366,9.99,0,9.568,0,9.071l0-2.016C0,6.771,0.121,6.5,0.333,6.31C0.517,6.145,0.754,6.055,1,6.055c0.037,0,0.073,0.002,0.11,0.006c4.604,0.511,8.317,4.224,8.829,8.829c0.031,0.282-0.059,0.565-0.248,0.777C9.5,15.879,9.229,16,8.945,16H6.929z")).add(se.element("path").set("d","M12.962,16c-0.522,0-0.957-0.402-0.997-0.924C11.518,9.229,6.771,4.482,0.924,4.035C0.403,3.996,0,3.561,0,3.038l0-2.005c0-0.276,0.115-0.541,0.316-0.73C0.502,0.129,0.747,0.033,1,0.033c0.022,0,0.044,0,0.066,0.002c7.968,0.527,14.373,6.933,14.899,14.898c0.018,0.276-0.079,0.548-0.268,0.75C15.508,15.886,15.243,16,14.967,16H12.962z")),Ne=()=>se.element("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(se.element("path").set("d","M3,15.268c-0.173,0-0.345-0.045-0.5-0.134C2.19,14.955,2,14.625,2,14.268V1.732c0-0.357,0.19-0.688,0.5-0.866C2.655,0.776,2.827,0.732,3,0.732s0.345,0.044,0.5,0.134l10.855,6.269c0.31,0.179,0.5,0.509,0.5,0.866s-0.19,0.688-0.5,0.866L3.5,15.134C3.345,15.223,3.173,15.268,3,15.268z")),$e=()=>se.element("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(se.element("path").set("d","M3,16c-0.552,0-1-0.447-1-1V1c0-0.552,0.448-1,1-1h2c0.552,0,1,0.448,1,1v14c0,0.553-0.448,1-1,1H3z")).add(se.element("path").set("d","M11,16c-0.553,0-1-0.447-1-1V1c0-0.552,0.447-1,1-1h2c0.553,0,1,0.448,1,1v14c0,0.553-0.447,1-1,1H11z")),ze=()=>se.element("div.icon-button"),De=(e,t)=>se.element("a").on("click",(t=>{tt(e)})).set("href",e).add(se.text(t));let Ue=se.element("div.content").set("style","padding: 16px;").add(se.element("div.media-player").add(se.element("div.media-player__metadata").add(se.element("div.media-player__title").add(se.text(de))).add(se.element("div.media-player__subtitle").add(se.text(re))).on("click",(e=>{let t=ee.context.getState();if(l(t))if(h.is(t))tt(`audio/albums/${t.album_id}/`);else if(p.is(t))tt(`audio/artists/${t.artist_id}/`);else if(R.is(t))tt(`video/episodes/${t.episode_id}/`);else if(C.is(t))tt(`video/movies/${t.movie_id}/`);else if(x.is(t))tt(`audio/playlists/${t.playlist_id}/`);else if(A.is(t))tt(`video/seasons/${t.season_id}/`);else if(T.is(t))tt(`video/shows/${t.show_id}/`);else{if(!v.is(t))throw"Expected code to be unreachable!";tt(`audio/tracks/${t.track_id}/`)}}))).add(se.element("div.media-player__controls").add(ze().bind("data-hide",ee.devices.compute((e=>e.length<2))).add(Le()).on("click",(()=>{ue.updateState(!ue.getState())}))).add(ze().bind("data-enabled",ee.canPlayLast.addObserver((e=>e))).add(se.element("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(se.element("path").set("d","M15,15.268c-0.173,0-0.346-0.045-0.5-0.134L3.645,8.867c-0.31-0.179-0.5-0.509-0.5-0.866s0.19-0.688,0.5-0.866L14.5,0.866c0.154-0.089,0.327-0.134,0.5-0.134s0.346,0.044,0.5,0.134C15.81,1.044,16,1.375,16,1.732v12.536c0,0.357-0.19,0.688-0.5,0.866C15.346,15.223,15.173,15.268,15,15.268z")).add(se.element("path").set("d","M1,16c-0.552,0-1-0.447-1-1V1c0-0.552,0.448-1,1-1h2c0.552,0,1,0.448,1,1v14c0,0.553-0.448,1-1,1H1z"))).on("click",(()=>{ee.last()}))).add(ze().bind("data-enabled",ee.canPlayCurrent.addObserver((e=>e))).add(Ne().bind("data-hide",ee.playback.addObserver((e=>!0===e)))).add($e().bind("data-hide",ee.playback.addObserver((e=>!1===e)))).on("click",(()=>{ee.toggle()}))).add(ze().bind("data-enabled",ee.canPlayNext.addObserver((e=>e))).add(se.element("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(se.element("path").set("d","M1,15.268c-0.173,0-0.345-0.045-0.5-0.134C0.19,14.955,0,14.625,0,14.268V1.732c0-0.357,0.19-0.688,0.5-0.866C0.655,0.776,0.827,0.732,1,0.732s0.345,0.044,0.5,0.134l10.855,6.269c0.31,0.179,0.5,0.509,0.5,0.866s-0.19,0.688-0.5,0.866L1.5,15.134C1.345,15.223,1.173,15.268,1,15.268z")).add(se.element("path").set("d","M13,16c-0.553,0-1-0.447-1-1V1c0-0.552,0.447-1,1-1h2c0.553,0,1,0.448,1,1v14c0,0.553-0.447,1-1,1H13z"))).on("click",(()=>{ee.next()}))))).render();_e.appendChild(Pe),Pe.appendChild(Ue),ne.setAttribute("playsinline",""),ne.setAttribute("preload","auto"),ne.style.setProperty("height","100%"),ne.style.setProperty("width","100%"),te.setAttribute("preload","auto"),te.style.setProperty("display","none"),ae.setAttribute("preload","auto"),ae.style.setProperty("display","none");let Me=se.element("div").bind("data-hide",he.addObserver((e=>!e))).set("style","background-color: rgb(0, 0, 0); height: 100%;").render();je.appendChild(Me),Me.appendChild(ne),Me.appendChild(te),Me.appendChild(ae);const Ge=e=>se.element("div.media-tag").add(se.text(e));function Ve(e,t){let n=0;for(let t of e.discs)for(let e of t.tracks)n+=e.file.duration_ms;let a=e.title,i=e.artists.map((e=>e.title)).join(" · "),r=["Album",""+e.year,ce(n)],o=d((t=>!!l(t)&&t[t.length-3]===e.album_id),ee.contextPath),c=d(((e,t)=>e&&t),o,ee.playback);return se.element("div.media-widget").on("click",(t=>{tt(`audio/albums/${e.album_id}/`)})).add(se.element("div.media-widget__artwork").add(s(e.artwork)?void 0:se.element("div.media-widget__images").add(se.element("img.media-widget__image").set("src",`/files/${e.artwork.file_id}/?token=${fe}`))).add(se.element("div.playback-button").add(Ne().bind("data-hide",c.addObserver((e=>e)))).add($e().bind("data-hide",c.addObserver((e=>!e)))).on("click",(e=>{c.getState()?ee.pause():o.getState()?ee.resume():t()})))).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(a))).add(se.element("div.media-widget__subtitle").add(se.text(i)))).add(se.element("div.media-widget__tags").add(...r.map(Ge))))}function Be(e){return se.element("div.media-widget").add(se.element("div.media-widget__artwork")).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(e.title)))).add(se.element("div.media-widget__tags").add(Ge("Video Genre")))).on("click",(()=>{tt(`video/genres/${e.genre_id}/`)}))}function He(e,t){const n=e.seasons.reduce(((e,t)=>e+t.episodes.reduce(((e,t)=>e+t.file.duration_ms),0)),0);let a=["Show",ce(n)],i=d((t=>!!l(t)&&t[t.length-3]===e.show_id),ee.contextPath),r=d(((e,t)=>e&&t),i,ee.playback);return se.element("div.media-widget").on("click",(()=>{tt(`video/shows/${e.show_id}/`)})).add(se.element("div.media-widget__artwork").set("style","padding-bottom: 150%;").add(s(e.artwork)?void 0:se.element("div.media-widget__images").add(se.element("img.media-widget__image").set("src",`/files/${e.artwork.file_id}/?token=${fe}`))).add(se.element("div.playback-button").add(Ne().bind("data-hide",r.addObserver((e=>e)))).add($e().bind("data-hide",r.addObserver((e=>!e)))).on("click",(e=>{r.getState()?ee.pause():i.getState()?ee.resume():t()})))).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(e.title)))).add(se.element("div.media-widget__tags").add(...a.map(Ge))))}function Fe(e,t=(()=>ee.playMovie(e))){let n=e.title,a=["Movie",""+e.year,ce(e.file.duration_ms)],i=d((t=>!!l(t)&&t[t.length-1]===e.movie_id),ee.contextPath),r=d(((e,t)=>e&&t),i,ee.playback);return se.element("div.media-widget").on("click",(()=>{tt(`video/movies/${e.movie_id}/`)})).add(se.element("div.media-widget__artwork").set("style","padding-bottom: 150%;").add(s(e.artwork)?void 0:se.element("div.media-widget__images").add(se.element("img.media-widget__image").set("src",`/files/${e.artwork.file_id}/?token=${fe}`))).add(se.element("div.playback-button").add(Ne().bind("data-hide",r.addObserver((e=>e)))).add($e().bind("data-hide",r.addObserver((e=>!e)))).on("click",(e=>{r.getState()?ee.pause():i.getState()?ee.resume():t()})))).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(n))).add(se.element("div.media-widget__subtitle").add(se.text(e.genres.map((e=>e.title)).join(" · "))))).add(se.element("div.media-widget__tags").add(...a.map(Ge))))}function We(e,...t){return se.element("div.media-grid").add(e?se.element("div.media-grid__header").add(Ye(se.text(e))):void 0).add(se.element("div.media-grid__content").add(...t))}function Xe(e){return se.element("div.image-box").add(s(e)?void 0:se.element("img.image-box__image").set("src",e))}function Ye(e){return se.element("div.text-header").add(e)}const Je=(e,t=[],n=[],a,i,d)=>se.element("div.entity-header").add(se.element("div.entity-header__artwork").add(a).add(i)).add(se.element("div.entity-header__metadata").add(se.element("div.entity-header__titles").add(se.element("div.entity-header__title").add(se.text(e))).add(0===t.length?void 0:se.element("div.entity-header__subtitle").add(...function(e){let t=[];for(let n of e)t.push(n),t.push(se.text(" · "));return t.pop(),t}(t)))).add(se.element("div.entity-header__tags").add(...n.map(Ge))).add(function(e,t){if(l(e))return(e=>se.element("div.entity-header__description").add(se.text(e)))(e)}(d)));function qe(e){var t,n;return{movie_id:e.movie_id,title:e.title,year:e.year,summary:null!==(t=e.summary)&&void 0!==t?t:"",artwork:s(e.poster_file_id)?void 0:{file_id:e.poster_file_id,mime:"image/jpg",height:720,width:1080},file:{file_id:e.movie_parts[0].file_id,mime:"video/mp4",duration_ms:e.movie_parts[0].duration},subtitles:e.movie_parts[0].subtitles.map((e=>{var t;return{file_id:e.file_id,mime:"text/vtt",language:null!==(t=e.language)&&void 0!==t?t:void 0}})),last_stream_date:null!==(n=e.movie_parts[0].streamed)&&void 0!==n?n:void 0,genres:[]}}function Qe(e){let t={show_id:e.show_id,title:e.title};return Object.assign(Object.assign({},t),{seasons:e.seasons.map((e=>{let n={season_id:e.season_id,number:e.number,show:t};return Object.assign(Object.assign({},n),{episodes:e.episodes.map((e=>{var t,a,i;return{episode_id:e.episode_id,title:e.title,summary:null!==(t=e.summary)&&void 0!==t?t:"",number:e.number,file:{file_id:e.file_id,mime:"video/mp4",duration_ms:e.duration},subtitles:e.subtitles.map((e=>{var t;return{file_id:e.file_id,mime:"text/vtt",language:null!==(t=e.language)&&void 0!==t?t:void 0}})),season:n,year:null!==(a=e.year)&&void 0!==a?a:void 0,last_stream_date:null!==(i=e.streamed)&&void 0!==i?i:void 0}}))})})),genres:[]})}function Ke(e){let t={album_id:e.album_id,title:e.title,year:e.year,artists:e.artists.map((e=>({artist_id:e.artist_id,title:e.title}))),artwork:s(e.cover_file_id)?void 0:{file_id:e.cover_file_id,mime:"image/jpg",height:1080,width:1080}};return Object.assign(Object.assign({},t),{discs:e.discs.map((e=>{let n={disc_id:e.disc_id,album:t,number:e.number};return Object.assign(Object.assign({},n),{tracks:e.tracks.map((e=>({track_id:e.track_id,title:e.title,disc:n,artists:e.artists.map((e=>({artist_id:e.artist_id,title:e.title}))),file:{file_id:e.file_id,mime:"audio/mp4",duration_ms:e.duration},number:e.number,last_stream_date:void 0})))})}))})}function Ze(e){let t={artist_id:e.artist_id,title:e.title};return Object.assign(Object.assign({},t),{albums:e.albums.map(Ke)})}let et=t=>{for(Ie();null!==xe.lastChild;)xe.removeChild(xe.lastChild);let n;if(null!==(n=/^audio[/]albums[/]([0-9a-f]{32})[/]/.exec(t)))pe(`/api/audio/albums/${n[1]}/`,{},((e,t)=>{let n=Ke(t),a=d((e=>!!l(e)&&e[e.length-3]===n.album_id),ee.contextPath),i=d(((e,t)=>e&&t),a,ee.playback),r=0;for(let e of t.discs)for(let t of e.tracks)r+=t.duration;let o=se.element("div.content").add(Je(t.title,t.artists.map((e=>De(`audio/artists/${e.artist_id}/`,e.title))),["Album",""+t.year,ce(r)],Xe(s(n.artwork)?void 0:`/files/${n.artwork.file_id}/?token=${fe}`),se.element("div.playback-button").add(Ne().bind("data-hide",i.addObserver((e=>e)))).add($e().bind("data-hide",i.addObserver((e=>!e)))).on("click",(e=>{i.getState()?ee.pause():a.getState()?ee.resume():ee.playAlbum(n)})))).render();xe.appendChild(o);for(let e=0;e<t.discs.length;e++){let t=n.discs[e];if(t.tracks.length>0){let a=se.element("div.content").add(se.element("div.playlist").add(se.element("div.playlist__header").add(Ye(se.text("Disc "+t.number)))).add(se.element("div.playlist__content").add(...t.tracks.map(((t,a)=>se.element("div.playlist-item").bind("data-playing",ee.contextPath.addObserver((e=>!s(e)&&e[e.length-3]===t.disc.album.album_id&&e[e.length-2]===t.disc.disc_id&&e[e.length-1]===t.track_id))).add(se.element("div.playlist-item__title").add(se.text(t.title))).add(se.element("div.playlist-item__subtitle").add(se.text(t.artists.map((e=>e.title)).join(" · ")))).on("click",(()=>{ee.playAlbum(n,e,a)})))))));xe.appendChild(a.render())}}}));else if(null!==(n=/^audio[/]albums[/]/.exec(t)))pe("/api/audio/albums/",{},((e,t)=>{let n=t.albums.map(Ke);xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Albums")))).add(se.element("div.content").add(We(void 0,...n.map((e=>Ve(e,(()=>ee.playAlbum(e)))))))).render())}));else if(null!==(n=/^audio[/]artists[/]([0-9a-f]{32})[/]/.exec(t)))pe(`/api/audio/artists/${n[1]}/`,{},((e,t)=>{let n=Ze(t),a=d((e=>!!l(e)&&e[e.length-4]===n.artist_id),ee.contextPath),i=d(((e,t)=>e&&t),a,ee.playback),r=0;for(let e of t.albums)for(let t of e.discs)for(let e of t.tracks)r+=e.duration;let s=se.element("div.content").add(Je(t.title,[],["Artist",ce(r)],Xe(),se.element("div.playback-button").add(Ne().bind("data-hide",i.addObserver((e=>e)))).add($e().bind("data-hide",i.addObserver((e=>!e)))).on("click",(()=>{i.getState()?ee.pause():a.getState()?ee.resume():ee.playArtist(n)})),void 0)).render();if(xe.appendChild(s),n.albums.length>0){let e=se.element("div.content").render();xe.appendChild(e);let t=se.element("div.media-grid").add(se.element("div.media-grid__header").add(Ye(se.text("Discography")))).render();e.appendChild(t);let a=se.element("div.media-grid__content").add(...n.albums.map(((e,t)=>Ve(e,(()=>ee.playArtist(n,t)))))).render();t.appendChild(a)}if(t.appearances.length>0){let e=se.element("div.content").render();xe.appendChild(e);let n=se.element("div.media-grid").add(se.element("div.media-grid__header").add(Ye(se.text("Appearances")))).render();e.appendChild(n);let a=se.element("div.media-grid__content").render();n.appendChild(a);for(let e of t.appearances){let t=Ke(e),n=Ve(t,(()=>ee.playAlbum(t))).render();a.appendChild(n)}}}));else if(null!==(n=/^audio[/]artists[/]/.exec(t)))pe("/api/audio/artists/",{},((e,t)=>{let n=t.artists.map(Ze);xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Artists")))).add(se.element("div.content").add(We(void 0,...n.map((e=>function(e,t=(()=>ee.playArtist(e))){let n=0;for(let t of e.albums)for(let e of t.discs)for(let t of e.tracks)n+=t.file.duration_ms;let a=d((t=>!!l(t)&&t[t.length-4]===e.artist_id),ee.contextPath),i=d(((e,t)=>e&&t),a,ee.playback);return se.element("div.media-widget").on("click",(()=>{tt(`audio/artists/${e.artist_id}/`)})).add(se.element("div.media-widget__artwork").add(se.element("div.playback-button").add(Ne().bind("data-hide",i.addObserver((e=>e)))).add($e().bind("data-hide",i.addObserver((e=>!e)))).on("click",(()=>{i.getState()?ee.pause():a.getState()?ee.resume():t()})))).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(e.title)))).add(se.element("div.media-widget__tags").add(Ge("Artist")).add(Ge(ce(n)))))}(e,(()=>ee.playArtist(e)))))))).render())}));else if(null!==(n=/^audio[/]playlists[/]([0-9a-f]{32})[/]/.exec(t)))pe(`/api/audio/playlists/${n[1]}/`,{},((e,t)=>{let n=0;for(let e of t.items)n+=e.track.file.duration_ms;xe.appendChild(se.element("div").add(se.element("div.content").add(Je(t.title,[De(`users/${t.user.user_id}/`,""+t.user.username)],["Playlist",ce(n)],Xe(),void 0,t.description))).add(se.element("div.content").add(se.element("div.playlist__content").add(...t.items.map(((e,n)=>se.element("div.playlist-item").bind("data-playing",ee.contextPath.addObserver((n=>!s(n)&&n[n.length-2]===t.playlist_id&&n[n.length-1]===e.track.track_id))).add(se.element("div.playlist-item__title").add(se.text(e.track.title))).add(se.element("div.playlist-item__subtitle").add(se.text(e.track.artists.map((e=>e.title)).join(" · ")))).on("click",(()=>{ee.playPlaylist(t,n)}))))))).render())}));else if(null!==(n=/^audio[/]playlists[/]/.exec(t)))pe("/api/audio/playlists/",{},((e,t)=>{let n=t.playlists;xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Playlists")))).add(se.element("div.content").add(We(void 0,...n.map((e=>function(e,t=(()=>ee.playPlaylist(e))){let n=0;for(let t of e.items)n+=t.track.file.duration_ms;let a=d((t=>!!l(t)&&t[t.length-2]===e.playlist_id),ee.contextPath),i=d(((e,t)=>e&&t),a,ee.playback);return se.element("div.media-widget").on("click",(()=>{tt(`audio/playlists/${e.playlist_id}/`)})).add(se.element("div.media-widget__artwork").add(se.element("div.playback-button").add(Ne().bind("data-hide",i.addObserver((e=>e)))).add($e().bind("data-hide",i.addObserver((e=>!e)))).on("click",(()=>{i.getState()?ee.pause():a.getState()?ee.resume():t()})))).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(e.title))).add(se.element("div.media-widget__subtitle").add(se.text(e.user.username)))).add(se.element("div.media-widget__tags").add(Ge("Playlist")).add(Ge(ce(n)))))}(e)))))).render())}));else if(null!==(n=/^audio[/]/.exec(t)))xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Audio")))).add(se.element("div.content").set("style","display: grid; gap: 32px;").add(Ye(De("audio/artists/","Artists"))).add(Ye(De("audio/albums/","Albums"))).add(Ye(De("audio/playlists/","Playlists")))).render());else if(null!==(n=/^video[/]shows[/]([0-9a-f]{32})[/]/.exec(t)))pe(`/api/video/shows/${n[1]}/?token=${fe}`,{},((t,n)=>{const a=Qe(n),i=a.seasons.reduce(((e,t)=>e+t.episodes.reduce(((e,t)=>e+t.file.duration_ms),0)),0),r=function(e){let t;return e.seasons.forEach(((n,a)=>{n.episodes.forEach(((n,i)=>{var d;if(l(n.last_stream_date)){if(l(t)&&n.last_stream_date<(null!==(d=e.seasons[t.seasonIndex].episodes[t.episodeIndex].last_stream_date)&&void 0!==d?d:0))return;t={seasonIndex:a,episodeIndex:i}}}))})),l(t)?(t.episodeIndex+=1,t.episodeIndex===e.seasons[t.seasonIndex].episodes.length&&(t.episodeIndex=0,t.seasonIndex+=1,t.seasonIndex===e.seasons.length&&(t.seasonIndex=0))):e.seasons.length>0&&e.seasons[0].episodes.length>0&&(t={seasonIndex:0,episodeIndex:0}),t}(a),o=s(r)?void 0:a.seasons[r.seasonIndex].episodes[r.episodeIndex];let c=d((e=>!!l(e)&&e[e.length-3]===a.show_id),ee.contextPath),p=d(((e,t)=>e&&t),c,ee.playback);xe.appendChild(se.element("div").add(se.element("div.content").add(Je(a.title,void 0,["Show",ce(i)],Xe(s(a.artwork)?void 0:`/files/${a.artwork.file_id}/?token=${fe}`).set("style","padding-bottom: 150%"),se.element("div.playback-button").add(Ne().bind("data-hide",p.addObserver((e=>e)))).add($e().bind("data-hide",p.addObserver((e=>!e)))).on("click",(e=>{p.getState()?ee.pause():c.getState()?ee.resume():ee.playShow(a)}))))).add(se.element("div.content").add(s(r)||s(o)?void 0:We("Suggested episode",function(t,n){let a=t.title,i=t.season.show.title,r=["Episode",""+t.year,ce(t.file.duration_ms),e(t.season.number,t.number)],s=d((e=>!!l(e)&&e[e.length-1]===t.episode_id),ee.contextPath),o=d(((e,t)=>e&&t),s,ee.playback);return se.element("div.media-widget").on("click",(()=>{tt(`video/episodes/${t.episode_id}/`)})).add(se.element("div.media-widget__artwork").set("style","padding-bottom: 56.25%;").add(se.element("div.media-widget__images").add(se.element("img.media-widget__image").set("src",`/media/stills/${t.file.file_id}/?token=${fe}`))).add(se.element("div.playback-button").add(Ne().bind("data-hide",o.addObserver((e=>e)))).add($e().bind("data-hide",o.addObserver((e=>!e)))).on("click",(e=>{o.getState()?ee.pause():s.getState()?ee.resume():n()})))).add(se.element("div.media-widget__metadata").add(se.element("div.media-widget__titles").add(se.element("div.media-widget__title").add(se.text(a))).add(""===i?void 0:se.element("div.media-widget__subtitle").add(se.text(i)))).add(se.element("div.media-widget__tags").add(...r.map(Ge))))}(o,(()=>{ee.playShow(a,r.seasonIndex,r.episodeIndex)}))))).add(...a.seasons.map(((e,t)=>se.element("div.content").add(se.element("div.playlist").add(se.element("div.playlist__header").add(Ye(se.text("Season "+e.number))).add(se.element("div.playlist__tags").add(...function(e){return e.episodes.reduce(((e,t)=>(l(t.year)&&(e.includes(t.year)||e.push(t.year)),e)),[]).sort()}(e).map((e=>Ge(e.toString())))))).add(se.element("div.playlist__content").add(...e.episodes.map(((e,n)=>se.element("div.playlist-item").bind("data-playing",ee.contextPath.addObserver((t=>!s(t)&&t[t.length-2]===e.season.season_id&&t[t.length-1]===e.episode_id))).add(se.element("div.playlist-item__title").add(se.text(e.title))).add(se.element("div.playlist-item__subtitle").add(se.text(e.season.show.title))).add(s(e.last_stream_date)?void 0:se.element("div.playlist-item__tags").add(("Watched",se.element("div.media-tag.media-tag--accent").add(se.text("Watched"))))).on("click",(()=>{ee.playShow(a,t,n)})))))))))).render())}));else if(null!==(n=/^video[/]shows[/]/.exec(t)))pe("/api/video/shows/?token="+fe,{},((e,t)=>{let n=t.shows.map(Qe);xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Shows")))).add(se.element("div.content").add(We(void 0,...n.map(((e,t)=>He(e,(()=>{ee.playShow(e)}))))))).render())}));else if(null!==(n=/^video[/]episodes[/]([0-9a-f]{32})[/](?:([0-9]+)[/])?/.exec(t))){let t=n[1],a=l(n[2])?Number.parseInt(n[2])/1e3:void 0;pe(`/api/video/episodes/${t}/?token=${fe}`,{},((t,n)=>{let i=n.episode,r=i.season,s=r.show,o=d((e=>!!l(e)&&e[e.length-1]===i.episode_id),ee.contextPath),c=d(((e,t)=>e&&t),o,ee.playback);xe.appendChild(se.element("div").add(se.element("div.content").add(Je(i.title,[De(`video/shows/${s.show_id}/`,s.title)],["Episode",""+i.year,ce(i.file.duration_ms),e(r.number,i.number)],Xe(`/media/stills/${i.file.file_id}/?token=${fe}`).set("style","padding-bottom: 56.25%;"),se.element("div.playback-button").add(Ne().bind("data-hide",c.addObserver((e=>e)))).add($e().bind("data-hide",c.addObserver((e=>!e)))).on("click",(()=>{c.getState()?ee.pause():l(a)?(o.getState()||ee.playEpisode(i),ee.seek(a)):o.getState()?ee.resume():ee.playEpisode(i)})),i.summary))).render())}))}else if(null!==(n=/^video[/]movies[/]([0-9a-f]{32})[/](?:([0-9]+)[/])?/.exec(t))){let e=n[1],t=l(n[2])?Number.parseInt(n[2])/1e3:void 0;pe(`/api/video/movies/${e}/?token=${fe}`,{},((e,n)=>{let a=n.movie,i=n.suggestions,r=d((e=>!!l(e)&&e[e.length-1]===a.movie_id),ee.contextPath),o=d(((e,t)=>e&&t),r,ee.playback);xe.appendChild(se.element("div").add(se.element("div.content").add(Je(a.title,a.genres.map((e=>De(`video/genres/${e.genre_id}/`,e.title))),["Movie",""+a.year,ce(a.file.duration_ms)],Xe(s(a.artwork)?void 0:`/files/${a.artwork.file_id}/?token=${fe}`).set("style","padding-bottom: 150%"),se.element("div.playback-button").add(Ne().bind("data-hide",o.addObserver((e=>e)))).add($e().bind("data-hide",o.addObserver((e=>!e)))).on("click",(()=>{o.getState()?ee.pause():l(t)?(r.getState()||ee.playMovie(a),ee.seek(t)):r.getState()?ee.resume():ee.playMovie(a)})),a.summary))).add(se.element("div.content").add(We("Actors"))).add(0===i.length?void 0:se.element("div.content").add(We("Suggested movies",...i.map((e=>Fe(e)))))).render())}))}else if(null!==(n=/^video[/]movies[/]/.exec(t))){let e=0,t=new i(!1),n=new i(!1),a=new r([]);Ie((()=>new Promise(((i,d)=>{t.getState()||n.getState()||(n.updateState(!0),pe(`/api/video/movies/?offset=${e}&token=${fe}`,{},((d,r)=>{for(let e of r.movies)a.append(e);e+=r.movies.length,0===r.movies.length&&t.updateState(!0),n.updateState(!1),i()})))})))),xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Movies")))).add(se.element("div.content").add(se.element("div.media-grid__content").repeat(a,(e=>Fe(e,(()=>ee.playMovie(e))))))).render())}else if(null!==(n=/^cues[/](.*)/.exec(t))){let t=decodeURIComponent(n[1]),a=document.createElement("div"),i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("placeholder","Search query..."),i.setAttribute("value",t),a.appendChild(i);let d=document.createElement("button");d.textContent="Search",a.appendChild(d);let r=document.createElement("div");a.appendChild(r);let s=()=>{let e=i.value;""!==e&&e!==t&&tt("cues/"+encodeURIComponent(e))};i.addEventListener("keyup",(e=>{13===e.keyCode&&s()})),d.addEventListener("click",(()=>{s()})),xe.appendChild(a),pe("/api/cues/",{query:t},((t,n)=>{for(;null!==r.lastChild;)r.removeChild(r.lastChild);for(let t of n.cues){let n=document.createElement("div");if(n.classList.add("group"),t.subtitle.movie_part){let e=document.createElement("h2");e.style.setProperty("font-size","24px"),e.innerText=t.subtitle.movie_part.movie.title,n.appendChild(e);let a=document.createElement("h3");a.style.setProperty("font-size","12px"),a.innerText=""+t.subtitle.movie_part.movie.year,n.appendChild(a)}else if(t.subtitle.episode){let a=t.subtitle.episode,i=document.createElement("h2");i.style.setProperty("font-size","24px"),i.innerText=a.title,n.appendChild(i);let d=document.createElement("h3");d.style.setProperty("font-size","16px"),d.innerText=[a.season.show.title,e(a.season.number,a.number)].join(" · "),n.appendChild(d)}let a=document.createElement("pre");a.style.setProperty("font-size","16px"),a.innerText=""+t.lines.join("\n"),n.appendChild(a);let i=document.createElement("p");i.style.setProperty("font-size","12px"),i.innerText=ce(t.start_ms),n.appendChild(i);let d=document.createElement("button");d.textContent="Go to video",d.addEventListener("click",(()=>{let e=t.subtitle.episode,n=t.subtitle.movie_part;null!=e?tt(`video/episodes/${e.episode_id}/${t.start_ms}/`):null!=n&&tt(`video/movies/${n.movie_id}/${t.start_ms}/`)})),n.appendChild(d);let s=document.createElement("button");s.textContent="Generate meme",s.addEventListener("click",(()=>{window.open("/media/gifs/"+t.cue_id+"/")})),n.appendChild(s),r.appendChild(n)}}))}else if(null!==(n=/^video[/]channels[/]([0-9]+)[/]/.exec(t))){let e=n[1];pe(`/api/video/channels/${e}/?token=${fe}`,{},((e,t)=>{let n=document.createElement("div");n.innerText="Channel",n.style.setProperty("font-size","24px"),xe.appendChild(n);let a=document.createElement("button");a.textContent="Play",a.addEventListener("click",(()=>{})),xe.appendChild(a);for(let e of t.segments){const t=e.movie;if(null!=t){for(let e of t.movie_parts){let n=document.createElement("div");n.style.setProperty("display","flex"),n.classList.add("group");let a=document.createElement("div");a.style.setProperty("width","25%");let i=document.createElement("img");i.setAttribute("src",`/files/${t.poster_file_id||""}/?token=${fe}`),i.style.setProperty("width","100%"),a.appendChild(i);let d=document.createElement("div");d.style.setProperty("width","100%"),n.appendChild(a),n.appendChild(d);let r=document.createElement("h3");r.style.setProperty("font-size","16px"),r.textContent=t.title;let s=document.createElement("h4");s.style.setProperty("font-size","12px"),s.textContent="";let l=document.createElement("p");l.style.setProperty("font-size","16px"),l.textContent=t.summary;let o=document.createElement("p");o.style.setProperty("font-size","16px"),o.textContent=[t.year.toString().padStart(4,"0"),ce(e.duration)].join(" · ");let c=document.createElement("button");c.textContent="Play",c.addEventListener("click",(()=>{})),d.appendChild(r),d.appendChild(s),d.appendChild(l),d.appendChild(o),d.appendChild(c),xe.appendChild(n)}continue}const n=e.episode;if(null==n);else{let e=document.createElement("div");e.classList.add("group");let t=document.createElement("h3");t.style.setProperty("font-size","16px"),t.textContent=n.season.show.title;let a=document.createElement("h4");t.style.setProperty("font-size","12px"),a.textContent="s"+n.season.number.toString().padStart(2,"0")+"e"+n.number.toString().padStart(2,"0")+": "+n.title;let i=document.createElement("p");i.style.setProperty("font-size","16px"),i.textContent=n.summary;let d=document.createElement("p");d.style.setProperty("font-size","16px"),d.textContent=[ce(n.duration)].join(" · ");let r=document.createElement("button");r.textContent="Play",r.addEventListener("click",(()=>{})),e.appendChild(t),e.appendChild(a),e.appendChild(i),e.appendChild(d),e.appendChild(r),xe.appendChild(e)}}}))}else if(null!==(n=/^video[/]channels[/]/.exec(t)))pe("/api/video/channels/",{},((e,t)=>{for(let e of t.channels){let t=document.createElement("div");t.classList.add("group");let n=document.createElement("h2");n.textContent="Channel "+e.channel_id,n.style.setProperty("font-size","24px"),t.appendChild(n);let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=e.title,t.appendChild(a);let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`video/channels/${e.channel_id}/`)})),t.appendChild(i),xe.appendChild(t)}}));else if(null!==(n=/^video[/]genres[/]([0-9a-f]{32})[/]/.exec(t)))pe(`/api/video/genres/${n[1]}/?token=${fe}`,{},((e,t)=>{let n=t.genre.shows.map(Qe),a=t.genre.movies.map(qe);xe.appendChild(se.element("div").add(se.element("div.content").add(Je(t.genre.title,void 0,["Video Genre"],Xe()))).add(0===n.length?void 0:se.element("div.content").add(We("Shows",...n.map(((e,t)=>He(e,(()=>{ee.playShow(e)}))))))).add(0===a.length?void 0:se.element("div.content").add(We("Movies",...a.map(((e,t)=>Fe(e,(()=>{ee.playMovie(e)}))))))).render())}));else if(null!==(n=/^video[/]genres[/]/.exec(t)))pe("/api/video/genres/",{},((e,t)=>{let n=t.genres.map((e=>({genre_id:e.video_genre_id,title:e.title})));xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Video Genres")))).add(se.element("div.content").add(We(void 0,...n.map(Be)))).render())}));else if(null!==(n=/^video[/]/.exec(t)))xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Video")))).add(se.element("div.content").set("style","display: grid; gap: 32px;").add(Ye(De("video/shows/","Shows"))).add(Ye(De("video/movies/","Movies"))).add(Ye(De("video/genres/","Genres")))).render());else if(null!==(n=/^tokens[/]/.exec(t)))pe("/api/tokens/?token="+fe,{},((e,t)=>{xe.appendChild(se.element("div.content").add(se.element("div.playlist").add(se.element("div.playlist__header").add(Ye(se.text("Tokens")))).add(se.element("div.playlist__content").add(...t.tokens.map((e=>function(e){let t=e.expires_ms-Date.now();return se.element("div.access-token").add(se.element("div.access-token__title").add(se.text((e.selector.match(/.{1,2}/g)||[]).join(":")))).add(se.element("div.access-token__subtitle").add(se.text(`Expires in ${ce(t)}.`)))}(e)))))).render())}));else if(null!==(n=/^search[/](.*)/.exec(t))){let e=decodeURIComponent(n[1]);{let t=document.createElement("input");t.setAttribute("placeholder","Search for content..."),t.setAttribute("type","text"),t.setAttribute("value",e),t.addEventListener("keyup",(n=>{if("Enter"===n.key){let n=t.value;""!==n&&n!==e&&tt("search/"+encodeURIComponent(n))}})),xe.appendChild(t)}{let e=document.createElement("div");xe.appendChild(e),pe("/api/search/"+n[1],{},((t,n)=>{for(;null!==e.lastChild;)e.removeChild(e.lastChild);if(n.movies.length>0){{let t=document.createElement("h2");t.style.setProperty("font-size","24px"),t.textContent="Movies",e.appendChild(t)}for(let t of n.movies){let n=document.createElement("div");n.setAttribute("class","group");let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=t.title;let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`video/movies/${t.movie_id}/`)})),n.appendChild(a),n.appendChild(i),e.appendChild(n)}}if(n.episodes.length>0){{let t=document.createElement("h2");t.style.setProperty("font-size","24px"),t.textContent="Episodes",e.appendChild(t)}for(let t of n.episodes){let n=document.createElement("div");n.setAttribute("class","group");let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=t.title;let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`video/episodes/${t.episode_id}/`)})),n.appendChild(a),n.appendChild(i),e.appendChild(n)}}if(n.shows.length>0){{let t=document.createElement("h2");t.style.setProperty("font-size","24px"),t.textContent="Shows",e.appendChild(t)}for(let t of n.shows){let n=document.createElement("div");n.setAttribute("class","group");let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=t.title;let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`video/shows/${t.show_id}/`)})),n.appendChild(a),n.appendChild(i),e.appendChild(n)}}if(n.artists.length>0){{let t=document.createElement("h2");t.style.setProperty("font-size","24px"),t.textContent="Artists",e.appendChild(t)}for(let t of n.artists){let n=document.createElement("div");n.setAttribute("class","group");let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=t.title;let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`audio/artists/${t.artist_id}/`)})),n.appendChild(a),n.appendChild(i),e.appendChild(n)}}if(n.albums.length>0){{let t=document.createElement("h2");t.style.setProperty("font-size","24px"),t.textContent="Albums",e.appendChild(t)}for(let t of n.albums){let n=document.createElement("div");n.setAttribute("class","group");let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=t.title;let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`audio/albums/${t.album_id}/`)})),n.appendChild(a),n.appendChild(i),e.appendChild(n)}}if(n.tracks.length>0){{let t=document.createElement("h2");t.style.setProperty("font-size","24px"),t.textContent="Tracks",e.appendChild(t)}for(let t of n.tracks){let n=document.createElement("div");n.setAttribute("class","group");let a=document.createElement("p");a.style.setProperty("font-size","16px"),a.textContent=t.title;let i=document.createElement("button");i.textContent="View",i.addEventListener("click",(()=>{tt(`audio/albums/${t.disc.album.album_id}/`)})),n.appendChild(a),n.appendChild(i),e.appendChild(n)}}}))}}else xe.appendChild(se.element("div").add(se.element("div.content").add(Ye(se.text("Home")))).add(se.element("div.content").set("style","display: grid; gap: 32px;").add(Ye(De("audio/","Audio"))).add(Ye(De("video/","Video"))).add(Ye(De("search/","Search"))).add(Ye(De("cues/","Cues")))).render())},tt=e=>{(function(){return Z(this,void 0,void 0,(function*(){return null==ve?new Promise(((e,t)=>{pe("/api/auth/?token="+fe,{},((t,n)=>{ve=t>=200&&t<300,ve||(localStorage.removeItem("token"),fe=void 0),be.updateState(fe),e(fe)}))})):fe}))})().then((t=>{null==t?me.updateState(!0):(null===window.history.state?window.history.replaceState({uri:e},"",e):e!==window.history.state.uri&&window.history.pushState({uri:e},"",e),et(e))}))};tt(((e=window.location.pathname,t=(()=>{let e=document.head.querySelector("base[href]");if(null!==e){let t=e.getAttribute("href");if(null!==t)return t}return"/"})())=>{let n=e.split("/"),a=t.split("/"),i=0;for(;i<n.length&&i<a.length&&n[i]===a[i];)i++;return n.slice(i).join("/")})()),window.addEventListener("popstate",(e=>{tt(e.state.uri)}))})()})();