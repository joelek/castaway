(()=>{"use strict";var t={375:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Union=e.Undefined=e.Tuple=e.StringLiteral=e.String=e.Reference=e.Record=e.Object=e.NumberLiteral=e.Number=e.Null=e.Intersection=e.BooleanLiteral=e.Boolean=e.Array=e.Any=void 0,e.Any={as:(t,e="")=>t,is(t){try{this.as(t)}catch(t){return!1}return!0}},e.Array={of:t=>({as(e,n=""){if(null!=e&&e.constructor===globalThis.Array){for(let i=0;i<e.length;i++)t.as(e[i],n+"["+i+"]");return e}throw"Expected an array at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Boolean={as(t,e=""){if(null!=t&&t.constructor===globalThis.Boolean)return t;throw"Expected a boolean at "+e+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}},e.BooleanLiteral={of:t=>({as(e,n=""){if(e===t)return e;throw"Expected "+t+" at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Intersection={of:(...t)=>({as(e,n=""){for(let i of t)i.as(e,n);return e},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Null={as(t,e=""){if(null===t)return t;throw"Expected null at "+e+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}},e.Number={as(t,e=""){if(null!=t&&t.constructor===globalThis.Number)return t;throw"Expected a number at "+e+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}},e.NumberLiteral={of:t=>({as(e,n=""){if(e===t)return e;throw"Expected "+t+" at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Object={of:t=>({as(e,n=""){if(null!=e&&e.constructor===globalThis.Object){for(let i in t)t[i].as(e[i],n+/^([a-z][a-z0-9_]*)$/is.test(i)?"."+i:'["'+i+'"]');return e}throw"Expected an object at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Record={of:t=>({as(e,n=""){if(null!=e&&e.constructor===globalThis.Object){for(let i of globalThis.Object.keys(e))t.as(e[i],n+'["'+i+'"]');return e}throw"Expected a record at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Reference={of:t=>({as:(e,n="")=>t().as(e,n),is:e=>t().is(e)})},e.String={as(t,e=""){if(null!=t&&t.constructor===globalThis.String)return t;throw"Expected a string at "+e+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}},e.StringLiteral={of:t=>({as(e,n=""){if(e===t)return e;throw'Expected "'+t+'" at '+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Tuple={of:(...t)=>({as(e,n=""){if(null!=e&&e.constructor===globalThis.Array){for(let i=0;i<t.length;i++)t[i].as(e[i],n+"["+i+"]");return e}throw"Expected a tuple at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})},e.Undefined={as(t,e=""){if(void 0===t)return t;throw"Expected undefined at "+e+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}},e.Union={of:(...t)=>({as(e,n=""){for(let i of t)try{return i.as(e,n)}catch(t){}throw"Expected a union at "+n+"!"},is(t){try{this.as(t)}catch(t){return!1}return!0}})}},175:(t,e,n)=>{e.l8=void 0;const i=n(375);e.l8=i;n(226);n(129);n(329)},226:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Schema=e.UnionType=e.UndefinedType=e.TupleType=e.StringLiteralType=e.StringType=e.ReferenceType=e.RecordType=e.ObjectType=e.NumberLiteralType=e.NumberType=e.NullType=e.IntersectionType=e.GroupType=e.BooleanLiteralType=e.BooleanType=e.ArrayType=e.AnyType=e.Type=void 0;const i=n(329);e.Type={parse(t,...e){try{return S.parse(t,...e)}catch(t){}try{return d.parse(t,...e)}catch(t){}try{return s.parse(t,...e)}catch(t){}try{return r.parse(t)}catch(t){}try{return a.parse(t)}catch(t){}try{return o.parse(t)}catch(t){}try{return c.parse(t)}catch(t){}try{return p.parse(t)}catch(t){}try{return u.parse(t)}catch(t){}try{return g.parse(t)}catch(t){}try{return m.parse(t)}catch(t){}try{return v.parse(t)}catch(t){}try{return y.parse(t)}catch(t){}try{return b.parse(t)}catch(t){}try{return h.parse(t)}catch(t){}try{return l.parse(t)}catch(t){}try{return f.parse(t)}catch(t){}return t.newContext(((t,e)=>{let n=t();throw`Unexpected ${n.family} at row ${n.row}, col ${n.col}!`}))}};class r{constructor(){}generateType(t){return"any"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\treturn subject;"),e.push("}")):e.push("autoguard.Any"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>(i.expect(t(),"any"),r.INSTANCE)))}}e.AnyType=r,r.INSTANCE=new r;class s{constructor(t){this.type=t}generateType(t){return this.type.generateType(t)+"[]"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.Array)) {"),e.push("\t\tfor (let i = 0; i < subject.length; i++) {"),e.push("\t\t\t("+this.type.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t\t"}))+')(subject[i], path + "[" + i + "]");'),e.push("\t\t}"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected an array at " + path + "!";'),e.push("}")):e.push("autoguard.Array.of("+this.type.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol}))+")"),e.join(t.eol)}getImports(){return this.type.getImports()}static parse(t,...n){if(n.includes("Array"))throw"Recursion prevention!";return t.newContext(((r,a)=>{let o=e.Type.parse(t,...n,"Array");i.expect(r(),"["),i.expect(r(),"]");let l=new s(o);for(;;)try{t.newContext(((t,e)=>{i.expect(t(),"["),i.expect(t(),"]"),l=new s(l)}))}catch(t){break}return l}))}}e.ArrayType=s;class a{constructor(){}generateType(t){return"boolean"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.Boolean)) {"),e.push("\t\treturn subject as boolean;"),e.push("\t}"),e.push('\tthrow "Expected a boolean at " + path + "!";'),e.push("}")):e.push("autoguard.Boolean"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>(i.expect(t(),"boolean"),a.INSTANCE)))}}e.BooleanType=a,a.INSTANCE=new a;class o{constructor(t){this.value=t}generateType(t){return""+this.value}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif (subject === "+this.generateType(Object.assign(Object.assign({},t),{eol:t.eol+"\t"}))+") {"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected '+this.value+' at " + path + "!";'),e.push("}")):e.push("autoguard.BooleanLiteral.of("+this.generateType(Object.assign(Object.assign({},t),{eol:t.eol}))+")"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>"true"===i.expect(t(),["true","false"]).family?o.INSTANCE_TRUE:o.INSTANCE_FALSE))}}e.BooleanLiteralType=o,o.INSTANCE_TRUE=new o(!0),o.INSTANCE_FALSE=new o(!1);class l{constructor(t){this.type=t}generateType(t){return"("+this.type.generateType(t)+")"}generateTypeGuard(t){return this.type.generateTypeGuard(t)}getImports(){return this.type.getImports()}static parse(t){return t.newContext(((n,r)=>{i.expect(n(),"(");let s=e.Type.parse(t);return i.expect(n(),")"),new l(s)}))}}e.GroupType=l;class d{constructor(){this.types=new Set}add(t){return this.types.add(t),this}generateType(t){let e=new Array;for(let n of this.types)e.push(n.generateType(t));return e.join(" & ")}generateTypeGuard(t){let e=new Array;if(t.standalone){e.push("(subject, path) => {");for(let n of this.types)e.push("\t("+n.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t"}))+")(subject, path);");return e.push("\treturn subject;"),e.push("}"),e.join(t.eol)}for(let n of this.types)e.push("\t"+n.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t"})));return"autoguard.Intersection.of("+t.eol+e.join(","+t.eol)+t.eol+")"}getImports(){let t=new Array;for(let e of this.types)t.push(...e.getImports());return t}static parse(t,...n){if(n.includes("Intersection"))throw"Recursion prevention!";return t.newContext(((r,s)=>{var a;let o=e.Type.parse(t,...n,"Intersection"),l=new d;for(l.add(o);"&"===(null===(a=s())||void 0===a?void 0:a.value);){i.expect(r(),"&");let s=e.Type.parse(t,...n,"Intersection");l.add(s)}return 1===l.types.size?o:l}))}}e.IntersectionType=d;class c{constructor(){}generateType(t){return"null"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif (subject === null) {"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected null at " + path + "!";'),e.push("}")):e.push("autoguard.Null"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>(i.expect(t(),"null"),c.INSTANCE)))}}e.NullType=c,c.INSTANCE=new c;class p{constructor(){}generateType(t){return"number"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.Number)) {"),e.push("\t\treturn subject as number;"),e.push("\t}"),e.push('\tthrow "Expected a number at " + path + "!";'),e.push("}")):e.push("autoguard.Number"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>(i.expect(t(),"number"),p.INSTANCE)))}}e.NumberType=p,p.INSTANCE=new p;class u{constructor(t){this.value=t}generateType(t){return""+this.value}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif (subject === "+this.generateType(Object.assign(Object.assign({},t),{eol:t.eol+"\t"}))+") {"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected '+this.value+' at " + path + "!";'),e.push("}")):e.push("autoguard.NumberLiteral.of("+this.generateType(Object.assign(Object.assign({},t),{eol:t.eol}))+")"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>{let n=i.expect(t(),"NUMBER_LITERAL").value;return new u(Number.parseInt(n))}))}}e.NumberLiteralType=u;class h{constructor(){this.members=new Map}add(t,e){return this.members.set(t,e),this}generateType(t){if(0===this.members.size)return"{}";let e=new Array;for(let[n,i]of this.members)e.push('\t"'+n+'"'+(i.optional?"?":"")+": "+i.type.generateType(Object.assign(Object.assign({},t),{eol:t.eol+"\t"})));return"{"+(e.length>0?t.eol+e.join(","+t.eol)+t.eol:"")+"}"}generateTypeGuard(t){let e=new Array;if(t.standalone){e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.Object)) {");for(let[n,i]of this.members){let r=i.type;if(i.optional){let t=new S;t.add(v.INSTANCE),t.add(r),r=t}let s=/^([a-z][a-z0-9_]*)$/is.test(n)?'".'+n+'"':'"[\\"'+n+'\\"]"';e.push("\t\t("+r.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t"}))+')(subject["'+n+'"], path + '+s+");")}return e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected an object at " + path + "!";'),e.push("}"),e.join(t.eol)}for(let[n,i]of this.members){let r=i.type;if(i.optional){let t=new S;t.add(v.INSTANCE),t.add(r),r=t}e.push('\t"'+n+'": '+r.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t"})))}return"autoguard.Object.of<"+(null!=this.typename?this.typename:this.generateType(t))+">({"+(e.length>0?t.eol+e.join(","+t.eol)+t.eol:"")+"})"}getImports(){let t=new Array;for(let[e,n]of this.members){let e=n.type;t.push(...e.getImports())}return t}setTypename(t){this.typename=t}static parse(t){return t.newContext(((n,r)=>{var s,a,o;i.expect(n(),"{");let l=new h;if("}"!==(null===(s=r())||void 0===s?void 0:s.value))for(;;){let s=!1,d=i.expect(n(),["any","boolean","false","null","number","string","true","undefined","IDENTIFIER","STRING_LITERAL"]),c="STRING_LITERAL"===d.family?d.value.slice(1,-1):d.value;"?"===(null===(a=r())||void 0===a?void 0:a.value)&&(n(),s=!0),i.expect(n(),":");let p=e.Type.parse(t);if(l.add(c,{type:p,optional:s}),","!==(null===(o=r())||void 0===o?void 0:o.value))break;i.expect(n(),",")}return i.expect(n(),"}"),l}))}}e.ObjectType=h;class f{constructor(t){this.type=t}generateType(t){return"Record<string, undefined | "+this.type.generateType(t)+">"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.Object)) {"),e.push("\t\tfor (let key of globalThis.Object.keys(subject)) {"),e.push("\t\t\t("+this.type.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t\t"}))+')(subject[key], path + "[\\"" + key + "\\"]");'),e.push("\t\t}"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected a record at " + path + "!";'),e.push("}")):e.push("autoguard.Record.of("+this.type.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol}))+")"),e.join(t.eol)}getImports(){return this.type.getImports()}static parse(t){return t.newContext(((n,r)=>{i.expect(n(),"{");let s=e.Type.parse(t);return i.expect(n(),"}"),new f(s)}))}}e.RecordType=f;class y{constructor(t,e){this.path=t,this.typename=e}generateType(t){return this.typename}generateTypeGuard(t){return t.standalone?this.typename+".as":"autoguard.Reference.of<"+this.typename+">(() => "+this.typename+")"}getImports(){return this.path.length>0?[{path:this.path,typename:this.typename}]:[]}static parse(t){return t.newContext(((t,e)=>{var n,r;"@"===(null===(n=e())||void 0===n?void 0:n.family)&&i.expect(t(),"@");let s=new Array;for(;;){let n=t();if(i.expect(n,[".","..","IDENTIFIER"]),s.push(n),"/"!==(null===(r=e())||void 0===r?void 0:r.family))break;i.expect(t(),"/")}let a=s.pop();return i.expect(a,"IDENTIFIER"),new y(s.map((t=>t.value)),a.value)}))}}e.ReferenceType=y;class g{constructor(){}generateType(t){return"string"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.String)) {"),e.push("\t\treturn subject as string;"),e.push("\t}"),e.push('\tthrow "Expected a string at " + path + "!";'),e.push("}")):e.push("autoguard.String"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>(i.expect(t(),"string"),g.INSTANCE)))}}e.StringType=g,g.INSTANCE=new g;class m{constructor(t){this.value=t}generateType(t){return'"'+this.value+'"'}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif (subject === "+this.generateType(Object.assign(Object.assign({},t),{eol:t.eol+"\t"}))+") {"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected \\"'+this.value+'\\" at " + path + "!";'),e.push("}")):e.push('autoguard.StringLiteral.of("'+this.value+'")'),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>{let n=i.expect(t(),"STRING_LITERAL").value;return new m(n.slice(1,-1))}))}}e.StringLiteralType=m;class b{constructor(){this.types=new Array}add(t){return this.types.push(t),this}generateType(t){let e=new Array;for(let n of this.types)e.push("\t"+n.generateType(Object.assign(Object.assign({},t),{eol:t.eol+"\t"})));return"["+(e.length>0?t.eol+e.join(","+t.eol)+t.eol:"")+"]"}generateTypeGuard(t){let e=new Array;if(t.standalone){e.push("(subject, path) => {"),e.push("\tif ((subject != null) && (subject.constructor === globalThis.Array)) {");for(let n=0;n<this.types.length;n++){let i=this.types[n];e.push("\t\t("+i.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t"}))+")(subject["+n+'], path + "['+n+']");')}return e.push("\t\treturn subject as "+this.generateType(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t"}))+";"),e.push("\t}"),e.push('\tthrow "Expected a tuple at " + path + "!";'),e.push("}"),e.join(t.eol)}for(let n of this.types)e.push("\t"+n.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t"})));return"autoguard.Tuple.of("+(e.length>0?t.eol+e.join(","+t.eol)+t.eol:"")+")"}getImports(){let t=new Array;for(let e of this.types)t.push(...e.getImports());return t}static parse(t){return t.newContext(((n,r)=>{var s,a;i.expect(n(),"[");let o=new b;if("]"!==(null===(s=r())||void 0===s?void 0:s.value))for(;;){let s=e.Type.parse(t);if(o.add(s),","!==(null===(a=r())||void 0===a?void 0:a.value))break;i.expect(n(),",")}return i.expect(n(),"]"),o}))}}e.TupleType=b;class v{constructor(){}generateType(t){return"undefined"}generateTypeGuard(t){let e=new Array;return t.standalone?(e.push("(subject, path) => {"),e.push("\tif (subject === undefined) {"),e.push("\t\treturn subject;"),e.push("\t}"),e.push('\tthrow "Expected undefined at " + path + "!";'),e.push("}")):e.push("autoguard.Undefined"),e.join(t.eol)}getImports(){return[]}static parse(t){return t.newContext(((t,e)=>(i.expect(t(),"undefined"),v.INSTANCE)))}}e.UndefinedType=v,v.INSTANCE=new v;class S{constructor(){this.types=new Set}add(t){return this.types.add(t),this}generateType(t){let e=new Array;for(let n of this.types)e.push(n.generateType(t));return e.join(" | ")}generateTypeGuard(t){let e=new Array;if(t.standalone){e.push("(subject, path) => {");for(let n of this.types)e.push("\ttry {"),e.push("\t\treturn ("+n.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t"}))+")(subject, path);"),e.push("\t} catch (error) {}");return e.push('\tthrow "Expected a union at " + path + "!";'),e.push("}"),e.join(t.eol)}for(let n of this.types)e.push("\t"+n.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t"})));return"autoguard.Union.of("+t.eol+e.join(","+t.eol)+t.eol+")"}getImports(){let t=new Array;for(let e of this.types)t.push(...e.getImports());return t}static parse(t,...n){if(n.includes("Union"))throw"Recursion prevention!";return t.newContext(((r,s)=>{var a;let o=e.Type.parse(t,...n,"Union"),l=new S;for(l.add(o);"|"===(null===(a=s())||void 0===a?void 0:a.value);){i.expect(r(),"|");let s=e.Type.parse(t,...n,"Union");l.add(s)}return 1===l.types.size?o:l}))}}e.UnionType=S;class w{constructor(){this.types=new Map}getImports(){let t=new Map;for(let[e,n]of this.types){let e=n.getImports();for(let n of e)t.set(n.typename,n.path)}return Array.from(t.entries()).sort(((t,e)=>t[0].localeCompare(e[0]))).map((t=>({path:t[1],typename:t[0]})))}add(t,e){return this.types.set(t,e),this}generateModule(t){let e=new Array;e.push("// This file was auto-generated by @joelek/ts-autoguard. Edit at own risk."),e.push("");let n=this.getImports();for(let t of n)e.push("import { "+t.typename+' } from "'+t.path.join("/")+'";');t.standalone||e.push('import { guards as autoguard } from "@joelek/ts-autoguard";'),e.push("");for(let[n,i]of this.types)e.push("export type "+n+" = "+i.generateType(t)+";"),e.push(""),t.standalone?(e.push("export const "+n+" = {"),e.push('\tas(subject: any, path: string = ""): '+n+" {"),e.push("\t\treturn ("+i.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol+"\t\t"}))+")(subject, path);"),e.push("\t},"),e.push("\tis(subject: any): subject is "+n+" {"),e.push("\t\ttry {"),e.push("\t\t\tthis.as(subject);"),e.push("\t\t} catch (error) {"),e.push("\t\t\treturn false;"),e.push("\t\t}"),e.push("\t\treturn true;"),e.push("\t}"),e.push("};"),e.push("")):(e.push("export const "+n+" = "+i.generateTypeGuard(Object.assign(Object.assign({},t),{eol:t.eol}))+";"),e.push(""));let i=new h;for(let[t,e]of this.types)i.add(t,{type:new y([],t),optional:!1});return e.push("export type Autoguard = "+i.generateType(t)+";"),e.push(""),e.push("export const Autoguard = "+i.generateType(t)+";"),e.push(""),e.join(t.eol)}static parse(t){return t.newContext(((n,r)=>{var s,a,o;i.expect(n(),"{");let l=new w;if("}"!==(null===(s=r())||void 0===s?void 0:s.value))for(;;){let s=i.expect(n(),"IDENTIFIER").value;i.expect(n(),":");let d=e.Type.parse(t);if(null===(a=d.setTypename)||void 0===a||a.call(d,s),l.add(s,d),","!==(null===(o=r())||void 0===o?void 0:o.value))break;i.expect(n(),",")}if(i.expect(n(),"}"),null!=r())throw"Expected end of stream!";return l}))}}e.Schema=w},129:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageSerializer=void 0,e.MessageSerializer=class{constructor(t){this.guards=t}deserialize(t,e){let n=JSON.parse(t);if(null==n||n.constructor!==Object||null==n.type||n.type.constructor!==String)throw"Invalid message envelope!";{let t=n.type,i=n.data,r=this.guards[t];if(void 0===r)throw'Unknown message type "'+t+'"!';e(t,r.as(i))}}serialize(t,e){return JSON.stringify({type:t,data:e})}}},329:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.expect=e.Tokenizer=e.Families=void 0,e.Families=["WS","(",")","[","]","{","}","?","|",".","..","/","&","@",",",":","any","boolean","false","null","number","string","true","undefined","IDENTIFIER","NUMBER_LITERAL","STRING_LITERAL"],e.Tokenizer=class{constructor(t){let e={WS:/^([\t\r\n ]+)/ius,"(":/^([\(])/ius,")":/^([\)])/ius,"[":/^([\[])/ius,"]":/^([\]])/ius,"{":/^([\{])/ius,"}":/^([\}])/ius,"?":/^([\?])/ius,"|":/^([\|])/ius,".":/^([\.])/ius,"..":/^([\.][\.])/ius,"/":/^([\/])/ius,"&":/^([&])/ius,"@":/^([@])/ius,",":/^([,])/ius,":":/^([:])/ius,any:/^(any)/ius,boolean:/^(boolean)/ius,false:/^(false)/ius,null:/^(null)/ius,number:/^(number)/ius,string:/^(string)/ius,true:/^(true)/ius,undefined:/^(undefined)/ius,IDENTIFIER:/^([a-z][a-z0-9_]*)/ius,NUMBER_LITERAL:/^(([1-9][0-9]+)|([0-9]))/ius,STRING_LITERAL:/^(["][^"]*["])/ius},n=new Array,i=1,r=1;for(;t.length>0;){let s;for(let n in e){let i=n,r=e[i].exec(t);null!=r&&(null==s||r[1].length>s[1].length)&&(s=[i,r[1]])}if(null==s)throw`Unrecognized token at row ${i}, col ${r}!`;n.push({family:s[0],value:s[1],row:i,col:r}),t=t.slice(s[1].length);let a=s[1].split(/\r?\n/);a.length>1&&(i+=a.length-1,r=1),r+=a[a.length-1].length}this.tokens=n.filter((t=>"WS"!==t.family)),this.offset=0}peek(){return this.tokens[this.offset]}read(){if(this.offset>=this.tokens.length)throw"Unexpectedly reached end of stream!";return this.tokens[this.offset++]}newContext(t){let e=this.offset;try{return t((()=>this.read()),(()=>this.peek()))}catch(t){throw this.offset=e,t}}},e.expect=function(t,e){if(!(Array.isArray(e)?e:[e]).includes(t.family))throw`Unexpected ${t.family} at row ${t.row}, col ${t.col}!`;return t}},611:(t,e)=>{var n,i;e.GL=e.kQ=void 0,(i=e.kQ||(e.kQ={}))[i.CONNECTING=0]="CONNECTING",i[i.OPEN=1]="OPEN",i[i.CLOSING=2]="CLOSING",i[i.CLOSED=3]="CLOSED",(n=e.GL||(e.GL={}))[n.NORMAL=1e3]="NORMAL",n[n.GOING_AWAY=1001]="GOING_AWAY",n[n.PROTOCOL_ERROR=1002]="PROTOCOL_ERROR",n[n.DATA_TYPE_NOT_ACCEPTED=1003]="DATA_TYPE_NOT_ACCEPTED",n[n.RESERVED_1004=1004]="RESERVED_1004",n[n.RESERVED_1005=1005]="RESERVED_1005",n[n.RESERVED_1006=1006]="RESERVED_1006",n[n.BAD_DATA_TYPE=1007]="BAD_DATA_TYPE",n[n.POLICY_VIOLATION=1008]="POLICY_VIOLATION",n[n.MESSAGE_TOO_BIG=1009]="MESSAGE_TOO_BIG",n[n.CLIENT_EXPECTED_EXTENSION=1010]="CLIENT_EXPECTED_EXTENSION",n[n.SERVER_UNEXPECTED_CONDITION=1011]="SERVER_UNEXPECTED_CONDITION",n[n.RESERVED_1015=1015]="RESERVED_1015"},978:(t,e,n)=>{e.routing=n(220)},220:(t,e)=>{e.NamespacedMessageRouter=void 0;class n{constructor(){this.observers=new Map}addObserver(t,e){let n=this.observers.get(t);void 0===n&&(n=new Set,this.observers.set(t,n)),n.add(e)}removeObserver(t,e){let n=this.observers.get(t);void 0!==n&&n.delete(e)}route(t,e){let n=this.observers.get(t);if(void 0!==n)for(let t of n)t(e)}}e.NamespacedMessageRouter=class{constructor(){this.routers=new Map}addObserver(t,e,i){let r=this.routers.get(t);void 0===r&&(r=new n,this.routers.set(t,r)),r.addObserver(e,i)}removeObserver(t,e,n){let i=this.routers.get(t);void 0!==i&&i.removeObserver(e,n)}route(t,e,n){let i=this.routers.get(t);void 0!==i&&i.route(e,n)}}}},e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={exports:{}};return t[i](r,r.exports,n),r.exports}(()=>{const t={eng:{title:"English",iso639_1:"en",iso3166_1:"US"},swe:{title:"Swedish",iso639_1:"sv",iso3166_1:"SE"},jpn:{title:"Japanese",iso639_1:"ja",iso3166_1:"JP"}};function e(t){navigator.mediaSession&&(navigator.mediaSession.metadata=new globalThis.MediaMetadata(t))}class i{constructor(t){this.state=t,this.observers=new Array}addObserver(t){let e=new i(t(this.state));return this.observers.push((n=>{e.updateState(t(n))})),e.addObserver.bind(e)}getState(){return this.state}updateState(t){if(t!==this.state){this.state=t;for(let t of this.observers)t(this.state)}}}function r(t,...e){let n=new i(t(...e.map((t=>t.getState())))),r=()=>{n.updateState(t(...e.map((t=>t.getState()))))};for(let t of e)t.addObserver(r);return n}class s{constructor(t){this.state=t,this.observers=new Array}addObserver(t){var e;this.observers.push(t);for(let n of this.state)null===(e=t.onappend)||void 0===e||e.call(t,n)}compute(t){let e=new i(t(this.state));return this.observers.push({onappend:n=>{e.updateState(t(this.state))},onsplice:(n,i)=>{e.updateState(t(this.state))}}),e.addObserver.bind(e)}getState(){return this.state}append(t){var e;this.state.push(t);for(let n of this.observers)null===(e=n.onappend)||void 0===e||e.call(n,t)}splice(t){var e;if(t<0||t>=this.state.length)throw`Expected an index of at most ${this.state.length}, got ${t}!`;let n=this.state[t];this.state.splice(t,1);for(let i of this.observers)null===(e=i.onsplice)||void 0===e||e.call(i,n,t)}update(t){for(let t=this.state.length-1;t>=0;t--)this.splice(t);for(let e of t)this.append(e)}}function a(t){return null==t}function o(t){return null!=t}var l=n(175);l.l8.Object.of({directory_id:l.l8.String,name:l.l8.String,parent_directory_id:l.l8.Union.of(l.l8.Undefined,l.l8.String)}),l.l8.Object.of({file_id:l.l8.String,name:l.l8.String,parent_directory_id:l.l8.Union.of(l.l8.Undefined,l.l8.String),index_timestamp:l.l8.Union.of(l.l8.Undefined,l.l8.Number)});const d=l.l8.Object.of({file_id:l.l8.String,mime:l.l8.Union.of(l.l8.StringLiteral.of("audio/mp4"),l.l8.StringLiteral.of("audio/mp3")),duration_ms:l.l8.Number}),c=l.l8.Object.of({file_id:l.l8.String,mime:l.l8.StringLiteral.of("image/jpeg"),width:l.l8.Number,height:l.l8.Number}),p=(l.l8.Object.of({file_id:l.l8.String,mime:l.l8.StringLiteral.of("application/json")}),l.l8.Object.of({file_id:l.l8.String,mime:l.l8.StringLiteral.of("text/vtt"),duration_ms:l.l8.Number,language:l.l8.Union.of(l.l8.Undefined,l.l8.String)})),u=l.l8.Object.of({file_id:l.l8.String,mime:l.l8.StringLiteral.of("video/mp4"),duration_ms:l.l8.Number,width:l.l8.Number,height:l.l8.Number}),h=(l.l8.Object.of({video_file_id:l.l8.String,subtitle_file_id:l.l8.String}),l.l8.Object.of({artist_id:l.l8.String,name:l.l8.String}),l.l8.Object.of({album_id:l.l8.String,title:l.l8.String,year:l.l8.Union.of(l.l8.Undefined,l.l8.Number)}),l.l8.Object.of({album_id:l.l8.String,file_id:l.l8.String}),l.l8.Object.of({disc_id:l.l8.String,album_id:l.l8.String,number:l.l8.Number}),l.l8.Object.of({track_id:l.l8.String,disc_id:l.l8.String,title:l.l8.String,number:l.l8.Number}),l.l8.Object.of({track_id:l.l8.String,file_id:l.l8.String}),l.l8.Object.of({album_id:l.l8.String,artist_id:l.l8.String,order:l.l8.Number}),l.l8.Object.of({track_id:l.l8.String,artist_id:l.l8.String,order:l.l8.Number}),l.l8.Object.of({show_id:l.l8.String,name:l.l8.String,summary:l.l8.Union.of(l.l8.Undefined,l.l8.String)}),l.l8.Object.of({show_id:l.l8.String,file_id:l.l8.String}),l.l8.Object.of({season_id:l.l8.String,show_id:l.l8.String,number:l.l8.Number}),l.l8.Object.of({episode_id:l.l8.String,season_id:l.l8.String,title:l.l8.String,number:l.l8.Number,year:l.l8.Union.of(l.l8.Undefined,l.l8.Number),summary:l.l8.Union.of(l.l8.Undefined,l.l8.String)}),l.l8.Object.of({episode_id:l.l8.String,file_id:l.l8.String}),l.l8.Object.of({movie_id:l.l8.String,title:l.l8.String,year:l.l8.Union.of(l.l8.Undefined,l.l8.Number),summary:l.l8.Union.of(l.l8.Undefined,l.l8.String)}),l.l8.Object.of({movie_id:l.l8.String,file_id:l.l8.String}),l.l8.Object.of({person_id:l.l8.String,name:l.l8.String}),l.l8.Object.of({movie_id:l.l8.String,person_id:l.l8.String,order:l.l8.Number}),l.l8.Object.of({show_id:l.l8.String,person_id:l.l8.String,order:l.l8.Number}),l.l8.Object.of({genre_id:l.l8.String,name:l.l8.String}),l.l8.Object.of({movie_id:l.l8.String,genre_id:l.l8.String,order:l.l8.Number}),l.l8.Object.of({show_id:l.l8.String,genre_id:l.l8.String,order:l.l8.Number}),l.l8.Object.of({subtitle_id:l.l8.String,file_id:l.l8.String}),l.l8.Object.of({cue_id:l.l8.String,subtitle_id:l.l8.String,start_ms:l.l8.Number,duration_ms:l.l8.Number,lines:l.l8.Array.of(l.l8.String)}),l.l8.Object.of({user_id:l.l8.String,name:l.l8.String,username:l.l8.String,password:l.l8.String}),l.l8.Object.of({key_id:l.l8.String,user_id:l.l8.Union.of(l.l8.Undefined,l.l8.String)}),l.l8.Object.of({token_id:l.l8.String,user_id:l.l8.String,hash:l.l8.String,expires_ms:l.l8.Number}),l.l8.Object.of({stream_id:l.l8.String,user_id:l.l8.String,file_id:l.l8.String,timestamp_ms:l.l8.Number}),l.l8.Object.of({playlist_id:l.l8.String,title:l.l8.String,description:l.l8.String,user_id:l.l8.String}),l.l8.Object.of({playlist_item_id:l.l8.String,playlist_id:l.l8.String,track_id:l.l8.String,number:l.l8.Number,added_ms:l.l8.Number}),l.l8.Object.of({person_id:l.l8.String,name:l.l8.String})),f=l.l8.Intersection.of(l.l8.Reference.of((()=>h)),l.l8.Object.of({})),y=l.l8.Object.of({artist_id:l.l8.String,title:l.l8.String}),g=l.l8.Intersection.of(l.l8.Reference.of((()=>y)),l.l8.Object.of({albums:l.l8.Array.of(l.l8.Reference.of((()=>b)))})),m=l.l8.Object.of({album_id:l.l8.String,title:l.l8.String,artwork:l.l8.Array.of(l.l8.Reference.of((()=>c)))}),b=l.l8.Intersection.of(l.l8.Reference.of((()=>m)),l.l8.Object.of({artists:l.l8.Array.of(l.l8.Reference.of((()=>y))),discs:l.l8.Array.of(l.l8.Reference.of((()=>S))),year:l.l8.Union.of(l.l8.Undefined,l.l8.Number)})),v=l.l8.Object.of({disc_id:l.l8.String,album:l.l8.Reference.of((()=>m)),number:l.l8.Number}),S=l.l8.Intersection.of(l.l8.Reference.of((()=>v)),l.l8.Object.of({tracks:l.l8.Array.of(l.l8.Reference.of((()=>k)))})),w=l.l8.Object.of({track_id:l.l8.String,title:l.l8.String,disc:l.l8.Reference.of((()=>v)),number:l.l8.Number}),k=l.l8.Intersection.of(l.l8.Reference.of((()=>w)),l.l8.Object.of({artists:l.l8.Array.of(l.l8.Reference.of((()=>y))),last_stream_date:l.l8.Union.of(l.l8.Undefined,l.l8.Number),media:l.l8.Reference.of((()=>d))})),x=l.l8.Object.of({user_id:l.l8.String,name:l.l8.String,username:l.l8.String}),_=l.l8.Intersection.of(l.l8.Reference.of((()=>x)),l.l8.Object.of({})),O=l.l8.Object.of({playlist_id:l.l8.String,title:l.l8.String,description:l.l8.String,user:l.l8.Reference.of((()=>x))}),T=l.l8.Intersection.of(l.l8.Reference.of((()=>O)),l.l8.Object.of({items:l.l8.Array.of(l.l8.Reference.of((()=>j)))})),E=l.l8.Object.of({playlist_item_id:l.l8.String,number:l.l8.Number,playlist:l.l8.Reference.of((()=>O)),track:l.l8.Reference.of((()=>k))}),j=l.l8.Intersection.of(l.l8.Reference.of((()=>E)),l.l8.Object.of({})),C=l.l8.Object.of({genre_id:l.l8.String,title:l.l8.String}),I=l.l8.Intersection.of(l.l8.Reference.of((()=>C)),l.l8.Object.of({})),P=l.l8.Object.of({movie_id:l.l8.String,title:l.l8.String,artwork:l.l8.Array.of(l.l8.Reference.of((()=>c)))}),A=l.l8.Intersection.of(l.l8.Reference.of((()=>P)),l.l8.Object.of({year:l.l8.Union.of(l.l8.Undefined,l.l8.Number),summary:l.l8.Union.of(l.l8.Undefined,l.l8.String),genres:l.l8.Array.of(l.l8.Reference.of((()=>I))),actors:l.l8.Array.of(l.l8.Reference.of((()=>f))),last_stream_date:l.l8.Union.of(l.l8.Undefined,l.l8.Number),media:l.l8.Reference.of((()=>u)),subtitles:l.l8.Array.of(l.l8.Reference.of((()=>p)))})),R=l.l8.Object.of({show_id:l.l8.String,title:l.l8.String,artwork:l.l8.Array.of(l.l8.Reference.of((()=>c)))}),L=l.l8.Intersection.of(l.l8.Reference.of((()=>R)),l.l8.Object.of({summary:l.l8.Union.of(l.l8.Undefined,l.l8.String),genres:l.l8.Array.of(l.l8.Reference.of((()=>I))),actors:l.l8.Array.of(l.l8.Reference.of((()=>f))),seasons:l.l8.Array.of(l.l8.Reference.of((()=>N)))})),$=l.l8.Object.of({season_id:l.l8.String,number:l.l8.Number,show:l.l8.Reference.of((()=>R))}),N=l.l8.Intersection.of(l.l8.Reference.of((()=>$)),l.l8.Object.of({episodes:l.l8.Array.of(l.l8.Reference.of((()=>D)))})),U=l.l8.Object.of({episode_id:l.l8.String,title:l.l8.String,number:l.l8.Number,season:l.l8.Reference.of((()=>$))}),D=l.l8.Intersection.of(l.l8.Reference.of((()=>U)),l.l8.Object.of({year:l.l8.Union.of(l.l8.Undefined,l.l8.Number),summary:l.l8.Union.of(l.l8.Undefined,l.l8.String),last_stream_date:l.l8.Union.of(l.l8.Undefined,l.l8.Number),media:l.l8.Reference.of((()=>u)),subtitles:l.l8.Array.of(l.l8.Reference.of((()=>p)))})),F=l.l8.Object.of({subtitle_id:l.l8.String,subtitle:l.l8.Reference.of((()=>p))}),M=(l.l8.Intersection.of(l.l8.Reference.of((()=>F)),l.l8.Object.of({cues:l.l8.Array.of(l.l8.Reference.of((()=>B)))})),l.l8.Object.of({cue_id:l.l8.String,subtitle:l.l8.Reference.of((()=>F)),start_ms:l.l8.Number,duration_ms:l.l8.Number,lines:l.l8.Array.of(l.l8.String)})),B=l.l8.Intersection.of(l.l8.Reference.of((()=>M)),l.l8.Object.of({})),z=(l.l8.Union.of(l.l8.Reference.of((()=>m)),l.l8.Reference.of((()=>y)),l.l8.Reference.of((()=>v)),l.l8.Reference.of((()=>U)),l.l8.Reference.of((()=>C)),l.l8.Reference.of((()=>P)),l.l8.Reference.of((()=>h)),l.l8.Reference.of((()=>O)),l.l8.Reference.of((()=>$)),l.l8.Reference.of((()=>R)),l.l8.Reference.of((()=>w)),l.l8.Reference.of((()=>x))),l.l8.Union.of(l.l8.Reference.of((()=>b)),l.l8.Reference.of((()=>g)),l.l8.Reference.of((()=>S)),l.l8.Reference.of((()=>D)),l.l8.Reference.of((()=>I)),l.l8.Reference.of((()=>A)),l.l8.Reference.of((()=>f)),l.l8.Reference.of((()=>T)),l.l8.Reference.of((()=>N)),l.l8.Reference.of((()=>L)),l.l8.Reference.of((()=>k)),l.l8.Reference.of((()=>_))),l.l8.Reference.of((()=>b))),G=l.l8.Reference.of((()=>g)),q=l.l8.Reference.of((()=>S)),V=l.l8.Reference.of((()=>k)),H=l.l8.Reference.of((()=>T)),J=l.l8.Reference.of((()=>A)),W=l.l8.Reference.of((()=>L)),X=l.l8.Reference.of((()=>N)),Y=l.l8.Reference.of((()=>D)),Q=l.l8.Union.of(l.l8.Reference.of((()=>z)),l.l8.Reference.of((()=>G)),l.l8.Reference.of((()=>q)),l.l8.Reference.of((()=>V)),l.l8.Reference.of((()=>H)),l.l8.Reference.of((()=>J)),l.l8.Reference.of((()=>W)),l.l8.Reference.of((()=>X)),l.l8.Reference.of((()=>Y))),K=(l.l8.Union.of(l.l8.Reference.of((()=>V)),l.l8.Reference.of((()=>J)),l.l8.Reference.of((()=>Y))),l.l8.Object.of({id:l.l8.String,type:l.l8.String,name:l.l8.String})),Z=(l.l8.Object.of({context:l.l8.Union.of(l.l8.Undefined,l.l8.Reference.of((()=>Q))),device:l.l8.Union.of(l.l8.Undefined,l.l8.Reference.of((()=>K))),index:l.l8.Union.of(l.l8.Undefined,l.l8.Number),playback:l.l8.Boolean,progress:l.l8.Union.of(l.l8.Undefined,l.l8.Number)}),{SetContext:l.l8.Object.of({context:l.l8.Union.of(l.l8.Undefined,l.l8.Reference.of((()=>Q)))}),SetDevice:l.l8.Object.of({device:l.l8.Union.of(l.l8.Undefined,l.l8.Reference.of((()=>K)))}),SetDevices:l.l8.Object.of({devices:l.l8.Array.of(l.l8.Reference.of((()=>K)))}),SetIndex:l.l8.Object.of({index:l.l8.Union.of(l.l8.Undefined,l.l8.Number)}),SetLocalDevice:l.l8.Object.of({device:l.l8.Reference.of((()=>K))}),SetPlayback:l.l8.Object.of({playback:l.l8.Boolean}),SetProgress:l.l8.Object.of({progress:l.l8.Union.of(l.l8.Undefined,l.l8.Number)}),SetToken:l.l8.Object.of({token:l.l8.Union.of(l.l8.Undefined,l.l8.String)})});var tt=n(978),et=n(611);const nt=l.l8.Object.of({type:l.l8.String,data:l.l8.Any,id:l.l8.Union.of(l.l8.Undefined,l.l8.String)});class it{constructor(t){this.guards=t}deserialize(t,e){let n=nt.as(JSON.parse(t)),i=n.id,r=n.type,s=n.data,o=this.guards[r];if(a(o))throw`Unknown message type "${r}"!`;e(r,o.as(s),i)}serialize(t,e,n){return JSON.stringify({type:t,data:e,id:n})}}class rt{constructor(t,e,n){this.nextConnectionAttemptDelayFactor=2+Math.random(),this.nextConnectionAttemptDelay=2e3,this.router=new tt.routing.NamespacedMessageRouter,this.serializer=new it(n),this.url=t,this.factory=e,this.socket=this.makeSocket(),this.requests=new Map}makeId(){let t="";for(let e=0;e<32;e++)t+=Math.floor(16*Math.random()).toString(16);return t}makeSocket(){let t=this.factory(this.url);return t.addEventListener("close",this.onClose.bind(this)),t.addEventListener("error",this.onError.bind(this)),t.addEventListener("message",this.onMessage.bind(this)),t.addEventListener("open",this.onOpen.bind(this)),t}onClose(t){this.router.route("sys","disconnect",{})}onError(t){setTimeout((()=>{this.socket=this.makeSocket()}),this.nextConnectionAttemptDelay),this.nextConnectionAttemptDelay=Math.round(this.nextConnectionAttemptDelay*this.nextConnectionAttemptDelayFactor)}onMessage(t){try{this.serializer.deserialize(t.data,((t,e,n)=>{if(this.router.route("sys","message",{type:t,data:e}),o(n)){let i=this.requests.get(n);o(i)&&(this.requests.delete(n),i(t,e))}this.router.route("app",t,e)}))}catch(t){this.socket.close()}}onOpen(t){this.nextConnectionAttemptDelay=2e3,this.router.route("sys","connect",{})}queue(t){if(this.socket.readyState===et.kQ.OPEN)this.socket.send(t);else{let e=()=>{this.socket.removeEventListener("open",e),this.socket.send(t)};this.socket.addEventListener("open",e)}}addEventListener(t,e,n){this.router.addObserver(t,e,n)}close(){this.socket.close()}reconnect(){this.socket.readyState===et.kQ.CLOSED&&(this.socket=this.makeSocket())}removeEventListener(t,e,n){this.router.addObserver(t,e,n)}request(t,e,n){return new Promise(((i,r)=>{let s=this.makeId(),a=this.serializer.serialize(t,n,s);this.requests.set(s,((t,n)=>{t!==e?r(`Received response with type "${t}" when expecting "${e}"!`):i(n)})),this.queue(a)}))}send(t,e){let n=this.serializer.serialize(t,e);this.queue(n)}}class st{constructor(t){this.content=t}render(){let t=document.createTextNode("");return this.content instanceof i?this.content.addObserver((e=>{t.textContent=e})):t.textContent=this.content,t}}class at{constructor(t){let e=t.split(".");this.tag=e[0],this.attributes=new Map,this.children=new Array,this.bound=new Map,this.bound2=new Map,this.listeners=new Map;let n=e.slice(1).join(" ");""!==n&&this.attributes.set("class",n)}add(...t){for(let e of t)null!=e&&this.children.push(e);return this}bind(t,e){return this.bound.set(t,e),this}bind2(t,e){return this.bound2.set(t,e),this}on(t,e,n=!0){let i=this.listeners.get(t);return null==i&&(i=new Array,this.listeners.set(t,i)),i.push((t=>{n&&(t.preventDefault(),t.stopPropagation()),e(t)})),this}ref(){if(a(this.element))throw"Expected element to be rendered!";return this.element}render(){let t=["svg","path"].indexOf(this.tag)>=0?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",e=this.element=document.createElementNS(t,this.tag);e.setAttribute=(()=>{let t=e.setAttribute.bind(e);return(n,i)=>{if("src"===n){let r=new IntersectionObserver((s=>{for(let a of s)a.target===e&&a.isIntersecting&&(r.unobserve(e),t(n,i))}),{root:document.body});r.observe(e)}else t(n,i)}})();for(let[t,n]of this.listeners)for(let i of n)e.addEventListener(t,i);for(let[t,n]of this.attributes)e.setAttribute(t,n);for(let[t,n]of this.bound)n((n=>{e.setAttribute(t,""+n)}));for(let[t,n]of this.bound2)n.addObserver((n=>{e.setAttribute(t,""+n)})),"input"===this.tag&&"value"===t&&e.addEventListener("input",(()=>{n.updateState(e.value)}));for(let t of this.children)e.appendChild(t.render());return this.array&&this.array.addObserver({onappend:t=>{if(this.renderer){let n=this.renderer(t);e.appendChild(n.render())}},onsplice:(t,n)=>{let i=e.children[n];o(i)&&e.removeChild(i)}}),e}repeat(t,e){return this.array=t,this.renderer=e,this}set(t,e=""){return this.attributes.set(t,e),this}}function ot(t){return new at(t)}function lt(t){return new st(t)}function dt(t,e=" · "){let n=[];for(let i of t)n.push(i),n.push(lt(e));return n.pop(),n}const ct=l.l8.Object.of({errors:l.l8.Array.of(l.l8.String)});l.l8.Object.of({username:l.l8.String,password:l.l8.String,name:l.l8.String,key_id:l.l8.String}),l.l8.Object.of({token:l.l8.String});class pt{constructor(t){this.entityLinkFactory=t}make(t,e){return t.add(lt(e))}forEntity(t){if(b.is(t))return this.forAlbum(t);if(g.is(t))return this.forArtist(t);if(S.is(t))return this.forDisc(t);if(D.is(t))return this.forEpisode(t);if(I.is(t))return this.forGenre(t);if(A.is(t))return this.forMovie(t);if(f.is(t))return this.forPerson(t);if(T.is(t))return this.forPlaylist(t);if(N.is(t))return this.forSeason(t);if(L.is(t))return this.forShow(t);if(k.is(t))return this.forTrack(t);if(_.is(t))return this.forUser(t);throw"Expected code to be unreachable!"}forAlbum(t){return this.make(this.entityLinkFactory.forAlbum(t),t.title)}forArtist(t){return this.make(this.entityLinkFactory.forArtist(t),t.title)}forDisc(t){return this.make(this.entityLinkFactory.forDisc(t),"Disc "+t.number)}forEpisode(t){return this.make(this.entityLinkFactory.forEpisode(t),t.title)}forGenre(t){return this.make(this.entityLinkFactory.forGenre(t),t.title)}forMovie(t){return this.make(this.entityLinkFactory.forMovie(t),t.title)}forPerson(t){return this.make(this.entityLinkFactory.forPerson(t),t.name)}forPlaylist(t){return this.make(this.entityLinkFactory.forPlaylist(t),t.title)}forSeason(t){return this.make(this.entityLinkFactory.forSeason(t),"Season "+t.number)}forShow(t){return this.make(this.entityLinkFactory.forShow(t),t.title)}forTrack(t){return this.make(this.entityLinkFactory.forTrack(t),t.title)}forUser(t){return this.make(this.entityLinkFactory.forUser(t),t.name)}static makeStyle(){return ot("style").add(lt(""))}}class ut{constructor(){}make(){return ot("div.grid")}static makeStyle(){return ot("style").add(lt("\n\t.grid {\n\t\talign-items: start;\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t\tgrid-template-columns: repeat(auto-fill, minmax(240px, 1fr));\n\t}\n"))}}class ht{constructor(t){this.iconFactory=t}make(...t){let e=new i(0),n=r((t=>t>0),e),s=r((e=>e<t.length-1),e),a=ot("div.carousel__content");return ot("div.carousel").add(a.add(...t).on("scroll",(()=>{let n=a.ref(),i=0;for(let e of t)e.ref().offsetLeft-n.offsetLeft<n.scrollLeft&&(i+=1);e.updateState(i)}))).add(ot("div.carousel__controls").add(ot("div.icon-button").bind("data-enabled",n.addObserver((t=>""+t))).add(this.iconFactory.makeChevron().set("style","transform: scale(-1.0, 1.0);")).on("click",(()=>{if(n.getState()){let n=a.ref(),i=t[e.getState()-1].ref();n.scrollTo({left:i.offsetLeft-n.offsetLeft,behavior:"smooth"})}}))).add(ot("div.icon-button").bind("data-enabled",s.addObserver((t=>""+t))).add(this.iconFactory.makeChevron()).on("click",(()=>{if(s.getState()){let n=a.ref(),i=t[e.getState()+1].ref();n.scrollTo({left:i.offsetLeft-n.offsetLeft,behavior:"smooth"})}}))))}static makeStyle(){return ot("style").add(lt("\n\t.carousel {\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t}\n\n\t.carousel__content {\n\t\talign-items: start;\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t\tgrid-auto-flow: column;\n\t\tgrid-auto-columns: 100%;\n\t\toverflow: scroll hidden;\n\t\tscroll-behavior: smooth;\n\t\tscroll-snap-type: x mandatory;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.carousel__content {\n\t\t\toverflow: hidden;\n\t\t}\n\t}\n\n\t.carousel__content > * {\n\t\tscroll-snap-align: start;\n\t\ttransform: translate3d(0, 0, 0);\n\t}\n\n\t.carousel__controls {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-flow: column;\n\t\tjustify-content: center;\n\t}\n"))}}class ft{constructor(){}makeBackward(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M13,15.268c-0.173,0-0.346-0.045-0.5-0.134L1.645,8.867c-0.31-0.179-0.5-0.509-0.5-0.866s0.19-0.688,0.5-0.866L12.5,0.866c0.154-0.089,0.327-0.134,0.5-0.134s0.346,0.044,0.5,0.134C13.81,1.044,14,1.375,14,1.732v12.536c0,0.357-0.19,0.688-0.5,0.866C13.346,15.223,13.173,15.268,13,15.268z"))}makeChevron(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M8.414,24c-0.256,0-0.512-0.098-0.707-0.293l-1.414-1.414c-0.391-0.391-0.391-1.023,0-1.414L15.172,12L6.293,3.121c-0.391-0.391-0.391-1.023,0-1.414l1.414-1.414C7.902,0.098,8.158,0,8.414,0s0.512,0.098,0.707,0.293l11,11c0.391,0.391,0.391,1.023,0,1.414l-11,11C8.926,23.902,8.67,24,8.414,24z"))}makeCross(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M19.071,21.485c-0.256,0-0.512-0.098-0.707-0.293L12,14.828l-6.364,6.364c-0.188,0.188-0.442,0.293-0.707,0.293s-0.52-0.105-0.707-0.293l-1.414-1.414c-0.391-0.391-0.391-1.023,0-1.414L9.172,12L2.808,5.636c-0.391-0.391-0.391-1.023,0-1.414l1.414-1.414c0.195-0.195,0.451-0.293,0.707-0.293S5.44,2.612,5.636,2.808L12,9.172l6.364-6.364c0.195-0.195,0.451-0.293,0.707-0.293s0.512,0.098,0.707,0.293l1.414,1.414c0.391,0.391,0.391,1.023,0,1.414L14.828,12l6.364,6.364c0.391,0.391,0.391,1.023,0,1.414l-1.414,1.414C19.583,21.388,19.327,21.485,19.071,21.485z"))}makeBroadcast(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M1,16c-0.552,0-1-0.447-1-1v-1.829c0-0.325,0.158-0.629,0.423-0.816C0.594,12.233,0.795,12.171,1,12.171c0.112,0,0.226,0.019,0.334,0.058c1.144,0.405,2.032,1.294,2.438,2.438c0.109,0.306,0.062,0.646-0.125,0.911C3.458,15.843,3.153,16,2.829,16H1z")).add(ot("path").set("d","M6.929,16c-0.498,0-0.919-0.365-0.99-0.857c-0.376-2.616-2.465-4.706-5.081-5.081C0.366,9.99,0,9.568,0,9.071l0-2.016C0,6.771,0.121,6.5,0.333,6.31C0.517,6.145,0.754,6.055,1,6.055c0.037,0,0.073,0.002,0.11,0.006c4.604,0.511,8.317,4.224,8.829,8.829c0.031,0.282-0.059,0.565-0.248,0.777C9.5,15.879,9.229,16,8.945,16H6.929z")).add(ot("path").set("d","M12.962,16c-0.522,0-0.957-0.402-0.997-0.924C11.518,9.229,6.771,4.482,0.924,4.035C0.403,3.996,0,3.561,0,3.038l0-2.005c0-0.276,0.115-0.541,0.316-0.73C0.502,0.129,0.747,0.033,1,0.033c0.022,0,0.044,0,0.066,0.002c7.968,0.527,14.373,6.933,14.899,14.898c0.018,0.276-0.079,0.548-0.268,0.75C15.508,15.886,15.243,16,14.967,16H12.962z"))}makeForward(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M3,15.268c-0.173,0-0.345-0.045-0.5-0.134C2.19,14.955,2,14.625,2,14.268V1.732c0-0.357,0.19-0.688,0.5-0.866C2.655,0.776,2.827,0.732,3,0.732s0.345,0.044,0.5,0.134l10.855,6.269c0.31,0.179,0.5,0.509,0.5,0.866s-0.19,0.688-0.5,0.866L3.5,15.134C3.345,15.223,3.173,15.268,3,15.268z"))}makeFullscreen(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M10.343,8.071c-0.266,0-0.52-0.105-0.707-0.293L8.222,6.364c-0.391-0.391-0.391-1.023,0-1.414l2.121-2.121L9.222,1.707C8.936,1.421,8.85,0.991,9.005,0.617C9.16,0.244,9.524,0,9.929,0H15c0.553,0,1,0.448,1,1v5.071c0,0.404-0.243,0.769-0.617,0.924C15.259,7.046,15.129,7.071,15,7.071c-0.26,0-0.516-0.102-0.707-0.293l-1.121-1.121L11.05,7.778C10.862,7.966,10.608,8.071,10.343,8.071L10.343,8.071z")).add(ot("path").set("d","M1,16c-0.552,0-1-0.447-1-1V9.929C0,9.524,0.244,9.16,0.617,9.005C0.741,8.954,0.871,8.929,1,8.929c0.26,0,0.516,0.102,0.707,0.293l1.122,1.121L4.95,8.222c0.195-0.195,0.451-0.293,0.707-0.293s0.512,0.098,0.707,0.293l1.415,1.414c0.188,0.188,0.293,0.441,0.293,0.707c0,0.265-0.105,0.52-0.293,0.707l-2.122,2.122l1.121,1.121c0.286,0.286,0.372,0.716,0.217,1.09S6.475,16,6.071,16H1z"))}makeHome(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M3,16c-0.552,0-1-0.447-1-1V9H1.334C0.929,9,0.563,8.755,0.409,8.38C0.255,8.005,0.342,7.574,0.631,7.289l6.662-6.59C7.488,0.506,7.742,0.41,7.996,0.41c0.256,0,0.512,0.098,0.707,0.293L11,3V2c0-0.552,0.447-1,1-1h1c0.553,0,1,0.448,1,1v4l1.293,1.293c0.286,0.286,0.372,0.716,0.217,1.09C15.355,8.756,14.99,9,14.586,9H14v6c0,0.553-0.447,1-1,1H3z"))}makeLast(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M15,15.268c-0.173,0-0.346-0.045-0.5-0.134L3.645,8.867c-0.31-0.179-0.5-0.509-0.5-0.866s0.19-0.688,0.5-0.866L14.5,0.866c0.154-0.089,0.327-0.134,0.5-0.134s0.346,0.044,0.5,0.134C15.81,1.044,16,1.375,16,1.732v12.536c0,0.357-0.19,0.688-0.5,0.866C15.346,15.223,15.173,15.268,15,15.268z")).add(ot("path").set("d","M1,16c-0.552,0-1-0.447-1-1V1c0-0.552,0.448-1,1-1h2c0.552,0,1,0.448,1,1v14c0,0.553-0.448,1-1,1H1z"))}makeLock(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M5,24c-0.552,0-1-0.447-1-1V11c0-0.553,0.448-1,1-1h1V6c0-3.309,2.691-6,6-6s6,2.691,6,6v4h1c0.553,0,1,0.447,1,1v12c0,0.553-0.447,1-1,1H5z M12,4c-1.103,0-2,0.897-2,2v4h4V6C14,4.897,13.103,4,12,4z"))}makeMagnifyingGlass(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M21.586,24c-0.256,0-0.512-0.098-0.707-0.293l-5.367-5.367C13.871,19.426,11.965,20,10,20C4.486,20,0,15.514,0,10C0,4.486,4.486,0,10,0c5.514,0,10,4.486,10,10c0,1.965-0.574,3.871-1.66,5.512l5.367,5.367c0.391,0.391,0.391,1.023,0,1.414l-1.414,1.414C22.098,23.902,21.842,24,21.586,24z M10,4c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6S13.309,4,10,4z"))}makeNext(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M1,15.268c-0.173,0-0.345-0.045-0.5-0.134C0.19,14.955,0,14.625,0,14.268V1.732c0-0.357,0.19-0.688,0.5-0.866C0.655,0.776,0.827,0.732,1,0.732s0.345,0.044,0.5,0.134l10.855,6.269c0.31,0.179,0.5,0.509,0.5,0.866s-0.19,0.688-0.5,0.866L1.5,15.134C1.345,15.223,1.173,15.268,1,15.268z")).add(ot("path").set("d","M13,16c-0.553,0-1-0.447-1-1V1c0-0.552,0.447-1,1-1h2c0.553,0,1,0.448,1,1v14c0,0.553-0.447,1-1,1H13z"))}makePause(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M3,16c-0.552,0-1-0.447-1-1V1c0-0.552,0.448-1,1-1h2c0.552,0,1,0.448,1,1v14c0,0.553-0.448,1-1,1H3z")).add(ot("path").set("d","M11,16c-0.553,0-1-0.447-1-1V1c0-0.552,0.447-1,1-1h2c0.553,0,1,0.448,1,1v14c0,0.553-0.447,1-1,1H11z"))}makePerson(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M1.057,24c-0.286,0-0.559-0.123-0.749-0.337c-0.19-0.215-0.279-0.5-0.244-0.784c0.415-3.401,2.707-4.398,4.923-5.363c1.996-0.867,3.881-1.688,4-4.26C7.724,11.515,7,8.505,7,5c0-2.991,2.01-5,5-5s5,2.009,5,5c0,3.505-0.725,6.515-1.987,8.256c0.118,2.572,2.003,3.392,3.998,4.26c2.219,0.965,4.511,1.963,4.925,5.363c0.034,0.284-0.055,0.57-0.244,0.784C23.501,23.877,23.229,24,22.942,24H1.057z"))}makePlay(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 16 16").add(ot("path").set("d","M3,15.268c-0.173,0-0.345-0.045-0.5-0.134C2.19,14.955,2,14.625,2,14.268V1.732c0-0.357,0.19-0.688,0.5-0.866C2.655,0.776,2.827,0.732,3,0.732s0.345,0.044,0.5,0.134l10.855,6.269c0.31,0.179,0.5,0.509,0.5,0.866s-0.19,0.688-0.5,0.866L3.5,15.134C3.345,15.223,3.173,15.268,3,15.268z"))}makePlus(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M11,24c-0.553,0-1-0.447-1-1v-9H1c-0.552,0-1-0.447-1-1v-2c0-0.553,0.448-1,1-1h9V1c0-0.552,0.447-1,1-1h2c0.553,0,1,0.448,1,1v9h9c0.553,0,1,0.447,1,1v2c0,0.553-0.447,1-1,1h-9v9c0,0.553-0.447,1-1,1H11z"))}makeStar(){return ot("svg").set("width","12px").set("height","12px").set("viewBox","0 0 24 24").add(ot("path").set("d","M18.088,22.585c-0.159,0-0.319-0.038-0.466-0.115L12,19.514L6.377,22.47c-0.146,0.077-0.306,0.115-0.465,0.115c-0.207,0-0.414-0.064-0.588-0.191c-0.308-0.224-0.462-0.603-0.398-0.978L6,15.154L1.451,10.72c-0.272-0.266-0.371-0.663-0.253-1.024c0.118-0.362,0.431-0.626,0.807-0.681L8.292,8.1l2.812-5.696C11.271,2.063,11.619,1.847,12,1.847s0.729,0.216,0.896,0.558l2.812,5.696l6.287,0.914c0.377,0.055,0.689,0.318,0.808,0.681c0.117,0.361,0.02,0.759-0.253,1.024L18,15.154l1.073,6.262c0.064,0.375-0.09,0.754-0.397,0.978C18.501,22.521,18.295,22.585,18.088,22.585z"))}static makeStyle(){return ot("style").add(lt(""))}}const yt="rgb(255, 255, 255)",gt="rgb(159, 159, 159)";class mt{constructor(t){this.token=t}for(t,e="square"){let n=new i(!1);return ot("div.image-box.image-box--"+e).add(a(t)?void 0:ot("img.image-box__image").bind("data-opaque",n.addObserver((t=>t))).bind("src",this.token.addObserver((e=>{if(o(e)&&o(t))return`${t}?token=${e}`}))).on("load",(()=>{n.updateState(!0)})))}forCircle(t){return this.for(t,"circle")}forPoster(t){return this.for(t,"poster")}forSquare(t){return this.for(t,"square")}forVideo(t){return this.for(t,"video")}static makeStyle(){return ot("style").add(lt('\n\t.image-box {\n\t\tbackground-color: rgb(47, 47, 47);\n\t\tposition: relative;\n\t}\n\n\t.image-box--circle {\n\t\tborder-radius: 50%;\n\t\toverflow: hidden;\n\t\tpadding-bottom: 100%;\n\t}\n\n\t.image-box--poster {\n\t\tpadding-bottom: 150%;\n\t}\n\n\t.image-box--square {\n\t\tpadding-bottom: 100%;\n\t}\n\n\t.image-box--video {\n\t\tpadding-bottom: 56.25%;\n\t}\n\n\t.image-box__image {\n\t\theight: 100%;\n\t\tobject-fit: cover;\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t}\n\n\t[data-opaque] {\n\t\topacity: 0;\n\t\ttransition: opacity 1.000s;\n\t}\n\n\t[data-opaque="true"] {\n\t\topacity: 1;\n\t}\n'))}}class bt{constructor(t,e){this.navigator=t,this.contextMenuEntity=e}make(t,e){let n,i=()=>{this.contextMenuEntity.updateState(void 0),this.contextMenuEntity.updateState(e)};return ot("a").set("href",t).on("click",(()=>{this.navigator(t)})).on("contextmenu",i).on("touchstart",(()=>{n=window.setTimeout((()=>{window.clearTimeout(n),n=void 0,i()}),500)}),!1).on("touchcancel",(()=>{window.clearTimeout(n),n=void 0}),!1).on("touchmove",(()=>{window.clearTimeout(n),n=void 0}),!1).on("touchend",(()=>{window.clearTimeout(n),n=void 0}),!1)}forAlbum(t){return this.make(`audio/albums/${t.album_id}/`)}forAlbums(){return this.make("audio/albums/")}forArtist(t){return this.make(`audio/artists/${t.artist_id}/`)}forArtists(){return this.make("audio/artists/")}forDisc(t){return this.make(`audio/discs/${t.disc_id}/`)}forDiscs(){return this.make("audio/discs/")}forEpisode(t){return this.make(`video/episodes/${t.episode_id}/`)}forEpisodes(){return this.make("video/episodes/")}forGenre(t){return this.make(`video/genres/${t.genre_id}/`)}forGenres(){return this.make("video/genres/")}forMovie(t){return this.make(`video/movies/${t.movie_id}/`)}forMovies(){return this.make("video/movies/")}forPerson(t){return this.make(`persons/${t.person_id}/`)}forPersons(){return this.make("persons/")}forPlaylist(t){return this.make(`audio/playlists/${t.playlist_id}/`)}forPlaylists(){return this.make("audio/playlists/")}forSeason(t){return this.make(`video/seasons/${t.season_id}/`)}forSeasons(){return this.make("video/seasons/")}forShow(t){return this.make(`video/shows/${t.show_id}/`)}forShows(){return this.make("video/shows/")}forTrack(t){return this.make(`audio/tracks/${t.track_id}/`,t)}forTracks(){return this.make("audio/tracks/")}forUser(t){return this.make(`users/${t.user_id}/`)}forUsers(){return this.make("users/")}static makeStyle(){return ot("style").add(lt(""))}}function vt(t){let e=function(t){let e=Math.floor(t/1e3);t-=1e3*e;let n=Math.floor(e/60);e-=60*n;let i=Math.floor(n/60);n-=60*i;let r=Math.floor(i/24);return i-=24*r,{ms:t,s:e,m:n,h:i,d:r}}(t);return e.d>=10?e.d+"d":e.d>=1?`${e.d}d ${e.h}h`:e.h>=10?e.h+"h":e.h>=1?`${e.h}h ${e.m}m`:e.m>=10?e.m+"m":e.m>=1?`${e.m}m ${e.s}s`:e.s+"s"}const St=`\n\t.entity-card {\n\t\talign-items: start;\n\t\tdisplay: grid;\n\t\tgap: 24px;\n\t\tgrid-auto-rows: min-content;\n\t\tgrid-template-columns: repeat(auto-fit, minmax(240px, auto));\n\t}\n\n\t.entity-card__artwork {\n\t\tborder-radius: 2px;\n\t\toverflow: hidden;\n\t\tposition: relative;\n\t}\n\n\t.entity-card__playback {\n\t\tposition: absolute;\n\t\t\tbottom: 16px;\n\t\t\tright: 16px;\n\t}\n\n\t.entity-card__content {\n\n\t}\n\n\t.entity-card__pusher {\n\t\twidth: 100vw;\n\t}\n\n\t.entity-card__metadata {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t}\n\n\t.entity-card__titles {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.entity-card__title {\n\t\tcolor: ${yt};\n\t\tfont-size: 20px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.entity-card__subtitle {\n\t\tcolor: ${gt};\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.entity-card__tags {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, max-content);\n\t\tgrid-auto-flow: column;\n\t}\n\n\t.entity-card__tag {\n\t\tbackground-color: rgb(47, 47, 47);\n\t\tborder-radius: 2px;\n\t\tcolor: ${gt};\n\t\tfont-size: 12px;\n\t\tpadding: 4px 8px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.entity-card__tag--accent {\n\t\tbackground-color: rgb(223, 79, 127);\n\t\tcolor: rgb(255, 255, 255);\n\t}\n\n\t.entity-card__description {\n\t\tcolor: ${gt};\n\t\tfont-size: 16px;\n\t\tline-height: 1.25;\n\t\tword-break: break-word;\n\t}\n\n\t.entity-card__description--clamp {\n\t\tdisplay: -webkit-box;\n\t\tmax-height: 100px;\n\t\toverflow: hidden;\n\t\t-webkit-box-orient: vertical;\n\t\t-webkit-line-clamp: 5;\n\t}\n`;function wt(t,e){return 9*t>16*e?t>=1280:e>=720}class kt{constructor(t,e,n,i){this.entityTitleFactory=t,this.entityLinkFactory=e,this.ImageBox=n,this.PlaybackButton=i}make(t,e,n,i,r,s,o){return t.add(ot("div.entity-card").add(ot("div.entity-card__artwork").add(e).add(ot("div.entity-card__playback").add(n))).add(ot("div.entity-card__content").add(ot("div.entity-card__pusher")).add(ot("div.entity-card__metadata").add(ot("div.entity-card__titles").add(0===i.length?void 0:ot("div.entity-card__title").add(...dt(i))).add(0===r.length?void 0:ot("div.entity-card__subtitle").add(...dt(r)))).add(0===s.length?void 0:ot("div.entity-card__tags").add(...s)).add(a(o)?void 0:ot("div.entity-card__description.entity-card__description--clamp").add(lt(o))))))}forEntity(t){if(b.is(t))return this.forAlbum(t);if(g.is(t))return this.forArtist(t);if(S.is(t))return this.forDisc(t);if(D.is(t))return this.forEpisode(t);if(I.is(t))return this.forGenre(t);if(f.is(t))return this.forPerson(t);if(T.is(t))return this.forPlaylist(t);if(A.is(t))return this.forMovie(t);if(N.is(t))return this.forSeason(t);if(L.is(t))return this.forShow(t);if(k.is(t))return this.forTrack(t);if(_.is(t))return this.forUser(t);throw"Expected code to be unreachable!"}forAlbum(t,e=this.PlaybackButton.forAlbum(t)){let n=0;for(let e of t.discs)for(let t of e.tracks)n+=t.media.duration_ms;let i=this.entityLinkFactory.forAlbum(t),r=this.ImageBox.forSquare(t.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forAlbum(t)],a=t.artists.map((t=>this.entityTitleFactory.forArtist(t))),l=["Album",o(t.year)?""+t.year:void 0,vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(i,r,e,s,a,l)}forArtist(t,e=this.PlaybackButton.forArtist(t)){var n;let i=0;for(let e of t.albums)for(let t of e.discs)for(let e of t.tracks)i+=e.media.duration_ms;let r=this.entityLinkFactory.forArtist(t),s=this.ImageBox.forSquare(null===(n=t.albums[0])||void 0===n?void 0:n.artwork.map((t=>`/files/${t.file_id}/`)).shift()),a=[this.entityTitleFactory.forArtist(t)],l=new Array,d=["Artist",vt(i)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(r,s,e,a,l,d)}forDisc(t,e=this.PlaybackButton.forDisc(t)){let n=0;for(let e of t.tracks)n+=e.media.duration_ms;let i=this.entityLinkFactory.forDisc(t),r=this.ImageBox.forSquare(t.album.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forDisc(t)],a=[this.entityTitleFactory.forAlbum(t.album)],l=["Disc",vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(i,r,e,s,a,l)}forEpisode(t,e=this.PlaybackButton.forEpisode(t)){let n=0;n+=t.media.duration_ms;let i=this.entityLinkFactory.forEpisode(t),r=this.ImageBox.forVideo(`/media/stills/${t.media.file_id}/`),s=[this.entityTitleFactory.forEpisode(t)],a=[this.entityTitleFactory.forShow(t.season.show),this.entityTitleFactory.forSeason(t.season)],l=["Episode",o(t.year)?""+t.year:void 0,vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return wt(t.media.width,t.media.height)&&l.unshift(ot("div.entity-card__tag.entity-card__tag--accent").add(lt("HD"))),o(t.last_stream_date)&&l.unshift(ot("div.entity-card__tag.entity-card__tag--accent").add(lt("✓"))),this.make(i,r,e,s,a,l,t.summary)}forGenre(t){let e=this.entityLinkFactory.forGenre(t),n=this.ImageBox.forSquare(),i=[this.entityTitleFactory.forGenre(t)],r=["Genre"].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(e,n,void 0,i,[],r)}forMovie(t,e=this.PlaybackButton.forMovie(t)){let n=0;n+=t.media.duration_ms;let i=this.entityLinkFactory.forMovie(t),r=this.ImageBox.forPoster(t.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forMovie(t)],a=t.genres.map((t=>this.entityTitleFactory.forGenre(t))),l=["Movie",o(t.year)?""+t.year:void 0,vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return wt(t.media.width,t.media.height)&&l.unshift(ot("div.entity-card__tag.entity-card__tag--accent").add(lt("HD"))),o(t.last_stream_date)&&l.unshift(ot("div.entity-card__tag.entity-card__tag--accent").add(lt("✓"))),this.make(i,r,e,s,a,l,t.summary)}forPerson(t){let e=this.entityLinkFactory.forPerson(t),n=this.ImageBox.forSquare(),i=[this.entityTitleFactory.forPerson(t)],r=["Person"].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(e,n,void 0,i,[],r)}forPlaylist(t,e=this.PlaybackButton.forPlaylist(t)){var n;let i=0;for(let e of t.items)i+=e.track.media.duration_ms;let r=this.entityLinkFactory.forPlaylist(t),s=this.ImageBox.forSquare(null===(n=t.items[0])||void 0===n?void 0:n.track.disc.album.artwork.map((t=>`/files/${t.file_id}/`)).shift()),a=[this.entityTitleFactory.forPlaylist(t)],l=[this.entityTitleFactory.forUser(t.user)],d=["Playlist",vt(i)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(r,s,e,a,l,d,t.description)}forSeason(t,e=this.PlaybackButton.forSeason(t)){let n=0;for(let e of t.episodes)n+=e.media.duration_ms;let i=this.entityLinkFactory.forSeason(t),r=this.ImageBox.forPoster(t.show.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forSeason(t)],a=[this.entityTitleFactory.forShow(t.show)],l=["Season",vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(i,r,e,s,a,l)}forShow(t,e=this.PlaybackButton.forShow(t)){let n=0;for(let e of t.seasons)for(let t of e.episodes)n+=t.media.duration_ms;let i=this.entityLinkFactory.forShow(t),r=this.ImageBox.forPoster(t.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forShow(t)],a=t.genres.map((t=>this.entityTitleFactory.forGenre(t))),l=["Show",vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(i,r,e,s,a,l,t.summary)}forTrack(t,e=this.PlaybackButton.forTrack(t)){let n=0;n+=t.media.duration_ms;let i=this.entityLinkFactory.forTrack(t),r=this.ImageBox.forSquare(t.disc.album.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forTrack(t)],a=[...t.artists.map((t=>this.entityTitleFactory.forArtist(t))),this.entityTitleFactory.forAlbum(t.disc.album)],l=["Track",vt(n)].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(i,r,e,s,a,l)}forUser(t){let e=this.entityLinkFactory.forUser(t),n=this.ImageBox.forSquare(),i=[this.entityTitleFactory.forUser(t)],r=[ot("span").add(lt(t.username))],s=["User"].filter(o).map((t=>ot("div.entity-card__tag").add(lt(t))));return this.make(e,n,void 0,i,r,s)}static makeStyle(){return ot("style").add(lt(St))}}const xt=`\n\t.entity-row {\n\t\talign-items: center;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-template-columns: 60px 1fr;\n\t}\n\n\t.entity-row__artwork {\n\t\tborder-radius: 2px;\n\t\toverflow: hidden;\n\t\tposition: relative;\n\t}\n\n\t.entity-row__playback {\n\t\tposition: absolute;\n\t\t\ttop: 50%; left: 50%;\n\t\ttransform: translate(-50%, -50%);\n\t}\n\n\t.entity-row__content {\n\n\t}\n\n\t.entity-row__metadata {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t}\n\n\t.entity-row__titles {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.entity-row__title {\n\t\tcolor: ${yt};\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.entity-row__subtitle {\n\t\tcolor: ${gt};\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n`;class _t{constructor(t,e,n,i){this.entityTitleFactory=t,this.entityLinkFactory=e,this.ImageBox=n,this.PlaybackButton=i}make(t,e,n,i,r){return t.add(ot("div.entity-row").add(ot("div.entity-row__artwork").add(e).add(ot("div.entity-row__playback").add(n))).add(ot("div.entity-row__content").add(ot("div.entity-row__metadata").add(ot("div.entity-row__titles").add(0===i.length?void 0:ot("div.entity-row__title").add(...dt(i))).add(0===r.length?void 0:ot("div.entity-row__subtitle").add(...dt(r)))))))}forEntity(t){if(b.is(t))return this.forAlbum(t);if(g.is(t))return this.forArtist(t);if(S.is(t))return this.forDisc(t);if(D.is(t))return this.forEpisode(t);if(I.is(t))return this.forGenre(t);if(f.is(t))return this.forPerson(t);if(T.is(t))return this.forPlaylist(t);if(A.is(t))return this.forMovie(t);if(N.is(t))return this.forSeason(t);if(L.is(t))return this.forShow(t);if(k.is(t))return this.forTrack(t);if(_.is(t))return this.forUser(t);throw"Expected code to be unreachable!"}forAlbum(t,e=this.PlaybackButton.forAlbum(t)){let n=this.entityLinkFactory.forAlbum(t),i=this.ImageBox.forSquare(t.artwork.map((t=>`/files/${t.file_id}/`)).shift()),r=[this.entityTitleFactory.forAlbum(t)],s=t.artists.map((t=>this.entityTitleFactory.forArtist(t)));return this.make(n,i,e,r,s)}forArtist(t,e=this.PlaybackButton.forArtist(t)){var n;let i=this.entityLinkFactory.forArtist(t),r=this.ImageBox.forSquare(null===(n=t.albums[0])||void 0===n?void 0:n.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forArtist(t)],a=new Array;return this.make(i,r,e,s,a)}forDisc(t,e=this.PlaybackButton.forDisc(t)){let n=this.entityLinkFactory.forDisc(t),i=this.ImageBox.forSquare(t.album.artwork.map((t=>`/files/${t.file_id}/`)).shift()),r=[this.entityTitleFactory.forDisc(t)],s=[this.entityTitleFactory.forAlbum(t.album)];return this.make(n,i,e,r,s)}forEpisode(t,e=this.PlaybackButton.forEpisode(t)){let n=this.entityLinkFactory.forEpisode(t),i=this.ImageBox.forSquare(`/media/stills/${t.media.file_id}/`),r=[this.entityTitleFactory.forEpisode(t)],s=[this.entityTitleFactory.forShow(t.season.show),this.entityTitleFactory.forSeason(t.season)];return this.make(n,i,e,r,s)}forGenre(t){let e=this.entityLinkFactory.forGenre(t),n=this.ImageBox.forSquare(),i=[this.entityTitleFactory.forGenre(t)];return this.make(e,n,void 0,i,[])}forMovie(t,e=this.PlaybackButton.forMovie(t)){let n=this.entityLinkFactory.forMovie(t),i=this.ImageBox.forSquare(t.artwork.map((t=>`/files/${t.file_id}/`)).shift()),r=[this.entityTitleFactory.forMovie(t)],s=t.genres.map((t=>this.entityTitleFactory.forGenre(t)));return this.make(n,i,e,r,s)}forPerson(t){let e=this.entityLinkFactory.forPerson(t),n=this.ImageBox.forSquare(),i=[this.entityTitleFactory.forPerson(t)];return this.make(e,n,void 0,i,[])}forPlaylist(t,e=this.PlaybackButton.forPlaylist(t)){var n;let i=this.entityLinkFactory.forPlaylist(t),r=this.ImageBox.forSquare(null===(n=t.items[0])||void 0===n?void 0:n.track.disc.album.artwork.map((t=>`/files/${t.file_id}/`)).shift()),s=[this.entityTitleFactory.forPlaylist(t)],a=[this.entityTitleFactory.forUser(t.user)];return this.make(i,r,e,s,a)}forSeason(t,e=this.PlaybackButton.forSeason(t)){let n=this.entityLinkFactory.forSeason(t),i=this.ImageBox.forSquare(t.show.artwork.map((t=>`/files/${t.file_id}/`)).shift()),r=[this.entityTitleFactory.forSeason(t)],s=[this.entityTitleFactory.forShow(t.show)];return this.make(n,i,e,r,s)}forShow(t,e=this.PlaybackButton.forShow(t)){let n=this.entityLinkFactory.forShow(t),i=this.ImageBox.forSquare(t.artwork.map((t=>`/files/${t.file_id}/`)).shift()),r=[this.entityTitleFactory.forShow(t)],s=t.genres.map((t=>this.entityTitleFactory.forGenre(t)));return this.make(n,i,e,r,s)}forTrack(t,e=this.PlaybackButton.forTrack(t)){let n=this.entityLinkFactory.forTrack(t),i=this.ImageBox.forSquare(t.disc.album.artwork.map((t=>`/files/${t.file_id}/`)).shift()),r=[this.entityTitleFactory.forTrack(t)],s=[...t.artists.map((t=>this.entityTitleFactory.forArtist(t))),this.entityTitleFactory.forAlbum(t.disc.album)];return this.make(n,i,e,r,s)}forUser(t){let e=this.entityLinkFactory.forUser(t),n=this.ImageBox.forSquare(),i=[this.entityTitleFactory.forUser(t)],r=[ot("span").add(lt(t.username))];return this.make(e,n,void 0,i,r)}static makeStyle(){return ot("style").add(lt(xt))}}const Ot=`\n\t.playback-button {\n\t\tbackground-color: ${yt};\n\t\tborder-radius: 50%;\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tcursor: pointer;\n\t\tfill: rgb(31, 31, 31);\n\t\tpadding: 8px;\n\t\ttransition: transform 0.125s;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.playback-button:not([data-enabled="false"]):hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\n\t\t.playback-button:active {\n\t\t\ttransform: none;\n\t\t}\n\t}\n`;class Tt{constructor(t,e){this.player=t,this.iconFactory=e}make(t,e){let n=r(((t,e)=>t&&e),t,this.player.playback);return ot("div.playback-button").add(this.iconFactory.makePlay().bind("data-hide",n.addObserver((t=>t)))).add(this.iconFactory.makePause().bind("data-hide",n.addObserver((t=>!t)))).on("click",(()=>{n.getState()?this.player.pause():t.getState()?this.player.resume():e()}))}forEntity(t){if(b.is(t))return this.forAlbum(t);if(g.is(t))return this.forArtist(t);if(S.is(t))return this.forDisc(t);if(D.is(t))return this.forEpisode(t);if(A.is(t))return this.forMovie(t);if(T.is(t))return this.forPlaylist(t);if(N.is(t))return this.forSeason(t);if(L.is(t))return this.forShow(t);if(k.is(t))return this.forTrack(t);throw"Expected code to be unreachable!"}forAlbum(t,e,n){let i=r((i=>{if(!o(i))return!1;if(o(e)){let r=t.discs[e];if(i[i.length-2]!==r.disc_id)return!1;if(o(n)){let t=r.tracks[n];if(i[i.length-1]!==t.track_id)return!1}}else if(i[i.length-3]!==t.album_id)return!1;return!0}),this.player.contextPath);return this.make(i,(()=>this.player.playAlbum(t,e,n)))}forArtist(t,e,n,i){let s=r((r=>{if(!o(r))return!1;if(o(e)){let s=t.albums[e];if(r[r.length-3]!==s.album_id)return!1;if(o(n)){let t=s.discs[n];if(r[r.length-2]!==t.disc_id)return!1;if(o(i)){let e=t.tracks[i];if(r[r.length-1]!==e.track_id)return!1}}}else if(r[r.length-4]!==t.artist_id)return!1;return!0}),this.player.contextPath);return this.make(s,(()=>this.player.playArtist(t,e,n,i)))}forDisc(t,e){let n=r((n=>{if(!o(n))return!1;if(o(e)){let i=t.tracks[e];if(n[n.length-1]!==i.track_id)return!1}else if(n[n.length-2]!==t.disc_id)return!1;return!0}),this.player.contextPath);return this.make(n,(()=>this.player.playDisc(t,e)))}forEpisode(t){let e=r((e=>!!o(e)&&e[e.length-1]===t.episode_id),this.player.contextPath);return this.make(e,(()=>this.player.playEpisode(t)))}forMovie(t){let e=r((e=>!!o(e)&&e[e.length-1]===t.movie_id),this.player.contextPath);return this.make(e,(()=>this.player.playMovie(t)))}forPlaylist(t,e){let n=r((n=>{if(!o(n))return!1;if(o(e)){let i=t.items[e].track;if(n[n.length-1]!==i.track_id)return!1}else if(n[n.length-2]!==t.playlist_id)return!1;return!0}),this.player.contextPath);return this.make(n,(()=>this.player.playPlaylist(t,e)))}forSeason(t,e){let n=r((n=>{if(!o(n))return!1;if(o(e)){let i=t.episodes[e];if(n[n.length-1]!==i.episode_id)return!1}else if(n[n.length-2]!==t.season_id)return!1;return!0}),this.player.contextPath);return this.make(n,(()=>this.player.playSeason(t,e)))}forShow(t,e,n){let i=r((i=>{if(!o(i))return!1;if(o(e)){let r=t.seasons[e];if(i[i.length-2]!==r.season_id)return!1;if(o(n)){let t=r.episodes[n];if(i[i.length-1]!==t.episode_id)return!1}}else if(i[i.length-3]!==t.show_id)return!1;return!0}),this.player.contextPath);return this.make(i,(()=>this.player.playShow(t,e,n)))}forTrack(t){let e=r((e=>!!o(e)&&e[e.length-1]===t.track_id),this.player.contextPath);return this.make(e,(()=>this.player.playTrack(t)))}static makeStyle(){return ot("style").add(lt(Ot))}}const Et=t=>(e,n)=>{let i=t(e),r=t(n);return a(i)?a(r)?0:1:a(r)?a(i)?0:-1:i-r};Symbol.iterator;const jt={SetToken:l.l8.Object.of({token:l.l8.Union.of(l.l8.Undefined,l.l8.String)}),CreatePlaylistRequest:l.l8.Object.of({playlist:l.l8.Object.of({title:l.l8.String,description:l.l8.String})}),CreatePlaylistResponse:l.l8.Object.of({errors:l.l8.Array.of(l.l8.String),playlist_id:l.l8.String}),CreatePlaylist:l.l8.Object.of({playlist:l.l8.Reference.of((()=>O))}),DeletePlaylistRequest:l.l8.Object.of({playlist:l.l8.Object.of({playlist_id:l.l8.String})}),DeletePlaylistResponse:l.l8.Object.of({errors:l.l8.Array.of(l.l8.String)}),DeletePlaylist:l.l8.Object.of({playlist:l.l8.Reference.of((()=>O))}),UpdatePlaylistRequest:l.l8.Object.of({playlist:l.l8.Object.of({playlist_id:l.l8.String,title:l.l8.String,description:l.l8.String})}),UpdatePlaylistResponse:l.l8.Object.of({errors:l.l8.Array.of(l.l8.String)}),UpdatePlaylist:l.l8.Object.of({playlist:l.l8.Reference.of((()=>O))}),CreatePlaylistItemRequest:l.l8.Object.of({playlist_item:l.l8.Object.of({playlist_id:l.l8.String,track_id:l.l8.String})}),CreatePlaylistItemResponse:l.l8.Object.of({errors:l.l8.Array.of(l.l8.String),playlist_item_id:l.l8.String}),CreatePlaylistItem:l.l8.Object.of({playlist_item:l.l8.Reference.of((()=>E))}),DeletePlaylistItemRequest:l.l8.Object.of({playlist_item:l.l8.Object.of({playlist_item_id:l.l8.String})}),DeletePlaylistItemResponse:l.l8.Object.of({errors:l.l8.Array.of(l.l8.String)}),DeletePlaylistItem:l.l8.Object.of({playlist_item:l.l8.Reference.of((()=>E))}),UpdatePlaylistItemRequest:l.l8.Object.of({playlist_item:l.l8.Object.of({playlist_item_id:l.l8.String,number:l.l8.Number})}),UpdatePlaylistItemResponse:l.l8.Object.of({errors:l.l8.Array.of(l.l8.String)}),UpdatePlaylistItem:l.l8.Object.of({playlist_item:l.l8.Reference.of((()=>E))})};var Ct,It=function(t,e,n,i){return new(n||(n=Promise))((function(r,s){function a(t){try{l(i.next(t))}catch(t){s(t)}}function o(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,o)}l((i=i.apply(t,e||[])).next())}))};function Pt(t){let e="/sockets/"+t;return`${"https:"===window.location.protocol?"wss:":"ws:"}//${window.location.host}${e}`}let At=new class{constructor(t,e=(t=>new WebSocket(t))){this.estimatedProgress=new i(void 0),this.estimatedProgressTimestamp=new i(void 0),this.token=new i(void 0),this.localDevice=new i(void 0),this.devices=new s(new Array),this.device=new i(void 0),this.isDeviceLocal=new i(!1),this.isDeviceRemote=new i(!1),this.context=new i(void 0),this.contextPath=new i(void 0),this.flattenedContext=new i(void 0),this.lastIndex=new i(void 0),this.lastEntry=new i(void 0),this.lastLocalEntry=new i(void 0),this.currentIndex=new i(void 0),this.currentEntry=new i(void 0),this.currentLocalEntry=new i(void 0),this.nextIndex=new i(void 0),this.nextEntry=new i(void 0),this.nextLocalEntry=new i(void 0),this.playback=new i(!1),this.progress=new i(void 0),this.localPlayback=new i(!1),this.canPlayLast=new i(!1),this.canPlayCurrent=new i(!1),this.canPlayNext=new i(!1),this.isCurrentEntryVideo=new i(!1),this.isOnline=new i(!1),this.tsc=new rt(t,e,Z),this.tsc.addEventListener("sys","connect",(()=>{this.isOnline.updateState(!0)})),this.tsc.addEventListener("sys","disconnect",(()=>{this.isOnline.updateState(!1)})),this.context.addObserver((t=>{if(o(t))if(z.is(t)){let e=[],n=t;for(let t of n.discs)e.push(...t.tracks);this.flattenedContext.updateState(e)}else if(G.is(t)){let e=[],n=t;for(let t of n.albums)for(let n of t.discs)e.push(...n.tracks);this.flattenedContext.updateState(e)}else if(Y.is(t)){let e=[],n=t;e.push(n),this.flattenedContext.updateState(e)}else if(J.is(t)){let e=[],n=t;e.push(n),this.flattenedContext.updateState(e)}else if(H.is(t)){let e=[],n=t;for(let t of n.items)e.push(t.track);this.flattenedContext.updateState(e)}else if(X.is(t)){let e=[],n=t;e.push(...n.episodes),this.flattenedContext.updateState(e)}else if(W.is(t)){let e=[],n=t;for(let t of n.seasons)e.push(...t.episodes);this.flattenedContext.updateState(e)}else{if(!V.is(t))throw"Expected code to be unreachable!";{let e=[],n=t;e.push(n),this.flattenedContext.updateState(e)}}}));{let t=()=>{let t=this.context.getState(),e=this.currentIndex.getState();if(o(t)&&o(e)){if(z.is(t)){let n=0,i=e,r=t.discs;for(let t=0;t<r.length;t++){let e=r[t].tracks.length;if(!(i>=e))break;n+=1,i-=e}return this.contextPath.updateState([t.album_id,t.discs[n].disc_id,t.discs[n].tracks[i].track_id])}if(G.is(t)){let n=0,i=0,r=e,s=t.albums;t:for(let t=0;t<s.length;t++){let e=s[t].discs;for(let t=0;t<e.length;t++){let n=e[t].tracks.length;if(!(r>=n))break t;i+=1,r-=n}n+=1,i=0}return this.contextPath.updateState([t.artist_id,t.albums[n].album_id,t.albums[n].discs[i].disc_id,t.albums[n].discs[i].tracks[r].track_id])}if(Y.is(t))return this.contextPath.updateState([t.episode_id]);if(J.is(t))return this.contextPath.updateState([t.movie_id]);if(H.is(t)){let n=e;return this.contextPath.updateState([t.playlist_id,t.items[n].track.track_id])}if(W.is(t)){let n=0,i=e,r=t.seasons;for(let t=0;t<r.length;t++){let e=r[t].episodes.length;if(!(i>=e))break;n+=1,i-=e}return this.contextPath.updateState([t.show_id,t.seasons[n].season_id,t.seasons[n].episodes[i].episode_id])}if(X.is(t)){let n=e;return this.contextPath.updateState([t.season_id,t.episodes[n].episode_id])}if(V.is(t))return this.contextPath.updateState([t.track_id]);throw"Expected code to be unreachable!"}this.contextPath.updateState(void 0)};this.context.addObserver(t),this.currentIndex.addObserver(t)}this.lastEntry.addObserver((t=>{this.canPlayLast.updateState(o(t))})),this.currentEntry.addObserver((t=>{this.canPlayCurrent.updateState(o(t))})),this.nextEntry.addObserver((t=>{this.canPlayNext.updateState(o(t))})),this.progress.addObserver((t=>{this.estimatedProgress.updateState(t),this.estimatedProgressTimestamp.updateState(Date.now())})),this.playback.addObserver((t=>{let e=this.estimatedProgress.getState(),n=this.estimatedProgressTimestamp.getState(),i=Date.now();t||o(e)&&o(n)&&this.estimatedProgress.updateState(e+(i-n)/1e3),this.estimatedProgressTimestamp.updateState(i)})),this.estimatedProgress.addObserver((t=>{console.log("Estimated progress to "+(null!=t?t:0))}));{let t=()=>{let t=this.playback.getState(),e=this.isDeviceLocal.getState();this.localPlayback.updateState(e&&t)};this.playback.addObserver(t),this.isDeviceLocal.addObserver(t)}{let t=()=>{let t=this.lastEntry.getState(),e=this.isDeviceLocal.getState();this.lastLocalEntry.updateState(e?t:void 0)};this.lastEntry.addObserver(t),this.isDeviceLocal.addObserver(t)}{let t=()=>{let t=this.currentEntry.getState(),e=this.isDeviceLocal.getState();this.currentLocalEntry.updateState(e?t:void 0)};this.currentEntry.addObserver(t),this.isDeviceLocal.addObserver(t)}{let t=()=>{let t=this.nextEntry.getState(),e=this.isDeviceLocal.getState();this.nextLocalEntry.updateState(e?t:void 0)};this.nextEntry.addObserver(t),this.isDeviceLocal.addObserver(t)}{let t=()=>{let t=this.localDevice.getState(),e=this.device.getState();return o(t)&&o(e)&&t.id===e.id?this.isDeviceLocal.updateState(!0):this.isDeviceLocal.updateState(!1)};this.localDevice.addObserver(t),this.device.addObserver(t)}{let t=()=>{let t=this.localDevice.getState(),e=this.device.getState();return o(t)&&o(e)&&t.id!==e.id?this.isDeviceRemote.updateState(!0):this.isDeviceRemote.updateState(!1)};this.localDevice.addObserver(t),this.device.addObserver(t)}{let t=()=>{let t=this.flattenedContext.getState(),e=this.currentIndex.getState();if(o(t)&&o(e)){let n=e-1;if(n>=0&&n<t.length)return this.lastIndex.updateState(n)}return this.lastIndex.updateState(void 0)};this.flattenedContext.addObserver(t),this.currentIndex.addObserver(t)}{let t=()=>{let t=this.flattenedContext.getState(),e=this.currentIndex.getState();if(o(t)&&o(e)){let n=e+1;if(n>=0&&n<t.length)return this.nextIndex.updateState(n)}return this.nextIndex.updateState(void 0)};this.flattenedContext.addObserver(t),this.currentIndex.addObserver(t)}{let t=()=>{let t=this.flattenedContext.getState(),e=this.lastIndex.getState();return o(t)&&o(e)?this.lastEntry.updateState(t[e]):this.lastEntry.updateState(void 0)};this.flattenedContext.addObserver(t),this.lastIndex.addObserver(t)}{let t=()=>{let t=this.flattenedContext.getState(),e=this.currentIndex.getState();return o(t)&&o(e)&&e>=0&&e+0<t.length?this.currentEntry.updateState(t[e+0]):this.currentEntry.updateState(void 0)};this.flattenedContext.addObserver(t),this.currentIndex.addObserver(t)}{let t=()=>{let t=this.flattenedContext.getState(),e=this.nextIndex.getState();return o(t)&&o(e)?this.nextEntry.updateState(t[e]):this.nextEntry.updateState(void 0)};this.flattenedContext.addObserver(t),this.nextIndex.addObserver(t)}this.tsc.addEventListener("app","SetLocalDevice",(t=>{this.localDevice.updateState(t.device)})),this.tsc.addEventListener("app","SetDevices",(t=>{this.devices.update(t.devices)})),this.tsc.addEventListener("app","SetContext",(t=>{this.context.updateState(t.context)})),this.tsc.addEventListener("app","SetDevice",(t=>{this.device.updateState(t.device)})),this.tsc.addEventListener("app","SetIndex",(t=>{this.currentIndex.updateState(t.index)})),this.tsc.addEventListener("app","SetPlayback",(t=>{this.playback.updateState(t.playback)})),this.tsc.addEventListener("app","SetProgress",(t=>{this.progress.updateState(t.progress)})),this.tsc.addEventListener("app","SetToken",(t=>{this.token.updateState(t.token)})),this.isOnline.addObserver((t=>{t||(this.context.updateState(void 0),this.currentIndex.updateState(void 0),this.playback.updateState(!1),this.progress.updateState(void 0))})),r(((t,e)=>{t&&this.tsc.send("SetToken",{token:e})}),this.isOnline,this.token)}play(t,e){this.tsc.send("SetContext",{context:t}),this.tsc.send("SetIndex",{index:e}),this.tsc.send("SetPlayback",{playback:!0})}authenticate(t){this.token.updateState(t)}close(){this.tsc.close()}last(){let t=this.lastIndex.getState();o(t)?(this.currentIndex.updateState(t),this.tsc.send("SetIndex",{index:t})):this.pause()}next(){let t=this.nextIndex.getState();o(t)?(this.currentIndex.updateState(t),this.tsc.send("SetIndex",{index:t})):this.pause()}pause(){this.playback.updateState(!1),this.tsc.send("SetPlayback",{playback:!1})}playAlbum(t,e,n){let i=0;if(o(e)){let r=t.discs;if(e<0||e>=r.length)throw`Expected ${e} to be a number between 0 and ${r.length}!`;if(i+=r.slice(0,e).reduce(((t,e)=>t+e.tracks.length),0),o(n)){let t=r[e].tracks;if(n<0||n>=t.length)throw`Expected ${n} to be a number between 0 and ${t.length}!`;i+=n}}return this.play(t,i)}playArtist(t,e,n,i){let r=0;if(o(e)){let s=t.albums;if(e<0||e>=s.length)throw`Expected ${e} to be a number between 0 and ${s.length}!`;if(r+=s.slice(0,e).reduce(((t,e)=>t+e.discs.reduce(((t,e)=>t+e.tracks.length),0)),0),o(n)){let t=s[e].discs;if(n<0||n>=t.length)throw`Expected ${n} to be a number between 0 and ${t.length}!`;if(r+=t.slice(0,n).reduce(((t,e)=>t+e.tracks.length),0),o(i)){let e=t[n].tracks;if(i<0||i>=e.length)throw`Expected ${i} to be a number between 0 and ${e.length}!`;r+=i}}}return this.play(t,r)}playDisc(t,e){let n=0;if(o(e)){let i=t.tracks;if(e<0||e>=i.length)throw`Expected ${e} to be a number between 0 and ${i.length}!`;n+=e}return this.play(t,n)}playEpisode(t){this.play(t,0)}playMovie(t){this.play(t,0)}playPlaylist(t,e){let n=0;if(o(e)){let i=t.items;if(e<0||e>=i.length)throw`Expected ${e} to be a number between 0 and ${i.length}!`;n+=e}return this.play(t,n)}playSeason(t,e){let n=0;if(o(e)){let i=t.episodes;if(e<0||e>=i.length)throw`Expected ${e} to be a number between 0 and ${i.length}!`;n+=e}return this.play(t,n)}playShow(t,e,n){let i=0;if(o(e)){let r=t.seasons;if(e<0||e>=r.length)throw`Expected ${e} to be a number between 0 and ${r.length}!`;if(i+=r.slice(0,e).reduce(((t,e)=>t+e.episodes.length),0),o(n)){let t=r[e].episodes;if(n<0||n>=t.length)throw`Expected ${n} to be a number between 0 and ${t.length}!`;i+=n}}return this.play(t,i)}playTrack(t){this.play(t,0)}reconnect(){this.tsc.reconnect()}resume(){this.canPlayCurrent.getState()&&(this.playback.updateState(!0),this.tsc.send("SetPlayback",{playback:!0}))}seek(t){this.tsc.send("SetProgress",{progress:t})}toggle(){this.playback.getState()?this.pause():this.resume()}transfer(t){this.tsc.send("SetDevice",{device:t})}}(Pt("context/?type=browser&name=Orbit")),Rt=new class{constructor(t,e=(t=>new WebSocket(t))){this.token=new i(void 0),this.online=new i(!1),this.playlists=new s(new Array),this.tsc=new rt(t,e,jt),this.tsc.addEventListener("sys","connect",(()=>{this.online.updateState(!0)})),this.tsc.addEventListener("sys","disconnect",(()=>{this.online.updateState(!1)})),r(((t,e)=>{t&&this.tsc.send("SetToken",{token:e})}),this.online,this.token),this.tsc.addEventListener("app","CreatePlaylist",(t=>{for(let[e,n]of this.playlists.getState().entries())n.getState().playlist_id===t.playlist.playlist_id&&this.playlists.splice(e-0);let e=Object.assign(Object.assign({},t.playlist),{items:new Array});this.playlists.append(new i(e))})),this.tsc.addEventListener("app","DeletePlaylist",(t=>{for(let[e,n]of this.playlists.getState().entries())n.getState().playlist_id===t.playlist.playlist_id&&this.playlists.splice(e-0)})),this.tsc.addEventListener("app","UpdatePlaylist",(t=>{for(let[e,n]of this.playlists.getState().entries()){let e=n.getState();e.playlist_id===t.playlist.playlist_id&&n.updateState(Object.assign(Object.assign({},e),t.playlist))}})),this.tsc.addEventListener("app","CreatePlaylistItem",(t=>{for(let[e,n]of this.playlists.getState().entries()){let e=n.getState();if(e.playlist_id===t.playlist_item.playlist.playlist_id){let i=e.items.filter((e=>e.playlist_item_id!==t.playlist_item.playlist_item_id)),r=e.items.length-i.length;i.push(t.playlist_item);let s=1;i=i.map((e=>Object.assign(Object.assign({},e),{number:e.number+(e.number>t.playlist_item.number?s-r:0)}))).sort(Et((t=>t.number))),e=Object.assign(Object.assign({},e),{items:i}),n.updateState(e)}}})),this.tsc.addEventListener("app","DeletePlaylistItem",(t=>{for(let[e,n]of this.playlists.getState().entries()){let e=n.getState();if(e.playlist_id===t.playlist_item.playlist.playlist_id){let i=e.items.filter((e=>e.playlist_item_id!==t.playlist_item.playlist_item_id)),r=e.items.length-i.length,s=0;i=i.map((e=>Object.assign(Object.assign({},e),{number:e.number+(e.number>t.playlist_item.number?s-r:0)}))).sort(Et((t=>t.number))),e=Object.assign(Object.assign({},e),{items:i}),n.updateState(e)}}})),this.tsc.addEventListener("app","UpdatePlaylistItem",(t=>{for(let[e,n]of this.playlists.getState().entries()){let e=n.getState();if(e.playlist_id===t.playlist_item.playlist.playlist_id){let i=e.items.findIndex((e=>e.playlist_item_id===t.playlist_item.playlist_item_id));if(i>=0){let r=t.playlist_item.number-1;if(r>i){for(let t=i+1;t<r;t++)e.items[t].number-=1;e.items.splice(r,0,...e.items.splice(i,1))}else if(r<i){for(let t=r;t<i;t++)e.items[t].number+=1;e.items.splice(r,0,...e.items.splice(i,1))}e.items[r]=Object.assign(Object.assign({},e.items[r]),t.playlist_item),n.updateState(Object.assign({},e))}}}}))}authenticate(t){this.token.updateState(t)}isOnline(){return this.online.getState()}createPlaylist(t){return this.tsc.request("CreatePlaylistRequest","CreatePlaylistResponse",t)}deletePlaylist(t){return this.tsc.request("DeletePlaylistRequest","DeletePlaylistResponse",t)}updatePlaylist(t){return this.tsc.request("UpdatePlaylistRequest","UpdatePlaylistResponse",t)}createPlaylistItem(t){return this.tsc.request("CreatePlaylistItemRequest","CreatePlaylistItemResponse",t)}deletePlaylistItem(t){return this.tsc.request("DeletePlaylistItemRequest","DeletePlaylistItemResponse",t)}updatePlaylistItem(t){return this.tsc.request("UpdatePlaylistItemRequest","UpdatePlaylistItemResponse",t)}close(){this.tsc.close()}reconnect(){this.tsc.reconnect()}}(Pt("playlists/"));window.addEventListener("focus",(()=>{At.isOnline.getState()||At.reconnect(),Rt.isOnline()||Rt.reconnect()})),window.addEventListener("keydown",(t=>{if("Space"===t.code){if(t.target instanceof HTMLInputElement)return;t.preventDefault(),t.stopPropagation(),At.toggle()}})),At.isOnline.addObserver((t=>{document.documentElement.setAttribute("data-online",""+t)}));let Lt=document.createElement("video"),$t=document.createElement("video"),Nt=document.createElement("video");$t.addEventListener("ended",(()=>{At.next()}));let Ut=new i(!0);$t.addEventListener("loadeddata",(()=>{Ut.updateState(!1)})),At.playback.addObserver((t=>{$t.autoplay=t})),$t.addEventListener("playing",(()=>{At.isCurrentEntryVideo.updateState($t.videoWidth>0&&$t.videoHeight>0)}));{let t=()=>It(void 0,void 0,void 0,(function*(){var t;Ut.getState()||($t.currentTime=null!==(t=At.progress.getState())&&void 0!==t?t:0)}));At.progress.addObserver(t),Ut.addObserver(t)}{let t=()=>It(void 0,void 0,void 0,(function*(){if(!Ut.getState())if(At.playback.getState())try{yield $t.play()}catch(t){}else $t.pause()}));At.playback.addObserver(t),Ut.addObserver(t)}{let t=()=>{let t=At.canPlayLast.getState(),e=At.canPlayCurrent.getState(),n=At.canPlayNext.getState();!function(t){if(navigator.mediaSession)for(let e in t)navigator.mediaSession.setActionHandler(e,t[e])}({play:e?At.resume.bind(At):void 0,pause:e?At.pause.bind(At):void 0,previoustrack:t?At.last.bind(At):void 0,nexttrack:n?At.next.bind(At):void 0})};At.canPlayLast.addObserver(t),At.canPlayCurrent.addObserver(t),At.canPlayNext.addObserver(t)}let Dt=new i(""),Ft=new i("");At.currentEntry.addObserver((t=>{if(o(t))if(D.is(t)){let n=t,i=n.season.show;Dt.updateState(n.title),Ft.updateState(i.title),e({title:n.title})}else if(A.is(t)){let n=t;Dt.updateState(n.title),Ft.updateState(""),e({title:n.title,artwork:n.artwork.map((t=>({src:`/files/${t.file_id}/?token=${se}`,sizes:`${t.width}x${t.height}`,type:t.mime})))})}else{if(!k.is(t))throw"Expected code to be unreachable!";{let n=t,i=n.disc.album;Dt.updateState(n.title),Ft.updateState(n.artists.map((t=>t.title)).join(" · ")),e({title:n.title,artist:n.artists.map((t=>t.title)).join(" · "),album:i.title,artwork:i.artwork.map((t=>({src:`/files/${t.file_id}/?token=${se}`,sizes:`${t.width}x${t.height}`,type:t.mime})))})}}else Dt.updateState(""),Ft.updateState(""),e({})}));{let t=()=>{let t=At.lastLocalEntry.getState(),e=At.token.getState();a(t)||a(e)?Lt.src="":Lt.src=`/files/${t.media.file_id}/?token=${e}`};At.lastLocalEntry.addObserver(t),At.token.addObserver(t)}{let e=()=>{var e,n;Ut.updateState(!0);let i=At.currentLocalEntry.getState(),r=At.token.getState();if(a(i)||a(r))$t.src="";else{for($t.src=`/files/${i.media.file_id}/?token=${r}`;null!=$t.lastChild;)$t.removeChild($t.lastChild);if(A.is(i)||D.is(i)){let s=i.subtitles,a=null!==(n=null!==(e=s.find((t=>"swe"===t.language)))&&void 0!==e?e:s.find((t=>"eng"===t.language)))&&void 0!==n?n:s.find((t=>!0));for(let e of s){let n=document.createElement("track");if(n.src=`/files/${e.file_id}/?token=${r}`,o(e.language)){let i=t[e.language];o(i)&&(n.label=i.title,n.srclang=i.iso639_1,n.kind="subtitles")}e===a&&n.setAttribute("default",""),$t.appendChild(n)}}}};At.currentLocalEntry.addObserver(e),At.token.addObserver(e)}{let t=()=>{let t=At.nextLocalEntry.getState(),e=At.token.getState();a(t)||a(e)?Lt.src="":Lt.src=`/files/${t.media.file_id}/?token=${e}`};At.nextLocalEntry.addObserver(t),At.token.addObserver(t)}const Mt=new i(null!==(Ct=localStorage.getItem("token"))&&void 0!==Ct?Ct:void 0),Bt=new i(void 0),zt=new i(!1),Gt=new s(new Array);Bt.addObserver((t=>{w.is(t)?(Gt.update([ot("div").set("style","align-items: center; display: grid; gap: 16px; grid-template-columns: 1fr min-content;").add(Pe(lt("Add to playlist"))).add(je().on("click",(()=>{zt.updateState(!1)})).add(Vt.makeCross())),ot("div").set("style","align-items: center; cursor: pointer; display: grid; fill: rgb(255, 255, 255); gap: 16px; grid-template-columns: min-content 1fr;").on("click",(()=>It(void 0,void 0,void 0,(function*(){let e=yield Rt.createPlaylist({playlist:{title:"New playlist",description:"A recently created playlist."}});e.errors.length>0||(yield Rt.createPlaylistItem({playlist_item:{playlist_id:e.playlist_id,track_id:t.track_id}})).errors.length>0||zt.updateState(!1)})))).add(Vt.makePlus()).add(Pe(lt("New playlist"))),ot("div").set("style","display: grid; gap: 16px;").bind("data-hide",Rt.playlists.compute((t=>0===t.length))).repeat(Rt.playlists,(e=>ot("div").set("style","align-items: center; cursor: pointer; display: grid; fill: rgb(255, 255, 255); gap: 16px; grid-template-columns: min-content 1fr;").on("click",(()=>It(void 0,void 0,void 0,(function*(){(yield Rt.createPlaylistItem({playlist_item:{playlist_id:e.getState().playlist_id,track_id:t.track_id}})).errors.length>0||zt.updateState(!1)})))).add(Vt.makeChevron()).add(Pe(lt(e.getState().title)))))]),zt.updateState(!0)):zt.updateState(!1)}));const qt=new ut;document.head.appendChild(ut.makeStyle().render());const Vt=new ft;document.head.appendChild(ft.makeStyle().render());const Ht=new ht(Vt);document.head.appendChild(ht.makeStyle().render());const Jt=new Tt(At,Vt);document.head.appendChild(Tt.makeStyle().render());const Wt=new mt(Mt);document.head.appendChild(mt.makeStyle().render());const Xt=new bt(Ae,Bt);document.head.appendChild(bt.makeStyle().render());const Yt=new pt(Xt);document.head.appendChild(pt.makeStyle().render());const Qt=new kt(Yt,Xt,Wt,Jt);document.head.appendChild(kt.makeStyle().render());const Kt=new _t(Yt,Xt,Wt,Jt);document.head.appendChild(_t.makeStyle().render());const Zt="rgb(223, 79, 127)";let te=document.createElement("style");te.innerText=`\n\t::-webkit-scrollbar {\n\t\tbackground-color: transparent;\n\t\theight: 8px;\n\t\twidth: 8px;\n\t}\n\n\t::-webkit-scrollbar-corner {\n\t\tbackground-color: transparent;\n\t}\n\n\t::-webkit-scrollbar-thumb {\n\t\tbackground-color: rgba(255, 255, 255, 0.125);\n\t\tborder-radius: 4px;\n\t}\n\n\t* {\n\t\tborder: none;\n\t\tfont-size: 0px;\n\t\tmargin: 0px;\n\t\tline-height: 1;\n\t\toutline: none;\n\t\tpadding: 0px;\n\t}\n\n\ta,\n\tspan {\n\t\tcolor: inherit;\n\t\tfont-size: inherit;\n\t}\n\n\ta {\n\t\ttext-decoration: none;\n\t\ttransition: color 0.125s;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\ta:hover {\n\t\t\tcolor: rgb(255, 255, 255);\n\t\t}\n\t}\n\n\thtml {\n\t\theight: 100%;\n\t}\n\n\tbody {\n\t\theight: 100%;\n\t}\n\n\t.page-header {\n\t\tbackground-color: ${Zt};\n\t}\n\n\t.page-header__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tcursor: pointer;\n\t\tfont-family: "Pacifico", cursive;\n\t\tfont-size: 32px;\n\t\ttransform-origin: left;\n\t\ttransition: transform 0.125s;\n\t\twhite-space: nowrap;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.page-header__title:hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\t}\n\n\t[data-hide="true"] {\n\t\tdisplay: none !important;\n\t}\n\n\tbody {\n\t\tbackground-color: ${Zt};\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-family: "Nunito", sans-serif;\n\t\toverflow: hidden;\n\t\ttouch-callout: none;\n\t\t\t-webkit-touch-callout: none;\n\t\t\t-moz-touch-callout: none;\n\t\t\t-ms-touch-callout: none;\n\t\t\t-o-touch-callout: none;\n\t\tuser-select: none;\n\t\t\t-webkit-user-select: none;\n\t\t\t-moz-user-select: none;\n\t\t\t-ms-user-select: none;\n\t\t\t-o-user-select: none;\n\t}\n\n\tbody ::selection {\n\t\tbackground-color: ${Zt};\n\t\tcolor: rgb(255, 255, 255);\n\t}\n\n\tbutton {\n\t\tbackground-color: ${Zt};\n\t\tborder-radius: 64px;\n\t\tcolor: rgb(255, 255, 255);\n\t\tcursor: pointer;\n\t\tfont-size: 16px;\n\t\tpadding: 8px 16px;\n\t\ttransition: background-color 0.125s, color 0.125s;\n\t}\n\n\tbutton[data-enabled="false"] {\n\t\tbackground-color: rgb(79, 79, 79);\n\t\tcolor: rgb(159, 159, 159);\n\t\tcursor: default;\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\tbutton:not([data-enabled="false"]):hover {\n\t\t\tbackground-color: rgb(255, 255, 255);\n\t\t\tcolor: rgb(31, 31, 31);\n\t\t}\n\n\t\tbutton:active {\n\t\t\ttransform: none;\n\t\t}\n\t}\n\n\tinput {\n\t\tbackground-color: rgb(47, 47, 47);\n\t\tborder-radius: 64px;\n\t\tbox-sizing: border-box;\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\tpadding: 8px 16px 8px 32px;\n\t\twidth: 100%;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.slider-widget {\n\t\tpadding: 4px;\n\t}\n\n\t.slider-widget__indicator {\n\t\tpadding: 4px;\n\t\tborder-radius: 4px;\n\t\tbackground-color: rgb(31, 31, 31);\n\t}\n\n\t.slider-widget__knob-wrapper {\n\t\tposition: relative;\n\t}\n\n\t.slider-widget__knob {\n\t\tbox-shadow: 0px 0px 8px 0px rgba(0, 0, 0, 0.5);\n\t\twidth: 16px;\n\t\theight: 16px;\n\t\tborder-radius: 50%;\n\t\tbackground-color: rgb(255, 255, 255);\n\t\tposition: absolute;\n\t\ttop: 0%;\n\t\tleft: 0%;\n\t\tmargin-top: -8px;\n\t\tmargin-left: -8px;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.content {\n\t\tbox-sizing: border-box;\n\t\tdisplay: grid;\n\t\tgap: 64px;\n\t\tmargin: 0px auto;\n\t\tmax-width: 960px;\n\t\tpadding: 32px;\n\t}\n\n\t.content--narrow {\n\t\tmax-width: 480px;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\t.text-header {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 20px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.text-paragraph {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 16px;\n\t\tline-height: 1.25;\n\t\tword-break: break-word;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.login-modal {\n\t\tdisplay: grid;\n\t\tgap: 64px;\n\t}\n\n\t.login-modal__form {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t}\n\n\n\n\n\n\n\n\n\t.modal-container {\n\t\tbackground-color: rgb(31, 31, 31);\n\t\theight: 100%;\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\tz-index: 1;\n\t}\n\n\n\n\n\n\n\n\n\n\n\t.device-selector {\n\t\tdisplay: grid;\n\t\tgap: 64px;\n\t}\n\n\t.device-selector__devices {\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t}\n\n\t.device-selector__device {\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-template-columns: min-content 1fr;\n\t}\n\n\t.device-selector__device-info {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.device-selector__device-name {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.device-selector__device-type {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\t.media-player {\n\t\talign-items: center;\n\t\tdisplay: grid;\n\t\tgap: 16px;\n\t\tgrid-template-columns: 1fr min-content;\n\t}\n\n\t.media-player__metadata {\n\t\tcursor: pointer;\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.media-player__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-player__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.media-player__controls {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t\tgrid-auto-columns: minmax(auto, min-content);\n\t\tgrid-auto-flow: column;\n\t}\n\n\n\n\n\n\n\n\n\t.icon-button {\n\t\tbackground-color: rgb(255, 255, 255);\n\t\tborder-radius: 50%;\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tcursor: pointer;\n\t\tfill: rgb(31, 31, 31);\n\t\tpadding: 8px;\n\t\ttransition: transform 0.125s;\n\t}\n\n\t.icon-button[data-enabled="false"] {\n\t\tbackground-color: rgb(79, 79, 79);\n\t\tcursor: default;\n\t}\n\n\t.icon-button[data-active="true"] {\n\t\tbackground-color: ${Zt};\n\t\tfill: rgb(255, 255, 255);\n\t}\n\n\t@media (hover: hover) and (pointer: fine) {\n\t\t.icon-button:not([data-enabled="false"]):hover {\n\t\t\ttransform: scale(1.25);\n\t\t}\n\n\t\t.icon-button:active {\n\t\t\ttransform: none;\n\t\t}\n\t}\n\n\n\n\n\n\n\n\n\n\n\n\t.app {\n\t\tdisplay: grid;\n\t\theight: 100%;\n\t\tgrid-template-rows: min-content 1fr min-content;\n\t}\n\n\t.app__header {\n\t\tbackground-color: ${Zt};\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tz-index: 1;\n\t}\n\n\t.app__content {\n\t\tbackground-color: rgb(31, 31, 31);\n\t\theight: auto;\n\t\toverflow: hidden;\n\t\tposition: relative;\n\t\tz-index: 0;\n\t}\n\n\t.app__navigation {\n\t\tbackground-color: rgb(47, 47, 47);\n\t\tbox-shadow: 0px 0px 8px 4px rgba(0, 0, 0, 0.25);\n\t\tposition: relative;\n\t\tz-index: 1;\n\t}\n\n\t.app__message-bar {\n\t\tbackground-color: ${Zt};\n\t}\n\n\t.offline-indicator {\n\t\tmargin: 0px auto;\n\t\tmax-width: 960px;\n\t\tpadding: 8px;\n\t}\n\n\t.offline-indicator__content {\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\n\n\n\n\t.scroll-container {\n\t\theight: 100%;\n\t\toverflow-y: scroll;\n\t\toverflow-x: auto;\n\t\twidth: 100%;\n\t}\n\n\n\n\n\n\n\n\n\t.access-token {\n\t\tdisplay: grid;\n\t\tgap: 8px;\n\t}\n\n\t.access-token__title {\n\t\tcolor: rgb(255, 255, 255);\n\t\tfont-family: "Space Mono", monospace;\n\t\tfont-size: 16px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.access-token__subtitle {\n\t\tcolor: rgb(159, 159, 159);\n\t\tfont-size: 12px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n`,document.head.appendChild(te);let ee=(t,e,n)=>{let i=new XMLHttpRequest;i.addEventListener("readystatechange",(()=>{i.readyState===XMLHttpRequest.DONE&&n(i.status,JSON.parse(i.responseText))})),i.open("POST",t,!0),i.send(JSON.stringify(e))};const ne=new i(!1);At.devices.addObserver({onappend:()=>{At.devices.getState().length<2&&ne.updateState(!1)},onsplice:()=>{At.devices.getState().length<2&&ne.updateState(!1)}});const ie=new i(!1);{let t=()=>{let t=At.isDeviceLocal.getState(),e=At.isCurrentEntryVideo.getState();ie.updateState(t&&e)};At.isDeviceLocal.addObserver(t),At.isCurrentEntryVideo.addObserver(t)}const re=r(((t,e,n)=>a(t)?"login":e?"context":n?"devices":void 0),Mt,zt,ne);let se;Mt.addObserver((t=>{o(t)?localStorage.setItem("token",t):localStorage.removeItem("token"),se=t,At.authenticate(se),Rt.authenticate(se)})),function(){return It(this,void 0,void 0,(function*(){return new Promise(((t,e)=>{ee("/api/auth/?token="+se,{},((e,n)=>{Mt.updateState(n.token),t(se)}))}))}))}().catch((()=>{}));let ae=document.createElement("div"),oe=document.createElement("div"),le=ot("div.app").render();document.body.appendChild(le);let de=ot("div.app__header").add(ot("div.content").set("style","padding: 16px").add(ot("div.page-header__title").add(lt("Orbit")).on("click",(()=>{Ae("/")})))).render();le.appendChild(de),oe.setAttribute("class","app__content"),le.appendChild(oe);let ce=new s([]);{let t=()=>{let t=At.devices.getState(),e=At.device.getState(),n=At.localDevice.getState();ce.update(t.map((t=>Object.assign(Object.assign({},t),{active:(null==e?void 0:e.id)===t.id,local:(null==n?void 0:n.id)===t.id}))))};At.devices.addObserver({onappend:t,onsplice:t}),At.device.addObserver(t),At.localDevice.addObserver(t)}let pe=new i(""),ue=new i(""),he=r(((t,e)=>""!==t&&""!==e),pe,ue),fe=new i(""),ye=new i(""),ge=new i(""),me=new s(new Array),be=r(((t,e,n,i,r)=>""!==t&&""!==e&&""!==n&&""!==i&&""!==r&&e===n),pe,ue,fe,ye,ge);function ve(){return It(this,void 0,void 0,(function*(){he.getState()&&(me.update([]),o(yield function(t,e){return It(this,void 0,void 0,(function*(){return new Promise(((n,i)=>{ee("/api/auth/",{username:t,password:e},((t,e)=>{Mt.updateState(e.token),n(se)}))}))}))}(pe.getState(),ue.getState()))?me.update([]):me.update(["The login was unsuccessful! Please check your credentials and try again."]))}))}function Se(){return It(this,void 0,void 0,(function*(){be.getState()&&(me.update([]),ee("/api/register/",{username:pe.getState(),password:ue.getState(),name:ye.getState(),key_id:ge.getState()},((t,e)=>{ct.is(e)?me.update(e.errors):(me.update([]),Mt.updateState(e.token))})))}))}let we=ot("div.modal-container").bind("data-hide",re.addObserver(a)).add(ot("div.scroll-container").bind("data-hide",re.addObserver((t=>"devices"!==t))).add(ot("div.content.content--narrow").add(ot("div.device-selector").add(ot("div.device-selector__devices").repeat(ce,(t=>ot("div.device-selector__device").add(je().set("data-active",""+t.active).add(Vt.makeBroadcast())).add(ot("div.device-selector__device-info").add(ot("div.device-selector__device-name").add(lt(t.name))).add(ot("div.device-selector__device-type").add(lt(t.local?"Local device":"Remote device")))).on("click",(()=>{At.transfer({id:t.id,type:t.type,name:t.name}),ne.updateState(!1)})))))))).add(ot("div.scroll-container").bind("data-hide",re.addObserver((t=>"login"!==t))).add(ot("div.content.content--narrow").add(ot("div.login-modal").add(ot("div").set("style","display: grid; gap: 16px;").add(ot("div").set("style","position: relative;").add(ot("input.login-modal__username").bind2("value",pe).set("type","text").set("spellcheck","false").set("placeholder","Username")).add(Vt.makePerson().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);"))).add(ot("div").set("style","position: relative;").add(ot("input.login-modal__password").bind2("value",ue).set("type","password").set("spellcheck","false").set("placeholder","Password").on("keyup",(t=>It(void 0,void 0,void 0,(function*(){"Enter"===t.code&&(yield ve())}))))).add(Vt.makeLock().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);"))).add(ot("div").set("style","position: relative;").add(ot("input.login-modal__password").bind2("value",fe).set("type","password").set("spellcheck","false").set("placeholder","Repeat password")).add(Vt.makeLock().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);"))).add(ot("div").set("style","position: relative;").add(ot("input.login-modal__name").bind2("value",ye).set("type","text").set("spellcheck","false").set("placeholder","Display name")).add(Vt.makePerson().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);"))).add(ot("div").set("style","position: relative;").add(ot("input.login-modal__key").bind2("value",ge).set("type","text").set("spellcheck","false").set("placeholder","Registration key").on("keyup",(t=>It(void 0,void 0,void 0,(function*(){"Enter"===t.code&&(yield Se())}))))).add(Vt.makeLock().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);")))).add(ot("div").set("style","display: grid; gap: 16px;").bind("data-hide",me.compute((t=>0===t.length))).repeat(me,(t=>{return e=lt(t),ot("div.text-paragraph").add(e);var e}))).add(ot("div").set("style","display: grid; gap: 16px;").add(ot("button").bind2("data-enabled",r((t=>""+t),be)).add(lt("Register")).on("click",(()=>It(void 0,void 0,void 0,(function*(){yield Se()}))))).add(ot("button").bind2("data-enabled",r((t=>""+t),he)).add(lt("Login")).on("click",(()=>It(void 0,void 0,void 0,(function*(){yield ve()}))))))))).add(ot("div.scroll-container").bind("data-hide",re.addObserver((t=>"context"!==t))).add(ot("div.content.content--narrow").repeat(Gt,(t=>t))));oe.appendChild(we.render());let ke,xe=ot("div.scroll-container").bind("data-hide",ie.addObserver((t=>t))).render(),_e=ot("div.scroll-container__sentinel").set("style","height: 1px").render();function Oe(t){o(ke)&&Te.unobserve(_e),ke=t,o(ke)&&Te.observe(_e)}xe.appendChild(ae),xe.appendChild(_e),oe.appendChild(xe);let Te=new IntersectionObserver((t=>It(void 0,void 0,void 0,(function*(){if(!a(ke))for(let e of t)if(e.target===_e&&e.isIntersecting){yield ke(),Oe(ke);break}}))),{root:xe}),Ee=ot("div.app__navigation").add(ot("div.app__message-bar").bind("data-hide",At.isOnline.addObserver((t=>t))).add(ot("div.offline-indicator").add(ot("div.offline-indicator__content").add(lt("The application is currently offline."))))).render();const je=()=>ot("div.icon-button");let Ce=ot("div.content").set("style","padding: 16px;").add(ot("div.media-player").add(ot("div.media-player__metadata").add(ot("div.media-player__title").add(lt(Dt))).add(ot("div.media-player__subtitle").add(lt(Ft))).on("click",(t=>{let e=At.context.getState();if(o(e))if(b.is(e))Ae(`audio/albums/${e.album_id}/`);else if(g.is(e))Ae(`audio/artists/${e.artist_id}/`);else if(D.is(e))Ae(`video/episodes/${e.episode_id}/`);else if(A.is(e))Ae(`video/movies/${e.movie_id}/`);else if(T.is(e))Ae(`audio/playlists/${e.playlist_id}/`);else if(N.is(e))Ae(`video/seasons/${e.season_id}/`);else if(L.is(e))Ae(`video/shows/${e.show_id}/`);else{if(!k.is(e))throw"Expected code to be unreachable!";Ae(`audio/tracks/${e.track_id}/`)}}))).add(ot("div.media-player__controls").add(je().bind("data-hide",At.devices.compute((t=>t.length<2))).add(Vt.makeBroadcast()).on("click",(()=>{ne.updateState(!ne.getState())}))).add(je().bind("data-enabled",At.canPlayLast.addObserver((t=>t))).add(Vt.makeLast()).on("click",(()=>{At.last()}))).add(je().bind("data-enabled",At.canPlayCurrent.addObserver((t=>t))).add(Vt.makePlay().bind("data-hide",At.playback.addObserver((t=>!0===t)))).add(Vt.makePause().bind("data-hide",At.playback.addObserver((t=>!1===t)))).on("click",(()=>{At.toggle()}))).add(je().bind("data-enabled",At.canPlayNext.addObserver((t=>t))).add(Vt.makeNext()).on("click",(()=>{At.next()}))))).render();le.appendChild(Ee),Ee.appendChild(Ce),$t.setAttribute("playsinline",""),$t.setAttribute("preload","auto"),$t.style.setProperty("height","100%"),$t.style.setProperty("width","100%"),Lt.setAttribute("preload","auto"),Lt.style.setProperty("display","none"),Nt.setAttribute("preload","auto"),Nt.style.setProperty("display","none");let Ie=ot("div").bind("data-hide",ie.addObserver((t=>!t))).set("style","background-color: rgb(0, 0, 0); height: 100%;").render();function Pe(t){return ot("div.text-header").add(t)}oe.appendChild(Ie),Ie.appendChild($t),Ie.appendChild(Lt),Ie.appendChild(Nt);function Ae(t){null===window.history.state?window.history.replaceState({uri:t},"",t):t!==window.history.state.uri&&window.history.pushState({uri:t},"",t),(t=>{for(Oe();null!==ae.lastChild;)ae.removeChild(ae.lastChild);let e;if(null!==(e=/^audio[/]tracks[/]([0-9a-f]{32})[/]/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/audio/tracks/${t}/playlists/?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.playlists)o.append(t);n+=i.playlists.length,0===i.playlists.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ee(`/api/audio/tracks/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.track;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forTrack(n))).add(ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Appearances"))).bind("data-hide",o.compute((t=>0===t.length))).add(qt.make().repeat(o,(t=>Qt.forPlaylist(t))))).render())}))}else if(null!==(e=/^audio[/]tracks[/]([^/?]*)/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/audio/tracks/${encodeURIComponent(t)}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.tracks)o.append(t);n+=i.tracks.length,0===i.tracks.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Tracks")))).add(ot("div.content").add(qt.make().repeat(o,(t=>Qt.forTrack(t))))).render())}else if(null!==(e=/^video[/]seasons[/]([0-9a-f]{32})[/]/.exec(t)))ee(`/api/video/seasons/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.season;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forSeason(n))).add(ot("div.content").set("style","display: grid; gap: 24px;").add(...n.episodes.map(((t,e)=>Qt.forEpisode(t,Jt.forSeason(n,e)))))).render())}));else if(null!==(e=/^video[/]seasons[/]([^/?]*)/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/video/seasons/${encodeURIComponent(t)}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.seasons)o.append(t);n+=i.seasons.length,0===i.seasons.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Seasons")))).add(ot("div.content").add(qt.make().repeat(o,(t=>Kt.forSeason(t))))).render())}else if(null!==(e=/^audio[/]discs[/]([0-9a-f]{32})[/]/.exec(t)))ee(`/api/audio/discs/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.disc;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forDisc(n))).add(ot("div.content").set("style","display: grid; gap: 16px;").add(...n.tracks.map(((t,e)=>Kt.forTrack(t,Jt.forDisc(n,e)))))).render())}));else if(null!==(e=/^audio[/]discs[/]([^/?]*)/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/audio/discs/${encodeURIComponent(t)}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.discs)o.append(t);n+=i.discs.length,0===i.discs.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Discs")))).add(ot("div.content").add(qt.make().repeat(o,(t=>Kt.forDisc(t))))).render())}else if(null!==(e=/^users[/]([0-9a-f]{32})[/]/.exec(t)))ee(`/api/users/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.user,i=e.playlists;ae.appendChild(ot("div.content").set("style","display: grid; gap: 64px;").add(Pe(lt(n.name))).add(ot("div").set("data-hide",""+(0===i.length)).set("style","display: grid; gap: 24px;").add(qt.make().add(...i.map((t=>Qt.forPlaylist(t)))))).render())}));else if(null!==(e=/^users[/]([^/?]*)/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/users/${encodeURIComponent(t)}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.users)o.append(t);n+=i.users.length,0===i.users.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Users")))).add(ot("div.content").add(qt.make().repeat(o,(t=>Kt.forUser(t))))).render())}else if(null!==(e=/^persons[/]([0-9a-f]{32})[/]/.exec(t))){let t=e[1];ee(`/api/persons/${t}/?token=${se}`,{},((e,n)=>{let i=n.person;ee(`/api/persons/${t}/shows/?token=${se}`,{},((e,n)=>{let r=n.shows;ee(`/api/persons/${t}/movies/?token=${se}`,{},((t,e)=>{let n=e.movies;ae.appendChild(ot("div.content").set("style","display: grid; gap: 64px;").add(Pe(lt(i.name))).add(ot("div").set("style","display: grid; gap: 24px;").set("data-hide",""+(0===r.length)).add(Pe(lt("Shows"))).add(qt.make().add(...r.map((t=>Qt.forShow(t)))))).add(ot("div").set("style","display: grid; gap: 24px;").set("data-hide",""+(0===n.length)).add(Pe(lt("Movies"))).add(qt.make().add(...n.map((t=>Qt.forMovie(t)))))).render())}))}))}))}else if(null!==(e=/^persons[/]([^/?]*)/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/persons/${encodeURIComponent(t)}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.persons)o.append(t);n+=i.persons.length,0===i.persons.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Persons")))).add(ot("div.content").add(qt.make().repeat(o,(t=>Kt.forPerson(t))))).render())}else if(null!==(e=/^audio[/]albums[/]([0-9a-f]{32})[/]/.exec(t)))ee(`/api/audio/albums/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.album;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forAlbum(n))).add(...n.discs.map(((t,e)=>ot("div.content").set("style","display: grid; gap: 16px;").add(Pe(lt("Disc "+t.number))).add(...t.tracks.map(((t,i)=>Kt.forTrack(t,Jt.forAlbum(n,e,i)))))))).render())}));else if(null!==(e=/^audio[/]albums[/]([^/?]*)/.exec(t))){let t=0,e=new i(!1),n=new i(!1),r=new s([]);Oe((()=>new Promise(((i,s)=>{e.getState()||n.getState()||(n.updateState(!0),ee(`/api/audio/albums/?offset=${t}&token=${se}`,{},((s,a)=>{for(let t of a.albums)r.append(t);t+=a.albums.length,0===a.albums.length&&e.updateState(!0),n.updateState(!1),i()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Albums")))).add(ot("div.content").add(qt.make().repeat(r,(t=>Qt.forAlbum(t))))).render())}else if(null!==(e=/^audio[/]artists[/]([0-9a-f]{32})[/]/.exec(t)))ee(`/api/audio/artists/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.artist,i=e.tracks,r=e.appearances;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forArtist(n))).add(0===i.length?void 0:ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Popular tracks"))).add(ot("div").set("style","display: grid; gap: 16px;").add(...i.map((t=>Kt.forTrack(t)))))).add(0===n.albums.length?void 0:ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Discography"))).add(qt.make().add(...n.albums.map(((t,e)=>Qt.forAlbum(t,Jt.forArtist(n,e))))))).add(0===r.length?void 0:ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Appearances"))).add(qt.make().add(...r.map((t=>Qt.forAlbum(t)))))).render())}));else if(null!==(e=/^audio[/]artists[/]([^/?]*)/.exec(t))){let t=0,e=new i(!1),n=new i(!1),r=new s([]);Oe((()=>new Promise(((i,s)=>{e.getState()||n.getState()||(n.updateState(!0),ee(`/api/audio/artists/?offset=${t}&token=${se}`,{},((s,a)=>{for(let t of a.artists)r.append(t);t+=a.artists.length,0===a.artists.length&&e.updateState(!0),n.updateState(!1),i()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Artists")))).add(ot("div.content").add(qt.make().repeat(r,(t=>Qt.forArtist(t))))).render())}else if(null!==(e=/^audio[/]playlists[/]([0-9a-f]{32})[/]/.exec(t)))ee(`/api/audio/playlists/${e[1]}/?token=${se}`,{},((t,e)=>{let n=e.playlist;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forPlaylist(n))).add(0===n.items.length?void 0:ot("div.content").set("style","display: grid; gap: 16px;").add(...n.items.map(((t,e)=>Kt.forTrack(t.track,Jt.forPlaylist(n,e)))))).render())}));else if(null!==(e=/^audio[/]playlists[/]([^/?]*)/.exec(t)))ee("/api/audio/playlists/?token="+se,{},((t,e)=>{let n=e.playlists;ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Playlists")))).add(ot("div.content").add(qt.make().add(...n.map((t=>Qt.forPlaylist(t)))))).render())}));else if(null!==(e=/^audio[/]/.exec(t)))ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Audio")))).add(ot("div.content").set("style","display: grid; gap: 32px;").add(Pe(lt("Artists")).on("click",(()=>Ae("audio/artists/")))).add(Pe(lt("Albums")).on("click",(()=>Ae("audio/albums/")))).add(Pe(lt("Playlists")).on("click",(()=>Ae("audio/playlists/"))))).render());else if(null!==(e=/^video[/]shows[/]([0-9a-f]{32})[/]/.exec(t))){let t=e[1];ee(`/api/video/shows/${t}/?token=${se}`,{},((t,e)=>{const n=e.show,i=function(t){let e;return t.seasons.forEach(((n,i)=>{n.episodes.forEach(((n,r)=>{var s;if(o(n.last_stream_date)){if(o(e)&&n.last_stream_date<(null!==(s=t.seasons[e.seasonIndex].episodes[e.episodeIndex].last_stream_date)&&void 0!==s?s:0))return;e={seasonIndex:i,episodeIndex:r}}}))})),o(e)?(e.episodeIndex+=1,e.episodeIndex===t.seasons[e.seasonIndex].episodes.length&&(e.episodeIndex=0,e.seasonIndex+=1,e.seasonIndex===t.seasons.length&&(e.seasonIndex=0))):t.seasons.length>0&&t.seasons[0].episodes.length>0&&(e={seasonIndex:0,episodeIndex:0}),e}(n);ae.appendChild(ot("div").add(ot("div.content").add(Qt.forShow(n))).add(ot("div.content").set("data-hide",""+(0===n.actors.length)).set("style","display: grid; gap: 16px;").add(...n.actors.map((t=>Kt.forPerson(t))))).add(a(i)?void 0:ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Suggested episode"))).add(Qt.forEpisode(n.seasons[i.seasonIndex].episodes[i.episodeIndex],Jt.forShow(n,i.seasonIndex,i.episodeIndex)))).add(...n.seasons.map(((t,e)=>ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Season "+t.number))).add(Ht.make(...t.episodes.map(((t,i)=>Qt.forEpisode(t,Jt.forShow(n,e,i))))))))).render())}))}else if(null!==(e=/^video[/]shows[/]([^/?]*)/.exec(t)))ee("/api/video/shows/?token="+se,{},((t,e)=>{let n=e.shows;ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Shows")))).add(ot("div.content").add(qt.make().add(...n.map((t=>Qt.forShow(t)))))).render())}));else if(null!==(e=/^video[/]episodes[/]([0-9a-f]{32})[/]/.exec(t))){let t=e[1];ee(`/api/video/episodes/${t}/?token=${se}`,{},((t,e)=>{let n=e.episode;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forEpisode(n))).render())}))}else if(null!==(e=/^video[/]episodes[/]([^/?]*)/.exec(t))){let t=e[1],n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/video/episodes/${encodeURIComponent(t)}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.episodes)o.append(t);n+=i.episodes.length,0===i.episodes.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Episodes")))).add(ot("div.content").add(qt.make().repeat(o,(t=>Kt.forEpisode(t))))).render())}else if(null!==(e=/^video[/]movies[/]([0-9a-f]{32})[/]/.exec(t))){let t=e[1];ee(`/api/video/movies/${t}/?token=${se}`,{},((e,n)=>{let r=0,a=new i(!1),o=new i(!1),l=new s([]);Oe((()=>new Promise(((e,n)=>{a.getState()||o.getState()||(o.updateState(!0),ee(`/api/video/movies/${t}/suggestions/movies/?offset=${r}&token=${se}`,{},((t,n)=>{for(let t of n.movies)l.append(t);r+=n.movies.length,0===n.movies.length&&a.updateState(!0),o.updateState(!1),e()})))}))));let d=n.movie;ae.appendChild(ot("div").add(ot("div.content").add(Qt.forMovie(d))).add(ot("div.content").set("data-hide",""+(0===d.actors.length)).set("style","display: grid; gap: 16px;").add(...d.actors.map((t=>Kt.forPerson(t))))).add(ot("div.content").bind("data-hide",l.compute((t=>0===t.length))).set("style","display: grid; gap: 16px;").add(Pe(lt("Suggested movies"))).add(qt.make().repeat(l,(t=>Qt.forMovie(t))))).render())}))}else if(null!==(e=/^video[/]movies[/]([^/?]*)/.exec(t))){let t=0,e=new i(!1),n=new i(!1),r=new s([]);Oe((()=>new Promise(((i,s)=>{e.getState()||n.getState()||(n.updateState(!0),ee(`/api/video/movies/?offset=${t}&token=${se}`,{},((s,a)=>{for(let t of a.movies)r.append(t);t+=a.movies.length,0===a.movies.length&&e.updateState(!0),n.updateState(!1),i()})))})))),ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Movies")))).add(ot("div.content").add(qt.make().repeat(r,(t=>Qt.forMovie(t))))).render())}else if(null!==(e=/^video[/]cues[/]([^/?]*)/.exec(t))){let t=new i(decodeURIComponent(e[1])),n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/video/cues/${encodeURIComponent(t.getState())}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.cues)o.append(t);n+=i.cues.length,0===i.cues.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div.content").set("style","display: grid; gap: 32px;").add(ot("div").set("style","position: relative;").add(ot("input").set("type","text").set("spellcheck","false").set("placeholder","Search query").bind2("value",t).on("keyup",(e=>{"Enter"===e.code&&Ae(`video/cues/${encodeURIComponent(t.getState())}/`)}))).add(Vt.makeMagnifyingGlass().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);"))).add(ot("div").set("style","display: grid; gap: 16px;").repeat(o,(t=>{let e=t.media;if(D.is(e)){let t=e;return Kt.forEpisode(t,Jt.forEpisode(t))}if(A.is(e)){let t=e;return Kt.forMovie(t,Jt.forMovie(t))}throw"Expected code to be unreachable!"}))).render())}else if(null!==(e=/^video[/]genres[/]([0-9a-f]{32})[/]/.exec(t))){let t=e[1];ee(`/api/video/genres/${t}/?token=${se}`,{},((e,n)=>{let i=n.genre;ee(`/api/video/genres/${t}/shows/?token=${se}`,{},((e,n)=>{let r=n.shows;ee(`/api/video/genres/${t}/movies/?token=${se}`,{},((t,e)=>{let n=e.movies;ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt(i.title)))).add(0===r.length?void 0:ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Shows"))).add(qt.make().add(...r.map((t=>Qt.forShow(t)))))).add(0===n.length?void 0:ot("div.content").set("style","display: grid; gap: 24px;").add(Pe(lt("Movies"))).add(qt.make().add(...n.map((t=>Qt.forMovie(t)))))).render())}))}))}))}else if(null!==(e=/^video[/]genres[/]([^/?]*)/.exec(t)))ee("/api/video/genres/?token="+se,{},((t,e)=>{let n=e.genres;ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Genres")))).add(ot("div.content").set("style","display: grid; gap: 32px;").add(...n.map((t=>Pe(Yt.forGenre(t)))))).render())}));else if(null!==(e=/^video[/]/.exec(t)))ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Video")))).add(ot("div.content").set("style","display: grid; gap: 32px;").add(Pe(lt("Shows")).on("click",(()=>Ae("video/shows/")))).add(Pe(lt("Movies")).on("click",(()=>Ae("video/movies/")))).add(Pe(lt("Genres")).on("click",(()=>Ae("video/genres/")))).add(Pe(lt("Cues")).on("click",(()=>Ae("video/cues/"))))).render());else if(null!==(e=/^search[/]([^/]*)/.exec(t))){let t=new i(decodeURIComponent(e[1])),n=0,r=new i(!1),a=new i(!1),o=new s([]);Oe((()=>new Promise(((e,i)=>{r.getState()||a.getState()||(a.updateState(!0),ee(`/api/search/${encodeURIComponent(t.getState())}?offset=${n}&token=${se}`,{},((t,i)=>{for(let t of i.entities)o.append(t);n+=i.entities.length,0===i.entities.length&&r.updateState(!0),a.updateState(!1),e()})))})))),ae.appendChild(ot("div.content").set("style","display: grid; gap: 64px;").add(ot("div").set("style","position: relative;").add(ot("input").set("type","text").set("spellcheck","false").set("placeholder","Search query").bind2("value",t).on("keyup",(e=>{"Enter"===e.code&&Ae(`search/${encodeURIComponent(t.getState())}/`)}))).add(Vt.makeMagnifyingGlass().set("style","fill: rgb(255, 255, 255); position: absolute; left: 0px; top: 50%; transform: translate(100%, -50%);"))).add(ot("div").set("style","display: grid; gap: 16px;").repeat(o,(t=>Kt.forEntity(t)))).render())}else ae.appendChild(ot("div").add(ot("div.content").add(Pe(lt("Home")))).add(ot("div.content").set("style","display: grid; gap: 32px;").add(Pe(lt("Audio")).on("click",(()=>Ae("audio/")))).add(Pe(lt("Video")).on("click",(()=>Ae("video/")))).add(Pe(lt("Search")).on("click",(()=>Ae("search/"))))).render())})(t)}Ae(((t=window.location.pathname,e=(()=>{let t=document.head.querySelector("base[href]");if(null!==t){let e=t.getAttribute("href");if(null!==e)return e}return"/"})())=>{let n=t.split("/"),i=e.split("/"),r=0;for(;r<n.length&&r<i.length&&n[r]===i[r];)r++;return n.slice(r).join("/")})()),window.addEventListener("popstate",(t=>{Ae(t.state.uri)}))})()})();